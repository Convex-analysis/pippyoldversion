True
[PiPPy] World size: 2, DP group size: 1, PP group size: 2
rank = 0 host/pid/device = ubuntu/39940/cuda:0
2025-02-27 17:02:09,616 - INFO - Added key: store_based_barrier_key:1 to store for rank: 0
2025-02-27 17:02:09,618 - INFO - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2025-02-27 17:02:18,234 - INFO - Added key: store_based_barrier_key:2 to store for rank: 0
2025-02-27 17:02:18,235 - INFO - Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 2 nodes.
2025-02-27 17:02:18,235 - INFO - Added key: store_based_barrier_key:3 to store for rank: 0
2025-02-27 17:02:18,247 - INFO - Rank 0: Completed store-based barrier for key:store_based_barrier_key:3 with 2 nodes.
2025-02-27 17:02:18,249 - INFO - Added key: store_based_barrier_key:4 to store for rank: 0
2025-02-27 17:02:18,260 - INFO - Rank 0: Completed store-based barrier for key:store_based_barrier_key:4 with 2 nodes.
2025-02-27 17:02:18,262 - INFO - Added key: store_based_barrier_key:5 to store for rank: 0
2025-02-27 17:02:18,273 - INFO - Rank 0: Completed store-based barrier for key:store_based_barrier_key:5 with 2 nodes.
REPLICATE config: 0 -> MultiUseParameterConfig.TRANSMIT
Using schedule: 1F1B
Using device: cuda:0
Files already downloaded and verified
GPU Before initializing model:0.0
GPU After initializing model:0.0
2025-02-27 17:02:23,164 - INFO - Pipeline is in training mode, backward pass generated
Unnamed module found in submod_0
GPU After creating Pipe:42.67724609375
1:44750336
Before _init_remote_executors :42.67724609375MB
2025-02-27 17:02:23,713 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:02:23,727 - INFO - [root] Sending stage_id = 0 mod to worker
2025-02-27 17:02:23,862 - INFO - [0] Instantiating RankWorker
Inital rank worker:42.67724609375MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0after initialization :42.67724609375MB

[32mCurrent descr name: submod_0, stage_id: 0, rank: 0[0m
2025-02-27 17:02:23,888 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:02:23,939 - INFO - Instantiating PipeStageExecutor for stage 0
[32mCurrent descr name: submod_1, stage_id: 1, rank: 1[0m
After _init_remote_executors :45.27099609375MB
2025-02-27 17:03:48,112 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:03:48,115 - INFO - [root] Sending stage_id = 0 mod to worker
2025-02-27 17:03:48,115 - INFO - [0] Instantiating RankWorker
Inital rank worker:45.27099609375MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0after initialization :45.27099609375MB

[32mCurrent descr name: submod_0, stage_id: 0, rank: 0[0m
2025-02-27 17:03:48,140 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:03:48,186 - INFO - Instantiating PipeStageExecutor for stage 0
[32mCurrent descr name: submod_1, stage_id: 1, rank: 1[0m
GPU After creating optimizer:90.4931640625
Epoch: 1
GPU Start of epoch 1:90.4931640625
2025-02-27 17:05:25,611 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:05:25,612 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:05:25,613 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:05:25,614 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:05:25,615 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:05:25,615 - DEBUG - [root] 2 instantiated
2025-02-27 17:05:25,616 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:05:25,616 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:05:25,616 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:05:25,616 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:05:25,617 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:05:25,617 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:05:25,623 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:05:25,623 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:05:25,624 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:25,624 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:05:25,625 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:05:25,625 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:05:25,625 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:25,627 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:05:25,627 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:25,627 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :93.244140625MB
2025-02-27 17:05:25,628 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:05:25,626 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:05:25,640 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:05:25,653 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:05:25,654 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:05:25,654 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:05:25,654 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:05:25,655 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:05:25,665 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:05:25,666 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:05:25,673 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:05:25,674 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:05:25,699 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:05:25,708 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:05:25,708 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:05:25,709 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:25,709 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:05:25,709 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:05:25,710 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:05:25,710 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:25,709 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:05:25,711 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:05:25,711 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:05:25,711 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:05:25,712 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:05:25,712 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:05:25,712 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:05:25,713 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:05:25,716 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:05:25,716 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:05:25,752 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:05:25,752 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:05:25,753 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:05:25,753 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:05:25,753 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:05:25,758 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:05:25,759 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:05:25,769 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:05:25,781 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:05:25,836 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:05:25,837 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:05:25,837 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:05:25,837 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:05:25,838 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:05:25,839 - DEBUG - [0][0] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:05:25,840 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:05:25,840 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:05:25,840 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 0_stage_backward_1
2025-02-27 17:05:25,840 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:05:25,841 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:05:25,841 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:05:25,841 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:05:25,842 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:05:25,839 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:05:25,849 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:05:25,850 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:05:25,986 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:05:25,987 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:05:25,988 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:05:25,990 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:05:25,990 - DEBUG - [0] Received getitem call: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:05:25,991 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:05:25,991 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:05:25,992 - DEBUG - [0] Received getitem call: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:05:25,992 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:05:25,993 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:05:25,994 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:05:25,996 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:05:25,996 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:05:25,998 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:05:25,998 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:05:26,001 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:05:26,002 - DEBUG - [0][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:05:26,002 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:05:26,003 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:05:26,003 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:05:26,003 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1'])
2025-02-27 17:05:26,003 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:05:26,003 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:05:26,005 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:05:26,005 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:05:26,007 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:05:26,011 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:05:26,012 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:05:26,013 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_7) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:05:26,015 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_6) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:05:26,033 - DEBUG - [0][1] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:05:26,034 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:05:26,035 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:05:26,035 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 1_stage_backward_1
2025-02-27 17:05:26,035 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:05:26,036 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:05:26,037 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier'])
2025-02-27 17:05:26,037 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:05:26,038 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:05:26,038 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:05:26,039 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:05:26,039 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:05:26,040 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:05:26,041 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:05:26,045 - DEBUG - [0] Received getitem call: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:05:26,045 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:05:26,046 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:05:26,047 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:05:26,047 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:05:26,049 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:05:26,049 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:05:26,050 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:05:26,052 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:05:26,053 - DEBUG - [0][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:05:26,053 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:05:26,054 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:05:26,054 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:05:26,054 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier', '1_stage_backward_1'])
2025-02-27 17:05:26,055 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:05:26,055 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:05:26,056 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:05:26,057 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:05:26,058 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:05:26,061 - DEBUG - [0] Received getitem call: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:05:26,064 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:05:26,064 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_7) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:05:26,065 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:05:26,066 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:05:26,073 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_6) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:05:34,128 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :327.50390625MB
2025-02-27 17:05:34,137 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :327.50390625MB
All workitem count at loop begining: 5, current work item in ready runlist: 1, current work item in waiting runlist: 4
2025-02-27 17:05:34,145 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:05:34,146 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:34,146 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :327.50390625MB
2025-02-27 17:05:34,148 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:05:34,202 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:05:34,324 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :575.513671875MB
2025-02-27 17:05:34,346 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:05:34,347 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
Periodic memory cleanup :575.513671875MB
All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:06:15,661 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:06:15,670 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:06:49,211 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:06:49,212 - DEBUG - [0][0] all operands ready: 0_stage_backward_1
2025-02-27 17:06:49,212 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:06:49,213 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:06:49,213 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:06:49,213 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 0 :591.51953125MB
2025-02-27 17:06:49,214 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:06:49,215 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:06:49,216 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:06:49,219 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:06:49,225 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:06:49,227 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:06:53,108 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:06:53,112 - DEBUG - [0][1] all operands ready: 1_stage_backward_1
2025-02-27 17:06:53,113 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:06:53,156 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward_1
2025-02-27 17:06:53,163 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:06:53,164 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:06:53,164 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:06:53,165 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 0 :370.0888671875MB
2025-02-27 17:06:53,170 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
Periodic memory cleanup :370.0888671875MB
All workitem count at loop begining: 3, current work item in ready runlist: 2, current work item in waiting runlist: 1
2025-02-27 17:06:53,247 - DEBUG - [0] Dequeueing workitem from set of 2
2025-02-27 17:06:53,247 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:06:53,248 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 1 :370.0888671875MB
2025-02-27 17:06:53,279 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:06:53,279 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:06:53,551 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward_1
2025-02-27 17:06:53,557 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
after processing the work_item.microbatch_id 1 :120.5791015625MB
2025-02-27 17:06:53,558 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:06:53,683 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:06:53,684 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:06:53,684 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :120.5791015625MB
All workitem count at loop begining: 2, current work item in ready runlist: 2, current work item in waiting runlist: 0
2025-02-27 17:06:53,686 - DEBUG - [0] Dequeueing workitem from set of 2
2025-02-27 17:06:53,686 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:53,686 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :120.5791015625MB
2025-02-27 17:06:53,687 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 6.1229e-02,  3.0453e-01,  2.9152e-01, -2.5179e-01,  2.8261e-01,
          1.0984e+00, -2.7512e-01, -3.2513e-01, -1.7102e-01, -1.8063e-01],
        [ 2.5859e-01,  5.9252e-01,  1.4326e-01, -1.0686e-01, -2.6395e-01,
          1.3612e+00, -4.1590e-01, -6.3610e-01,  1.9666e-01,  2.7976e-01],
        [ 1.7685e-01,  2.3161e-01,  3.5905e-01, -1.3343e-01,  1.9198e-01,
          9.6855e-01, -2.3471e-01, -4.1173e-01,  8.5672e-03,  1.3142e-01],
        [ 6.4528e-01, -1.4958e-01,  3.8920e-02, -1.0984e-01, -9.7394e-02,
          1.7632e+00, -1.4930e+00, -8.8894e-01, -5.0422e-02,  2.7561e-01],
        [ 2.8993e-01,  2.3728e-01,  4.1282e-01, -2.4689e-01,  2.4005e-01,
          8.5905e-01, -2.1014e-01, -2.8874e-01,  4.0128e-02,  1.8684e-01],
        [ 1.9340e-01,  4.4123e-01,  2.6703e-01, -2.6927e-01, -2.9652e-01,
          1.7352e+00, -7.0160e-01, -4.9582e-01, -2.0938e-03,  2.5087e-01],
        [ 6.8446e-02,  1.9210e-01,  3.9835e-01, -1.9977e-01,  3.0025e-02,
          1.3484e+00, -4.4657e-01, -5.0875e-01,  1.3297e-01,  2.0632e-01],
        [ 1.8004e-01,  1.7516e-01,  2.7498e-01, -2.8733e-02,  1.6574e-01,
          1.0668e+00, -3.6054e-01, -6.4230e-01, -7.8240e-02,  2.6640e-01],
        [-7.4400e-02,  2.0525e-01,  2.2927e-01, -6.8504e-02, -2.3283e-01,
          1.2953e+00, -5.2848e-01, -4.4121e-01,  8.0056e-02,  3.4968e-01],
        [ 1.0631e-01,  3.1384e-01,  2.9608e-01, -1.8916e-01,  1.6177e-01,
          1.1310e+00, -2.3101e-01, -4.8893e-01,  1.1432e-01,  1.3091e-01],
        [ 2.3613e-01,  1.3896e-01,  3.1822e-01, -1.3651e-01,  2.4191e-01,
          1.1024e+00, -2.5592e-01, -2.2551e-01,  2.5309e-01,  1.0655e-01],
        [ 1.8521e-01,  2.0625e-01,  4.6076e-01, -1.7153e-01,  1.0460e-01,
          1.0294e+00, -3.2951e-01, -4.1117e-01,  1.9200e-01, -8.1813e-03],
        [ 1.1094e-01,  2.0873e-01, -9.9979e-03, -1.7781e-01, -2.1234e-01,
          1.2030e+00, -5.1388e-01, -5.7402e-01,  1.4806e-01,  7.8413e-02],
        [ 2.1033e-01,  1.9327e-01,  4.4965e-01, -2.2893e-01,  1.7256e-01,
          1.3169e+00, -3.1851e-01, -4.5256e-01,  2.3141e-01, -6.3629e-02],
        [ 4.4994e-01,  1.6346e-01,  4.1884e-01,  7.4138e-02,  3.1093e-02,
          1.2438e+00, -8.0180e-01, -7.1659e-01,  2.3745e-01,  3.3292e-01],
        [ 1.1159e-02,  1.2009e-01,  4.4230e-01, -1.1365e-02,  1.8741e-01,
          9.6010e-01, -3.2538e-01, -3.6654e-01,  1.0460e-01,  1.3844e-01],
        [ 2.7629e-01,  3.0158e-01,  1.0095e-01, -2.5805e-01, -2.7345e-01,
          9.2748e-01, -5.0289e-01, -4.7021e-01, -2.1180e-02,  1.3388e-01],
        [ 3.0276e-02,  5.1297e-01,  1.3967e-01, -1.9711e-01,  1.8945e-01,
          1.3715e+00, -4.4965e-01, -4.2200e-01,  1.0683e-01,  1.5235e-01],
        [ 1.4096e-01,  1.3523e-01,  4.6514e-01, -1.7563e-02,  4.8080e-02,
          1.2373e+00, -6.7793e-01, -3.1864e-01,  3.1485e-02,  2.3647e-01],
        [ 1.5024e-01,  1.8414e-01,  2.9821e-01, -2.2166e-01,  5.6916e-02,
          1.2489e+00, -5.4732e-01, -5.3149e-01,  1.1864e-01,  6.8581e-02],
        [ 2.9239e-01,  2.3348e-01,  3.8813e-01, -1.8654e-01, -6.3562e-02,
          1.3240e+00, -5.1276e-01, -3.4598e-01,  1.1022e-01,  2.9160e-01],
        [ 1.4786e-01,  1.4674e-01,  5.5694e-01, -4.3576e-01, -4.5490e-01,
          1.3347e+00, -4.7679e-01, -7.4722e-01,  1.9940e-02,  4.3268e-01],
        [ 1.2653e-01,  4.5713e-01,  1.5860e-01,  9.6674e-02, -1.5558e-01,
          1.3787e+00, -2.3898e-01, -3.1935e-01,  2.5177e-02, -3.9537e-02],
        [-3.6410e-02,  1.4030e-01,  4.8776e-01, -4.7397e-02,  5.2500e-02,
          1.4792e+00, -2.9765e-01, -5.7566e-01,  9.9512e-02,  2.2916e-01],
        [ 1.8455e-01,  1.8210e-01,  3.9490e-01, -6.6961e-02,  1.8105e-01,
          1.1260e+00, -3.2988e-01, -5.0686e-01,  1.5439e-01,  1.2834e-01],
        [ 1.9359e-01,  3.1442e-01,  2.5083e-01, -3.7539e-01,  1.2310e-01,
          1.0314e+00, -4.8093e-01, -3.5406e-01, -1.2424e-01,  2.7583e-01],
        [ 2.2133e-01,  4.0342e-01,  2.4343e-01, -7.7956e-02,  5.4758e-03,
          1.1137e+00, -4.1671e-01, -3.5262e-01, -4.8280e-02,  2.1149e-01],
        [ 5.6192e-02,  2.0445e-02,  3.3509e-01, -6.8893e-02,  1.1295e-01,
          1.0467e+00, -3.1628e-01, -2.5110e-01,  2.3254e-01,  2.3585e-01],
        [-4.3051e-02,  1.5544e-01,  4.0454e-01, -2.2302e-01,  7.6721e-02,
          1.0458e+00, -2.8569e-01, -2.2804e-01,  8.8811e-02,  2.2353e-02],
        [-5.5997e-02,  1.9827e-01,  2.7731e-01, -7.0981e-02,  1.7944e-02,
          1.0327e+00, -3.2642e-01, -1.5224e-01,  6.1553e-02,  7.1101e-02],
        [ 3.8415e-01, -6.7055e-02,  2.8734e-01, -1.7782e-01, -1.5761e-01,
          1.2456e+00, -4.9345e-01, -3.8360e-01, -4.1752e-02,  6.0263e-02],
        [ 1.8748e-01,  2.1426e-01,  1.4357e-01, -3.9195e-03,  8.7553e-02,
          1.4098e+00, -4.9641e-01, -2.9138e-01, -8.4292e-02,  3.1716e-01],
        [ 6.0250e-01,  1.6154e-01,  2.1331e-01, -2.0137e-01,  9.5304e-02,
          1.1498e+00, -5.4787e-01, -3.4387e-01, -1.3065e-01,  2.1625e-01],
        [ 1.3229e-01,  1.6982e-01,  1.6307e-01, -2.0091e-01,  9.9366e-02,
          1.2232e+00, -4.9264e-01, -3.6562e-01, -4.2160e-02,  1.6816e-01],
        [ 1.2751e-01,  1.9083e-01,  4.5694e-01, -2.2940e-01,  2.4814e-01,
          1.2410e+00, -2.1690e-01, -3.3731e-01, -1.5181e-01,  3.3788e-01],
        [ 1.0078e-01,  3.7439e-01,  4.0249e-01, -3.1101e-02,  1.0788e-01,
          1.2127e+00, -1.7135e-01, -3.2327e-01, -5.7294e-03,  1.6932e-01],
        [ 1.1666e-01,  2.4374e-01,  1.8914e-01,  5.3326e-02,  2.1934e-01,
          9.4889e-01, -2.9046e-01, -1.4285e-01, -4.0220e-02,  1.5056e-01],
        [ 2.1043e-01,  1.3573e-01,  1.7707e-01, -1.9718e-03, -4.5878e-02,
          1.2061e+00, -6.9093e-01, -3.5371e-01, -2.2059e-03,  2.8179e-01],
        [ 2.1923e-01,  6.1169e-02,  3.4721e-01, -1.8422e-01,  1.2333e-01,
          1.0774e+00, -1.2518e-01, -3.7098e-01,  1.0645e-01,  2.2178e-01],
        [ 4.1615e-01,  4.1317e-01,  7.5317e-01, -5.2375e-01, -3.1550e-01,
          1.5957e+00, -8.1654e-01, -5.2079e-01, -5.4543e-02,  1.3632e-01],
        [ 3.1441e-01,  1.8385e-01,  2.0518e-01, -5.0920e-01, -1.3428e-01,
          1.2946e+00, -4.1768e-01, -3.9615e-01,  1.3338e-01,  7.3210e-02],
        [ 1.1251e-01,  5.6293e-02,  4.6587e-01, -2.9454e-01,  2.6550e-02,
          1.2396e+00, -2.7686e-01, -3.5309e-01,  1.5951e-01,  1.9241e-01],
        [ 1.3243e-01,  3.8028e-01,  2.3739e-01, -3.4860e-01, -1.2995e-01,
          1.2857e+00, -2.4318e-01, -4.4561e-01,  5.5100e-02, -1.7460e-02],
        [ 1.3425e-01,  3.7460e-02,  2.7215e-01, -3.2446e-01, -1.6112e-01,
          1.3846e+00, -7.3861e-01, -4.6876e-01, -1.8507e-01, -3.3350e-02],
        [ 2.0538e-01,  2.3760e-01,  4.3994e-01, -3.2513e-01, -2.5501e-01,
          1.3561e+00, -6.4620e-01, -4.6262e-01, -3.2183e-02,  2.9762e-01],
        [-2.3737e-04,  4.5313e-02,  3.5252e-01, -1.5810e-01, -8.2633e-02,
          1.4279e+00, -4.8933e-01, -4.6451e-01, -1.0307e-01,  1.0421e-01],
        [ 9.8550e-03,  3.3565e-01,  2.0111e-01, -1.5189e-01,  5.4232e-02,
          1.0950e+00, -1.6100e-01, -2.3761e-01,  1.0180e-02,  2.0848e-01],
        [ 2.8458e-01, -1.2070e-02,  2.0813e-01, -4.1052e-02,  4.3624e-02,
          1.2790e+00, -3.2479e-01, -4.8234e-01, -1.7524e-01,  4.6079e-01],
        [-1.2995e-02,  3.7845e-01,  5.1587e-01, -1.4869e-02, -3.7984e-01,
          1.3767e+00, -5.1707e-01, -5.5747e-01,  1.3715e-01,  6.3624e-02],
        [ 1.3262e-01,  2.3052e-01,  3.8413e-01, -9.9356e-02,  1.5240e-01,
          1.0930e+00, -3.5590e-01, -6.2315e-01,  3.6255e-02,  4.1033e-01],
        [ 9.8578e-02,  2.0852e-01,  3.1696e-02, -4.2383e-01, -2.1519e-01,
          1.5422e+00, -5.1821e-01, -4.3815e-01,  1.1842e-01,  1.0755e-03],
        [ 5.6906e-01,  2.7841e-01,  2.4452e-01, -2.7820e-01, -3.9575e-02,
          1.5097e+00, -3.2915e-01, -6.9445e-01, -8.6779e-02,  5.1792e-01],
        [ 2.9309e-01,  1.4707e-01,  2.6451e-01, -1.3527e-01,  3.4273e-01,
          1.0555e+00, -2.6921e-01, -2.9546e-01, -1.6130e-01, -1.7521e-02],
        [ 1.8074e-01,  3.4279e-01,  4.9305e-01, -9.8111e-02,  4.2963e-02,
          1.3420e+00, -3.9966e-01, -5.3995e-01,  2.9593e-01,  1.3795e-01],
        [ 3.1024e-01,  2.8330e-01,  4.4527e-01, -3.6044e-01, -5.9988e-01,
          1.8033e+00, -8.3349e-01, -5.6804e-01,  5.3601e-02,  4.3368e-01],
        [ 3.9645e-01,  7.8074e-02,  3.5693e-01,  4.1599e-02,  2.5441e-01,
          1.3428e+00, -3.6513e-01, -5.3751e-01,  1.4974e-01,  2.2084e-01],
        [ 6.9055e-02,  1.8296e-01,  3.6850e-01, -3.7361e-01, -4.0645e-01,
          1.3225e+00, -4.7944e-01, -4.6579e-01, -1.2488e-01,  4.6566e-01],
        [ 6.9179e-02,  2.2749e-01,  2.2183e-01, -1.1638e-02,  2.0783e-01,
          1.1575e+00, -3.1649e-01, -2.6885e-01,  1.5204e-01,  6.4378e-02],
        [ 1.4777e-01,  1.2569e-01,  4.4103e-01,  5.0405e-02,  1.9549e-01,
          1.0440e+00, -2.8708e-02, -3.6739e-01,  8.2848e-02,  1.8712e-01],
        [ 1.3225e-01,  1.6347e-01,  4.4517e-01,  3.0220e-02,  6.2775e-02,
          1.1521e+00, -4.1001e-01, -2.5554e-01,  2.3280e-01,  1.0840e-01],
        [ 1.2542e-01,  2.1561e-01,  4.4196e-01, -2.2418e-01,  1.1459e-01,
          9.8660e-01, -3.3969e-01, -3.4047e-01,  7.0939e-02, -5.0137e-02],
        [-5.6538e-02,  8.4875e-02,  2.5580e-01, -2.2357e-01, -2.3213e-01,
          1.2964e+00, -8.3277e-01, -2.1871e-01,  1.1001e-01,  4.2452e-01],
        [ 6.7457e-01,  3.4421e-01,  4.6910e-01, -2.2918e-01, -2.0546e-01,
          2.1950e+00, -1.2105e+00, -8.1559e-01, -2.1436e-01,  1.7185e-01],
        [ 5.8113e-02,  8.4359e-02,  4.5625e-01, -4.4552e-01, -2.1136e-01,
          1.4906e+00, -6.0275e-01, -5.6872e-01, -4.0081e-03,  1.9141e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.5533, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:06:54,046 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :111.83203125MB
2025-02-27 17:06:54,053 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :111.83203125MB
All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:06:54,056 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:06:54,056 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:54,056 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :111.83203125MB
2025-02-27 17:06:54,057 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 2.4327e-02,  2.8119e-01,  3.1191e-01, -1.7341e-01,  1.5696e-01,
          1.4772e+00, -2.3744e-01, -3.9352e-01,  1.0845e-01,  1.7046e-01],
        [ 1.7343e-02,  2.5436e-01,  4.2884e-01, -2.9974e-01, -5.9290e-02,
          1.3151e+00, -5.2026e-01, -5.6416e-01, -2.4445e-01,  6.5673e-02],
        [ 2.0967e-01,  3.7964e-01,  3.1926e-01, -8.2127e-03,  1.2243e-01,
          1.0161e+00, -2.6957e-01, -3.0508e-01, -8.0081e-02,  1.2735e-01],
        [-9.0259e-02,  2.0855e-01,  2.3858e-01, -1.0416e-01,  1.8890e-01,
          9.9676e-01, -3.0225e-01, -3.2073e-01,  1.7856e-01, -5.8234e-02],
        [ 1.6442e-02, -5.8539e-02,  3.7320e-01, -1.1234e-01,  1.3492e-01,
          9.9459e-01, -3.8252e-01, -4.6118e-01, -7.4794e-02,  3.1574e-01],
        [ 1.7195e-01,  3.0371e-01,  1.9818e-01, -2.8062e-01,  3.3572e-02,
          1.0834e+00, -3.7017e-01, -6.1908e-01,  8.9690e-02,  8.2145e-02],
        [ 3.0794e-01,  4.7160e-01,  1.8098e-01, -4.9149e-02, -3.5407e-01,
          1.2824e+00, -6.2373e-01, -2.0010e-01,  8.2874e-02,  1.2950e-01],
        [ 3.5223e-01,  1.1460e-01,  3.2989e-01, -2.0652e-01, -2.2043e-01,
          1.2451e+00, -4.6423e-01, -9.7007e-02, -2.9600e-01,  2.7313e-01],
        [ 3.0578e-01,  2.2581e-01,  2.9530e-01, -2.1430e-01,  2.3884e-01,
          1.1845e+00, -3.2552e-01, -5.3322e-01,  1.4743e-01,  1.3937e-01],
        [ 5.6878e-02,  1.6281e-01,  7.5813e-02, -1.5423e-01,  1.9313e-01,
          1.0726e+00, -2.7184e-01, -1.6883e-01,  1.4583e-01,  5.9192e-02],
        [-2.7496e-02,  2.0772e-01,  7.8540e-03, -1.7800e-01, -2.7424e-01,
          1.3009e+00, -5.5573e-01, -5.6835e-01, -5.6964e-02, -2.1141e-02],
        [ 5.0434e-01,  2.5688e-01,  2.3023e-01, -3.4622e-01,  5.1737e-03,
          1.6663e+00, -9.8295e-01, -6.9163e-01, -1.5473e-01,  2.1166e-01],
        [ 3.0737e-01,  8.4388e-02,  3.4177e-01, -6.2212e-02,  1.1726e-01,
          9.6535e-01, -2.9446e-01, -3.3790e-01,  1.8654e-01,  1.9172e-01],
        [ 1.0650e-01,  8.8677e-02,  4.2235e-01, -2.3835e-01,  9.6811e-02,
          1.1691e+00, -2.3540e-01, -5.4465e-01,  1.9769e-01,  2.6946e-01],
        [ 1.6459e-01,  2.2109e-01,  3.0578e-01, -2.7032e-01,  5.4590e-02,
          1.4295e+00, -4.4513e-01, -6.0763e-01, -4.5750e-02,  1.5254e-01],
        [-2.0123e-02,  2.7706e-01,  4.9028e-01, -2.0161e-01,  1.7491e-01,
          1.2658e+00, -2.0856e-01, -4.4321e-01, -5.7385e-02,  8.4034e-02],
        [ 6.9829e-02,  1.0379e-01,  3.2176e-01, -9.2389e-02,  1.3223e-01,
          9.8503e-01, -2.0307e-01, -3.1702e-01,  2.0528e-01,  1.2120e-01],
        [ 2.5900e-01,  9.9006e-02,  1.9358e-01, -1.8120e-02, -1.2378e-01,
          1.3828e+00, -3.7201e-01, -6.7031e-01,  1.9981e-01,  3.7322e-01],
        [ 2.2476e-01,  2.6557e-01, -2.9008e-02, -7.3736e-03, -1.9134e-01,
          1.5235e+00, -5.9758e-01, -5.9144e-01,  2.5871e-01,  2.2422e-01],
        [ 9.0651e-02,  1.2063e-01,  4.0615e-01, -1.2520e-01,  4.6504e-02,
          1.1331e+00, -3.0648e-01, -3.0551e-01,  1.9167e-01,  3.0900e-01],
        [ 1.5232e-01,  1.7927e-01,  3.0069e-01, -2.4710e-01,  6.9669e-02,
          1.1386e+00, -4.6022e-01, -2.5820e-01,  2.5539e-02,  3.1272e-01],
        [ 2.2908e-01,  1.4450e-01,  4.4376e-01, -3.1373e-01,  2.9346e-02,
          9.6806e-01, -4.0587e-01, -3.8631e-01,  1.2088e-02,  2.2509e-01],
        [ 1.3026e-01,  1.3562e-01,  1.9786e-01,  2.6813e-02, -8.3692e-02,
          9.9673e-01, -5.5409e-01, -5.9961e-01,  2.5832e-01,  2.0636e-01],
        [ 1.5177e-01,  3.2340e-01,  4.1790e-01, -1.3976e-01, -2.0694e-03,
          1.0945e+00, -2.5154e-01, -4.4582e-01,  1.6695e-01,  1.2880e-01],
        [ 2.4087e-01,  1.3112e-01,  2.9044e-01, -1.3675e-01,  6.3606e-02,
          1.3663e+00, -5.5140e-01, -4.8851e-01, -1.9168e-01,  4.8707e-02],
        [-5.9701e-02,  3.2779e-01,  4.3260e-01, -5.2599e-02,  1.1341e-01,
          1.1748e+00, -4.4449e-01, -3.7272e-01,  1.2480e-01,  1.5748e-01],
        [ 1.5914e-01,  1.9718e-01,  8.4007e-02, -3.3749e-01, -4.0661e-02,
          1.1469e+00, -1.0082e-01, -4.3746e-01,  1.6688e-01,  1.1942e-02],
        [ 1.7446e-01,  7.7788e-02,  1.6532e-01, -2.0673e-01, -1.9038e-01,
          1.6000e+00, -5.8193e-01, -7.8957e-01,  2.6284e-03,  4.9579e-01],
        [ 1.6659e-01,  3.4678e-01,  2.7023e-01, -5.5188e-01, -2.6619e-01,
          1.4168e+00, -4.8271e-01, -7.2124e-01,  8.8921e-02,  4.8664e-01],
        [ 1.2145e-01,  4.2817e-01,  1.7245e-01, -4.2752e-02, -1.4811e-02,
          1.3568e+00, -3.5199e-01, -6.4730e-01, -1.2758e-01,  4.9460e-01],
        [ 2.3442e-01,  1.4316e-01,  2.3401e-01, -7.3070e-02, -1.0848e-01,
          1.2149e+00, -4.7311e-01, -3.2256e-01,  9.4818e-02,  1.6825e-01],
        [ 4.3297e-01,  1.6892e-01,  4.4225e-01, -2.2732e-01, -5.2139e-01,
          1.9451e+00, -8.6076e-01, -5.2275e-01, -2.8464e-01,  3.9009e-01],
        [-1.2496e-01,  2.3105e-01,  1.4041e-01, -3.5817e-03, -9.1549e-02,
          1.5092e+00, -7.7898e-01, -4.4560e-01, -2.5660e-01,  2.0303e-01],
        [-7.1785e-02,  3.9103e-01,  2.6048e-01, -3.8847e-01, -2.5392e-01,
          1.4709e+00, -9.1248e-01, -4.5143e-01, -4.1919e-02,  3.6595e-01],
        [-1.7237e-03,  2.9410e-01,  2.7458e-01, -1.7372e-01, -1.5476e-01,
          1.0258e+00, -4.0602e-01, -2.6795e-01,  2.0809e-02,  1.4007e-01],
        [ 1.6860e-01,  1.9529e-01,  2.7941e-01, -3.8939e-01, -7.8517e-02,
          9.8730e-01, -4.0343e-01, -3.2142e-01,  8.5280e-02,  4.1747e-01],
        [ 3.3065e-01,  6.2074e-01,  4.8086e-01, -3.1581e-01, -4.4398e-01,
          1.6251e+00, -9.4556e-01, -6.9948e-01,  1.8684e-01,  1.9884e-01],
        [ 3.2204e-01,  1.7802e-01,  3.0390e-01, -3.9971e-01,  3.7724e-02,
          1.2356e+00, -6.0153e-01, -5.2607e-01,  3.8262e-02,  8.2877e-02],
        [ 2.5350e-01,  2.2354e-01,  5.0746e-01, -7.2337e-02,  2.2295e-01,
          1.3229e+00, -2.9174e-01, -1.7974e-01, -1.6467e-01,  2.9293e-02],
        [ 1.6984e-01,  1.3932e-01,  4.8247e-01, -1.3828e-01, -9.0376e-02,
          1.4487e+00, -4.3295e-01, -1.8318e-01, -9.3872e-03,  2.9873e-01],
        [ 1.7291e-01,  1.2300e-01,  4.4543e-01, -2.2187e-01,  7.7378e-02,
          9.6789e-01, -2.2874e-01, -1.9873e-01,  5.4587e-02,  4.8837e-01],
        [ 4.3741e-01,  6.8075e-02,  3.0297e-01, -1.9685e-01, -2.3508e-02,
          1.0670e+00, -2.9746e-01, -2.6070e-01,  4.3117e-02,  2.9432e-01],
        [ 2.7687e-01,  1.7642e-01,  1.8494e-01, -1.1566e-01, -5.1989e-02,
          1.4261e+00, -7.1165e-01, -6.9390e-01, -1.9819e-01,  1.6985e-01],
        [ 5.0763e-01,  8.9409e-01,  2.0621e-01,  3.0765e-01, -9.3355e-02,
          1.8408e+00, -1.2739e+00, -9.2897e-01,  1.9661e-01,  6.1176e-04],
        [ 1.5628e-01,  3.8232e-02,  5.4162e-01, -8.1969e-02,  2.1884e-02,
          1.2478e+00, -3.9403e-01, -5.3154e-01,  1.9268e-02,  3.1002e-01],
        [ 7.3301e-02,  9.9433e-02,  2.3794e-01,  4.7621e-03,  3.0331e-01,
          1.1722e+00, -2.6880e-01, -3.0576e-01,  7.5156e-02,  4.2880e-02],
        [ 2.5805e-01,  8.6205e-02,  2.4560e-01, -2.5355e-02,  7.4906e-02,
          9.7733e-01, -3.8579e-01, -2.2221e-01,  1.2011e-01,  9.3511e-02],
        [ 2.1980e-01,  1.4847e-01,  2.3725e-01, -4.0900e-01,  2.0229e-01,
          1.0441e+00, -3.7164e-01, -2.3719e-01,  1.6130e-01,  7.9908e-02],
        [ 1.8019e-01,  5.8702e-02,  3.7773e-01, -1.3407e-02,  2.4661e-01,
          8.8004e-01, -2.6413e-01, -1.9072e-01,  2.9638e-01,  2.2101e-01],
        [ 6.2779e-02,  2.8020e-01,  3.7838e-01, -3.3728e-01,  1.0272e-01,
          1.2941e+00, -1.7773e-01, -2.8933e-01, -2.9244e-03,  1.1218e-01],
        [ 7.5507e-02,  2.5999e-01,  1.9867e-01, -1.6904e-01, -2.0784e-02,
          9.9250e-01, -3.0337e-01, -3.9386e-01, -1.0518e-01,  2.2194e-01],
        [ 2.2866e-01,  2.3091e-01,  4.0456e-01, -1.1307e-01,  1.2153e-01,
          9.5292e-01, -1.2749e-01, -3.1753e-01,  8.1734e-02, -5.4670e-02],
        [ 4.8036e-01,  5.6733e-01,  3.1147e-02,  7.9456e-02, -4.1327e-02,
          1.6690e+00, -6.0360e-01, -7.2212e-01,  3.1100e-02,  2.3934e-01],
        [ 3.0312e-01,  1.9393e-01,  3.2994e-01, -6.5096e-02,  7.8273e-02,
          1.1583e+00, -3.3637e-01, -2.9519e-01,  1.6277e-01,  3.0458e-01],
        [ 1.0654e-01,  2.0751e-01,  3.9513e-01, -2.6731e-01, -2.7442e-01,
          1.4961e+00, -8.1553e-01, -7.5655e-01,  2.9574e-01,  1.2200e-01],
        [ 2.1866e-01,  9.1396e-03,  2.1921e-01, -2.3331e-01,  2.1511e-01,
          1.2921e+00, -4.4738e-01, -2.8849e-01, -7.8777e-02, -9.3042e-04],
        [ 2.2262e-01,  2.2004e-01,  3.4141e-01,  7.2070e-02,  1.0434e-01,
          1.1992e+00, -2.4586e-01, -2.6137e-01, -1.8586e-01,  7.0255e-02],
        [ 1.5807e-01,  3.3823e-01,  3.3859e-01, -3.5952e-01,  7.8757e-02,
          1.0739e+00, -3.9307e-01, -4.0760e-01, -6.5358e-03,  1.2305e-01],
        [ 4.0041e-01, -2.8796e-02,  3.4907e-01, -3.4703e-01, -4.9483e-02,
          1.4142e+00, -5.0492e-01, -6.0645e-01, -1.1738e-01,  2.5489e-01],
        [-1.8592e-02,  1.5336e-01,  2.2260e-01, -2.5019e-01,  8.2314e-02,
          1.0676e+00, -1.3940e-01, -1.5844e-01,  2.0327e-01,  1.5073e-01],
        [ 2.0419e-01,  2.8804e-02,  6.1302e-01, -1.4565e-01, -1.2415e-01,
          1.5042e+00, -7.8878e-01, -4.1949e-02, -8.0093e-02,  4.7484e-01],
        [ 3.0780e-01,  1.1369e-01,  3.7494e-01, -5.8087e-02, -1.8281e-01,
          1.9679e+00, -9.8384e-01, -5.7043e-01, -9.2726e-02,  5.6758e-01],
        [ 1.5769e-01, -7.5907e-02,  3.3668e-01, -2.1293e-01, -1.5004e-02,
          1.0142e+00, -3.8531e-01, -3.8619e-01, -1.5998e-01,  1.8873e-01],
        [ 1.3541e-01,  2.4220e-01,  3.4106e-01, -1.8603e-01,  1.4445e-01,
          1.0458e+00, -6.9471e-03, -2.8821e-01,  2.9012e-01,  1.9169e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.5386, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:06:54,159 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :111.83203125MB
2025-02-27 17:06:54,164 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :111.83203125MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 02025-02-27 17:06:54,166 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters

GPU After processing batch 3 in train loader:116.9970703125
Loader: train. Accuracy: 0.0234375
2025-02-27 17:06:54,555 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:06:54,557 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:06:54,560 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:06:54,561 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:06:54,561 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:06:54,562 - DEBUG - [root] 2 instantiated
2025-02-27 17:06:54,562 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:06:54,563 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:06:54,563 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:06:54,563 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:06:54,564 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:06:54,564 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:06:54,569 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:06:54,570 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:06:54,570 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,570 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:06:54,571 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:06:54,571 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:06:54,571 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,571 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:06:54,574 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:06:54,574 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,575 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:06:54,575 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :101.2470703125MB
2025-02-27 17:06:54,579 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:06:54,581 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:06:54,582 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:06:54,582 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:06:54,583 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:06:54,583 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:06:54,587 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:06:54,587 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:06:54,593 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:06:54,593 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:06:54,594 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:06:54,594 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:06:54,595 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:06:54,595 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:06:54,596 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:06:54,597 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:06:54,596 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:06:54,597 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,599 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:06:54,599 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:06:54,599 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:06:54,599 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,604 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:06:54,611 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:06:54,612 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:06:54,612 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:06:54,612 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:06:54,613 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:06:54,617 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:06:54,617 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:06:54,618 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:06:54,618 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:06:54,618 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:06:54,619 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:06:54,619 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:06:54,620 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:06:54,620 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:06:54,621 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:06:54,621 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:06:54,622 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:06:54,623 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:06:54,623 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:06:54,624 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:06:54,624 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:06:54,624 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:06:54,626 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:06:54,627 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:06:54,629 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:54,630 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:06:54,629 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:06:54,628 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:06:54,631 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:06:54,630 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:06:54,630 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:06:54,632 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:06:54,632 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:06:54,633 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:54,634 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:06:54,631 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:54,639 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:06:54,637 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:06:54,638 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:06:54,639 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:06:54,640 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_sync_barrier'])
2025-02-27 17:06:54,640 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:06:54,640 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:06:54,642 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:06:54,637 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:06:54,647 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:06:54,663 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :333.244140625MB
2025-02-27 17:06:54,670 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :333.244140625MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:06:54,676 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:06:54,676 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:06:54,676 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :333.244140625MB
2025-02-27 17:06:54,677 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:06:54,872 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :565.244140625MB
2025-02-27 17:06:54,880 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :565.244140625MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:07:14,555 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:07:14,556 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:14,557 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:07:14,557 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:14,557 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:14,558 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:14,558 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :565.2470703125MB
2025-02-27 17:07:14,559 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 2.0257e-02,  3.7392e-02,  4.7564e-02, -1.5968e-02,  6.9267e-02,
          6.6353e-03, -6.8013e-04, -1.2377e-02,  6.8001e-03,  3.6751e-02],
        [ 2.2520e-02,  3.3750e-02,  4.6079e-02, -3.0943e-02,  6.5052e-02,
         -1.4677e-02, -2.1704e-02, -1.1856e-02,  1.3890e-02,  3.4256e-02],
        [ 2.1025e-02,  3.1353e-02,  4.8357e-02, -1.6690e-02,  6.7854e-02,
          6.0258e-03, -2.4018e-03, -7.8240e-03,  6.5018e-03,  3.8822e-02],
        [ 6.9214e-03,  1.3442e-01, -3.9609e-02,  2.3448e-02, -1.8468e-02,
         -4.5174e-02, -9.7676e-03,  5.2646e-02, -3.5841e-03,  7.7792e-02],
        [ 2.2750e-02,  1.8506e-01, -6.2253e-02,  5.2257e-02, -3.6250e-02,
         -6.9970e-02,  8.2515e-03,  7.5384e-02, -5.4176e-03,  8.6164e-02],
        [ 1.1925e-02,  1.0635e-01, -4.7963e-03,  7.7340e-03,  1.0329e-02,
         -3.0566e-02,  1.1051e-02,  2.6333e-02, -1.4573e-02,  6.4160e-02],
        [ 1.2738e-02,  4.9066e-02,  3.6880e-02, -8.0178e-03,  5.4852e-02,
          4.3748e-03,  8.8340e-03, -2.2803e-03, -4.3515e-03,  4.3903e-02],
        [ 7.7636e-03,  9.4714e-02, -7.3912e-03,  4.9963e-03,  9.6603e-03,
         -4.4440e-02, -1.9022e-02,  2.6788e-02, -6.1251e-03,  5.6776e-02],
        [ 1.9532e-02,  5.9527e-02,  1.9429e-02, -1.8390e-02,  3.6408e-02,
         -1.8003e-02, -7.1810e-03,  1.3201e-02,  2.5290e-03,  5.3172e-02],
        [ 1.0394e-02,  1.7222e-01, -6.3787e-02,  4.8850e-02, -4.2447e-02,
         -7.6128e-02, -1.4077e-03,  6.6401e-02, -5.5629e-03,  8.8190e-02],
        [ 1.5328e-02,  2.3006e-01, -7.8152e-02,  7.6118e-02, -7.0304e-02,
         -9.8745e-02,  1.9690e-02,  9.8529e-02, -2.4112e-03,  1.2287e-01],
        [ 1.1831e-02,  2.2209e-01, -7.6405e-02,  7.9501e-02, -6.9190e-02,
         -8.3635e-02,  2.0577e-02,  9.1855e-02,  2.1187e-03,  1.0261e-01],
        [ 1.8164e-02,  1.1609e-01, -1.7971e-02,  1.4229e-02, -2.9233e-03,
         -4.8334e-02, -3.9831e-03,  4.5998e-02,  4.0798e-03,  7.5133e-02],
        [ 1.6663e-02,  8.2235e-02, -2.7129e-03,  3.7553e-03,  1.8395e-02,
         -1.7170e-02,  3.0237e-03,  2.4477e-02, -6.6012e-03,  6.2113e-02],
        [ 1.7479e-02,  4.6439e-02,  3.6972e-02, -1.4121e-02,  5.5964e-02,
          1.2427e-02,  8.4367e-04, -5.4932e-03,  2.2442e-03,  4.0643e-02],
        [ 1.4159e-02,  1.1466e-01, -1.9950e-02,  1.9647e-02,  2.1201e-03,
         -2.9160e-02,  2.7922e-04,  4.0827e-02, -2.0308e-02,  7.5029e-02],
        [ 1.6142e-02,  7.2656e-02,  1.4006e-02,  6.1846e-03,  3.5135e-02,
         -1.9582e-02, -1.2274e-03,  1.3370e-02,  4.5270e-03,  5.0457e-02],
        [ 1.3356e-02,  5.1207e-02,  2.5251e-02, -3.4635e-03,  3.9611e-02,
         -1.2022e-02, -4.7992e-03,  3.9506e-03,  3.3105e-03,  4.5586e-02],
        [ 1.3628e-02,  1.1143e-01, -1.1448e-02,  1.9182e-02,  2.6858e-03,
         -3.2861e-02,  2.1361e-03,  3.2114e-02, -4.8724e-03,  7.2863e-02],
        [-2.2598e-03,  2.7111e-01, -1.0749e-01,  7.9603e-02, -8.9866e-02,
         -1.0043e-01,  2.3078e-02,  1.0900e-01,  2.3711e-02,  1.1013e-01],
        [ 2.0045e-02,  5.3644e-02,  3.1402e-02, -1.6166e-02,  4.5693e-02,
         -2.2333e-02, -1.3314e-02, -2.6906e-04,  3.7473e-03,  5.0289e-02],
        [ 1.5185e-02,  1.0473e-01, -1.2067e-02,  2.4431e-02,  1.5153e-02,
         -4.6906e-02,  1.1978e-03,  3.5013e-02, -2.2733e-03,  6.6924e-02],
        [ 1.9309e-02,  4.0989e-02,  3.9283e-02, -8.8494e-03,  5.6455e-02,
         -1.0230e-03, -2.7804e-03, -2.3594e-03,  3.8410e-03,  4.2958e-02],
        [ 2.4002e-02,  7.7357e-02,  7.5937e-03, -3.3495e-03,  2.2005e-02,
         -2.5966e-02, -1.6576e-02,  1.7424e-02, -6.5646e-03,  5.9361e-02],
        [ 1.2019e-02,  1.6951e-01, -5.9858e-02,  3.0043e-02, -4.7402e-02,
         -8.0364e-02, -9.0990e-03,  7.4428e-02,  1.1406e-03,  1.0027e-01],
        [ 1.6150e-02,  2.7175e-02,  5.4148e-02, -2.0338e-02,  7.7504e-02,
          7.3199e-03,  7.7413e-04, -1.2193e-02,  7.1913e-03,  2.8134e-02],
        [ 1.5766e-02,  4.6742e-02,  4.0675e-02, -8.5290e-03,  5.7187e-02,
         -3.4151e-03,  3.9952e-03, -2.0512e-03,  1.9332e-03,  3.7994e-02],
        [ 1.6272e-02,  1.3163e-01, -3.3794e-02,  3.0499e-02, -1.5103e-02,
         -3.8682e-02,  2.8845e-03,  5.3023e-02, -1.6970e-02,  8.4789e-02],
        [ 1.5454e-02,  9.0688e-02,  5.2386e-03,  6.0741e-04,  2.0713e-02,
         -4.0812e-02, -2.0270e-02,  1.7627e-02, -2.5899e-03,  5.7915e-02],
        [ 6.8781e-03,  1.5552e-01, -3.5842e-02,  4.9895e-02, -2.4867e-02,
         -6.3548e-02,  2.8176e-02,  6.2832e-02, -1.0619e-02,  9.0820e-02],
        [ 9.1964e-03,  9.8788e-02, -4.4024e-03,  2.0036e-02,  8.9157e-03,
         -2.3131e-02,  4.6452e-03,  3.1520e-02, -7.9158e-03,  6.5131e-02],
        [ 1.4686e-02,  7.0144e-02,  1.3600e-02, -1.0779e-02,  2.7477e-02,
         -2.5402e-02, -1.3869e-02,  1.5636e-02, -1.8593e-03,  5.0854e-02],
        [ 1.0169e-02,  1.1655e-01, -7.9067e-04,  9.4140e-03,  1.1288e-02,
         -3.4901e-02,  1.7492e-03,  3.2894e-02,  1.5994e-02,  6.0318e-02],
        [ 9.8469e-04,  2.3689e-01, -7.7579e-02,  7.2408e-02, -6.7702e-02,
         -1.0287e-01,  1.3186e-02,  9.9140e-02,  2.1645e-02,  1.0578e-01],
        [ 1.1874e-02,  1.2989e-01, -3.1126e-02,  2.6542e-02, -5.2744e-03,
         -6.2805e-02, -6.9682e-03,  4.4683e-02,  4.9174e-03,  7.9076e-02],
        [ 1.7116e-02,  8.7506e-02, -1.2694e-02,  3.9416e-03,  6.2727e-03,
         -3.6519e-02, -9.1938e-03,  3.2163e-02, -5.3341e-03,  7.6619e-02],
        [ 1.2496e-02,  5.9830e-02,  2.4825e-02, -1.1152e-02,  3.7950e-02,
         -1.2035e-02, -2.6385e-03,  9.6781e-03, -7.1290e-03,  4.5354e-02],
        [ 1.0431e-02,  3.6308e-02,  3.5062e-02, -2.1190e-03,  5.5709e-02,
          6.3468e-03,  3.2728e-03, -1.2897e-03, -1.5535e-03,  4.0788e-02],
        [ 1.8835e-02,  1.0112e-01, -4.5858e-03,  1.6753e-02,  1.1908e-02,
         -3.4620e-02,  4.8799e-03,  3.5825e-02, -2.8337e-03,  6.4526e-02],
        [ 1.6390e-02,  5.2336e-02,  3.0970e-02, -1.2817e-02,  4.1943e-02,
         -7.4262e-03, -4.3108e-03,  2.2069e-03,  1.1118e-02,  4.9279e-02],
        [ 1.3053e-02,  8.5559e-02,  3.8273e-03,  6.6024e-03,  2.0963e-02,
         -3.0728e-02, -3.2774e-03,  1.9931e-02,  1.4083e-03,  5.7815e-02],
        [ 1.7406e-02,  4.0724e-02,  3.8455e-02, -1.0161e-02,  5.6370e-02,
          5.7350e-03,  3.3035e-03, -1.1317e-03, -5.4824e-03,  3.9277e-02],
        [ 9.6194e-03,  1.2699e-01, -2.7241e-02,  3.2537e-02, -8.4159e-03,
         -4.3891e-02, -2.3395e-03,  4.1326e-02,  2.6724e-03,  6.7337e-02],
        [ 8.6695e-03,  1.4122e-01, -3.7364e-02,  3.8837e-02, -1.8234e-02,
         -4.8119e-02,  1.0638e-02,  5.6766e-02, -1.2254e-02,  8.0533e-02],
        [ 2.0502e-02,  3.3007e-02,  5.3209e-02, -2.0731e-02,  7.4280e-02,
          4.1561e-03, -3.0585e-03, -1.4402e-02,  5.7504e-03,  3.0523e-02],
        [ 1.2225e-02,  1.1519e-01, -1.7182e-02,  1.7980e-02,  3.0257e-03,
         -5.2315e-02, -9.8576e-03,  4.1272e-02,  8.3066e-03,  6.7110e-02],
        [ 9.6320e-03,  2.0505e-01, -6.9380e-02,  6.7906e-02, -5.1809e-02,
         -8.1488e-02,  2.5646e-02,  8.5154e-02,  1.2293e-03,  9.6428e-02],
        [ 1.2457e-02,  7.2112e-02,  2.2163e-02,  1.0528e-02,  3.2405e-02,
         -7.1555e-03,  1.1061e-02,  1.3267e-02, -1.1834e-02,  5.1533e-02],
        [ 9.9333e-03,  1.2195e-01, -2.0804e-02,  1.0099e-02, -9.0263e-03,
         -5.2184e-02, -1.3697e-02,  4.5294e-02,  3.2928e-03,  7.6464e-02],
        [ 1.3432e-02,  4.6503e-02,  3.9768e-02, -1.2660e-02,  5.5404e-02,
          9.2085e-03,  3.6095e-03, -1.7035e-03, -1.4490e-03,  5.0209e-02],
        [ 1.7469e-02,  1.1951e-01, -1.5910e-02,  2.1200e-02,  7.4470e-03,
         -4.5505e-02, -3.8655e-03,  3.7848e-02, -6.3930e-04,  6.8252e-02],
        [ 1.7335e-02,  9.0866e-02, -4.1951e-03, -2.5239e-05,  1.1985e-02,
         -4.1715e-02, -2.4739e-02,  2.5733e-02,  6.7263e-03,  6.6511e-02],
        [ 1.2765e-02,  6.4615e-02,  2.1336e-02, -7.1211e-03,  3.2681e-02,
         -2.0845e-03,  9.0505e-03,  1.0315e-02, -1.4517e-02,  5.5355e-02],
        [ 1.7138e-02,  3.3270e-02,  4.5488e-02, -2.0857e-02,  5.9244e-02,
         -1.0624e-02, -1.4642e-02, -7.9047e-03,  8.9370e-03,  3.3170e-02],
        [ 1.3329e-02,  9.8444e-02, -5.7024e-03,  1.4148e-02,  1.0315e-02,
         -4.2061e-02, -1.0568e-04,  2.9235e-02,  1.0629e-02,  6.5131e-02],
        [ 1.5866e-02,  8.8360e-02, -1.3961e-02, -6.0285e-03,  1.1066e-02,
         -3.6438e-02, -2.6848e-02,  2.5603e-02,  7.3220e-03,  6.1848e-02],
        [ 1.5814e-02,  6.9481e-02,  2.4941e-02, -3.2205e-03,  3.9732e-02,
         -1.7213e-02,  7.8724e-03,  1.0513e-02,  2.0131e-03,  5.5283e-02],
        [ 1.4150e-02,  1.9716e-01, -6.7435e-02,  6.0028e-02, -6.0738e-02,
         -7.3853e-02,  4.4079e-03,  7.5171e-02, -2.9738e-04,  1.0840e-01],
        [ 1.3749e-02,  4.1727e-02,  4.3186e-02, -1.4231e-02,  6.0063e-02,
          8.6422e-03,  1.0707e-02, -5.8220e-03, -6.7680e-03,  4.3722e-02],
        [ 1.4766e-02,  9.8344e-02, -9.6014e-03,  3.0154e-03,  4.0704e-03,
         -2.6851e-02, -1.5614e-02,  2.7087e-02, -6.4980e-03,  6.9762e-02],
        [ 1.6202e-02,  4.1057e-02,  3.2195e-02, -9.7096e-03,  5.5697e-02,
         -8.7314e-03, -8.9890e-03, -5.1384e-04,  1.4907e-02,  3.8982e-02],
        [ 1.4163e-02,  4.7300e-02,  3.1788e-02, -1.1489e-02,  5.0584e-02,
         -9.2577e-03, -3.4553e-03,  4.8980e-05,  3.4963e-03,  4.2857e-02],
        [ 1.4418e-02,  4.6677e-02,  3.1862e-02, -1.4388e-02,  4.8908e-02,
         -9.3188e-03, -5.2461e-03,  1.9234e-03,  9.1520e-03,  4.5079e-02],
        [ 1.9163e-02,  7.0391e-02,  1.3860e-02, -1.2284e-02,  2.8736e-02,
         -2.5665e-02, -1.4386e-02,  1.1344e-02, -2.4693e-03,  5.2410e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.2989, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:07:14,653 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :565.25MB
2025-02-27 17:07:14,657 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :565.25MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:07:32,782 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:07:32,783 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:32,784 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:07:32,784 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:32,784 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:32,784 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:32,784 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :565.2529296875MB
2025-02-27 17:07:32,785 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 2.1552e-02,  9.2192e-02, -6.8196e-03,  2.4056e-04,  1.3930e-02,
         -3.9070e-02, -4.8181e-03,  2.7059e-02, -5.6400e-03,  6.0939e-02],
        [ 1.8235e-02,  3.9748e-02,  3.0580e-02, -2.2870e-02,  4.9710e-02,
         -1.8053e-02, -2.0462e-02, -3.1119e-03,  1.3138e-02,  4.1788e-02],
        [ 1.2266e-02,  5.1153e-02,  2.5010e-02, -1.5193e-02,  4.7630e-02,
         -5.9746e-03, -1.8955e-02,  7.0267e-03,  2.1673e-02,  4.1894e-02],
        [ 1.6733e-02,  7.8615e-02,  1.2107e-02, -3.7408e-03,  3.8664e-02,
         -1.8020e-02, -1.0041e-02,  2.0901e-02,  3.5937e-03,  4.5874e-02],
        [ 3.6588e-03,  1.1648e-01, -1.6991e-02,  3.3868e-02, -2.3708e-03,
         -3.3198e-02,  1.7684e-02,  4.1848e-02, -1.4801e-02,  7.8493e-02],
        [ 1.2406e-02,  9.0061e-02,  5.3646e-03,  3.6663e-03,  2.0036e-02,
         -2.2403e-02, -1.3895e-02,  2.0829e-02,  1.4478e-02,  4.9572e-02],
        [ 1.6464e-02,  1.5489e-01, -3.6301e-02,  2.5531e-02, -1.1602e-02,
         -7.8063e-02, -2.9872e-02,  5.2233e-02,  1.3710e-02,  6.4610e-02],
        [ 6.4993e-03,  7.8184e-02,  1.3569e-02,  1.1850e-02,  2.3804e-02,
         -1.0678e-02,  1.3219e-02,  2.1415e-02, -1.3148e-02,  6.2885e-02],
        [ 8.3305e-03,  2.4184e-01, -9.7728e-02,  7.2521e-02, -7.2544e-02,
         -1.1070e-01, -9.8118e-03,  1.0156e-01,  6.6041e-03,  1.0818e-01],
        [ 2.1576e-02,  3.9308e-02,  3.9540e-02, -1.8937e-02,  6.1216e-02,
          1.3278e-04, -2.0955e-03, -4.0418e-03,  7.5557e-03,  4.0856e-02],
        [ 1.0975e-02,  4.4033e-02,  3.8645e-02, -1.8469e-02,  5.2587e-02,
         -4.6857e-03, -1.1963e-02, -2.5802e-03,  1.4048e-02,  3.6862e-02],
        [ 1.3929e-02,  1.1078e-01, -1.7972e-02,  1.0178e-02,  2.1229e-03,
         -4.1663e-02, -1.2006e-02,  4.3123e-02, -2.3877e-03,  7.2543e-02],
        [ 1.6791e-02,  1.4687e-01, -3.0868e-02,  2.5166e-02, -1.2045e-02,
         -5.1966e-02,  1.5404e-03,  5.1728e-02, -1.5583e-03,  7.6554e-02],
        [ 9.8567e-03,  1.5471e-01, -4.1135e-02,  4.8125e-02, -2.4882e-02,
         -5.3842e-02,  1.8907e-02,  6.2380e-02, -6.9439e-03,  8.9297e-02],
        [ 8.6869e-03,  2.0592e-01, -7.4757e-02,  6.9114e-02, -5.9733e-02,
         -7.7177e-02,  1.2371e-02,  8.4336e-02, -4.5213e-03,  1.0208e-01],
        [ 3.0188e-03,  1.8323e-01, -5.8845e-02,  3.6790e-02, -3.9114e-02,
         -6.7198e-02, -1.0641e-02,  7.0807e-02,  1.8261e-02,  7.8237e-02],
        [ 1.6108e-02,  1.6872e-01, -5.5858e-02,  3.9910e-02, -3.6453e-02,
         -7.8684e-02, -1.0570e-02,  6.9821e-02,  6.7139e-03,  9.6835e-02],
        [ 1.9113e-02,  2.5349e-01, -9.2513e-02,  7.9779e-02, -7.7383e-02,
         -1.0889e-01,  1.7501e-02,  1.0685e-01, -4.5925e-03,  1.1695e-01],
        [ 2.1581e-02,  8.0841e-02,  7.1153e-03, -6.8439e-03,  2.8851e-02,
         -2.6768e-02, -1.5047e-02,  1.8405e-02, -9.2796e-04,  4.7795e-02],
        [ 1.4975e-02,  7.3470e-02,  1.3808e-02, -3.4662e-03,  3.1297e-02,
         -1.1631e-02,  5.8288e-03,  1.3341e-02, -4.1280e-03,  5.7889e-02],
        [ 1.9164e-02,  3.5778e-02,  3.8847e-02, -2.1120e-02,  5.5780e-02,
         -1.3444e-02, -1.5989e-02, -3.2139e-03,  8.3335e-03,  3.9865e-02],
        [ 1.7131e-02,  4.0273e-02,  4.5489e-02, -8.6911e-03,  5.9920e-02,
          2.4569e-03,  2.9505e-03, -5.0502e-03,  9.4407e-04,  3.8568e-02],
        [ 8.0775e-03,  5.3203e-02,  2.9942e-02, -8.7306e-04,  4.3673e-02,
          1.6703e-03,  7.7271e-03,  4.5453e-03, -8.9564e-03,  5.0251e-02],
        [ 2.0713e-02,  4.6554e-02,  2.9731e-02, -1.0307e-02,  4.8643e-02,
         -1.4656e-02, -7.6918e-03,  5.4497e-03,  1.0145e-02,  5.0273e-02],
        [ 1.3216e-02,  5.1150e-02,  3.3375e-02, -1.8921e-03,  4.9451e-02,
          1.8260e-03,  9.2133e-03,  4.3057e-03, -6.9797e-03,  4.4544e-02],
        [ 1.8204e-02,  9.2254e-02,  6.8932e-03,  7.5967e-03,  2.1709e-02,
         -1.2841e-02,  1.3907e-02,  2.3853e-02, -5.1595e-03,  6.4232e-02],
        [ 1.5751e-02,  1.0613e-01, -1.0245e-02,  1.1144e-02,  6.7599e-03,
         -3.6499e-02,  8.4254e-03,  3.2364e-02, -3.5535e-03,  7.5442e-02],
        [ 1.2392e-02,  1.1743e-01, -1.6091e-02,  2.8197e-02, -5.5850e-03,
         -3.7793e-02,  3.4697e-03,  3.9497e-02,  6.9701e-03,  6.8298e-02],
        [ 1.2416e-02,  1.1305e-01, -9.7983e-03,  8.3892e-03,  3.8434e-03,
         -3.4275e-02,  3.7293e-03,  3.1040e-02,  3.1356e-03,  5.8407e-02],
        [ 2.0361e-02,  7.0109e-02,  2.1834e-02,  5.1221e-03,  3.8846e-02,
         -8.1433e-03,  6.3557e-03,  1.4033e-02, -5.4943e-03,  5.1742e-02],
        [ 2.5782e-03,  9.7801e-02, -4.2959e-03,  3.0087e-02,  1.1430e-03,
         -3.7399e-02,  1.7161e-02,  3.6454e-02, -2.0717e-02,  7.2285e-02],
        [ 1.1111e-02,  8.3059e-02, -2.1771e-03, -1.2846e-02,  1.8654e-02,
         -4.4790e-02, -2.6896e-02,  2.2221e-02,  3.0001e-03,  4.9811e-02],
        [ 9.3570e-04,  2.3503e-01, -9.4100e-02,  6.9369e-02, -8.5674e-02,
         -9.3910e-02,  2.0198e-02,  9.1960e-02,  1.0558e-02,  1.1473e-01],
        [ 5.3594e-03,  9.7483e-02, -1.1561e-02,  2.8371e-02,  3.8052e-03,
         -2.4325e-02,  1.5702e-02,  3.4598e-02, -1.9565e-02,  6.9899e-02],
        [ 1.2251e-02,  2.2335e-01, -9.2039e-02,  6.5924e-02, -6.8343e-02,
         -1.0654e-01, -1.5924e-02,  9.6937e-02,  1.9717e-02,  1.1144e-01],
        [ 2.1034e-02,  4.6590e-02,  3.1038e-02, -2.4583e-02,  5.6558e-02,
         -1.1263e-02, -1.1194e-02, -2.7095e-03,  7.0187e-03,  3.7528e-02],
        [ 1.5404e-02,  9.4690e-02,  5.6204e-03,  1.5881e-02,  1.8753e-02,
         -1.7151e-02,  2.9568e-03,  2.4863e-02, -1.2485e-02,  6.2728e-02],
        [ 1.8305e-02,  1.2431e-01, -2.0382e-02,  2.4653e-02, -7.3160e-04,
         -4.1790e-02,  4.2607e-03,  4.4166e-02, -1.5011e-02,  8.1612e-02],
        [ 1.0117e-02,  7.0623e-02,  1.2657e-02,  2.0214e-04,  3.0636e-02,
         -1.9731e-02,  3.2407e-03,  1.7269e-02,  1.4505e-03,  5.4835e-02],
        [ 1.8938e-02,  4.4511e-02,  3.0646e-02, -6.1982e-03,  5.4080e-02,
         -6.8878e-03, -3.3517e-04,  3.9872e-03,  1.6818e-03,  4.4663e-02],
        [ 9.8130e-03,  1.3035e-01, -1.0785e-02,  1.5951e-02,  8.7753e-03,
         -4.7634e-02,  6.9156e-04,  3.4811e-02,  2.7107e-02,  5.4448e-02],
        [ 5.5045e-03,  1.8169e-01, -4.1345e-02,  4.8745e-02, -3.5446e-02,
         -7.0089e-02,  3.6284e-02,  6.9757e-02, -1.3489e-02,  9.6853e-02],
        [ 1.7645e-02,  9.7388e-02, -9.3121e-03,  1.2534e-02,  6.8597e-03,
         -4.5028e-02, -1.5043e-02,  3.2677e-02, -4.9765e-03,  6.8759e-02],
        [ 1.5905e-02,  7.3139e-02,  1.5652e-02,  1.0663e-02,  2.9204e-02,
         -1.1782e-02, -2.8531e-04,  1.3745e-02, -6.5346e-04,  5.4057e-02],
        [ 1.1338e-02,  8.7667e-02, -4.2326e-03,  1.4601e-02,  6.4080e-03,
         -2.3074e-02,  2.7275e-03,  2.5337e-02, -1.0041e-02,  5.9461e-02],
        [ 1.0867e-02,  7.7021e-02, -5.4031e-03, -4.3645e-03,  1.5297e-02,
         -2.4946e-02, -2.5183e-02,  2.5071e-02,  2.4136e-02,  5.3643e-02],
        [ 1.0167e-02,  1.0475e-01,  1.1432e-03,  8.7620e-03,  1.5164e-02,
         -2.7884e-02,  5.9211e-03,  2.2293e-02, -8.7637e-03,  5.5494e-02],
        [ 2.0350e-02,  9.0680e-02, -5.2963e-03, -3.5943e-03,  1.6730e-02,
         -3.3528e-02, -1.7756e-02,  2.7247e-02,  2.7464e-04,  6.3450e-02],
        [ 1.5033e-02,  1.4312e-01, -2.9492e-02,  3.1443e-02, -1.8817e-02,
         -4.1464e-02,  1.9743e-02,  5.5323e-02, -2.2422e-02,  7.9774e-02],
        [ 8.8684e-03,  1.7772e-01, -5.2734e-02,  6.2775e-02, -4.0716e-02,
         -6.7719e-02,  2.2817e-02,  7.4451e-02, -1.6586e-02,  9.7627e-02],
        [ 9.7204e-03,  1.9011e-01, -6.1357e-02,  3.7072e-02, -4.0833e-02,
         -8.6709e-02,  3.1754e-03,  8.1570e-02,  2.7553e-03,  9.2578e-02],
        [ 5.7509e-03,  2.0454e-01, -7.3517e-02,  6.0999e-02, -6.4426e-02,
         -7.0316e-02,  1.4571e-02,  7.8379e-02,  5.9002e-03,  1.1322e-01],
        [ 1.0079e-02,  1.0216e-01, -1.3892e-02,  3.3596e-02, -5.6748e-04,
         -3.1945e-02,  1.1381e-02,  3.9281e-02, -1.1604e-02,  7.1694e-02],
        [ 1.8337e-02,  3.5997e-02,  4.8832e-02, -1.2563e-02,  6.8576e-02,
          7.6090e-03,  2.5152e-03, -7.6565e-03,  3.1011e-03,  4.1252e-02],
        [ 1.3551e-02,  8.6290e-02,  1.0679e-02,  1.4572e-02,  2.9857e-02,
         -2.2678e-02,  8.9235e-03,  1.7131e-02, -9.3403e-04,  5.4423e-02],
        [ 1.1268e-02,  3.9456e-02,  3.5969e-02, -2.3147e-03,  5.5084e-02,
         -9.4621e-04, -6.3189e-05, -8.7458e-04,  2.3883e-03,  3.8343e-02],
        [ 1.3829e-02,  1.1766e-01, -1.2521e-02,  2.2439e-02,  1.3692e-04,
         -4.6121e-02,  2.3930e-03,  4.9176e-02, -5.2348e-03,  7.1625e-02],
        [ 1.9130e-02,  1.7919e-01, -5.2356e-02,  4.8500e-02, -3.5853e-02,
         -6.8773e-02, -2.2745e-03,  6.7858e-02,  1.1685e-02,  8.7645e-02],
        [ 7.8927e-03,  1.0280e-01, -2.6981e-03,  1.1402e-02, -2.9649e-03,
         -1.2667e-02,  1.7183e-02,  2.8752e-02, -2.1138e-02,  7.6428e-02],
        [ 6.6522e-03,  1.4766e-01, -4.8858e-02,  4.0415e-02, -2.1961e-02,
         -4.0844e-02,  3.3471e-04,  5.4967e-02, -1.0272e-02,  8.3120e-02],
        [ 1.0126e-02,  4.8346e-02,  4.0732e-02, -1.0993e-02,  5.2529e-02,
          4.1026e-03, -6.6076e-04, -5.9370e-03, -2.9800e-03,  4.1416e-02],
        [ 1.6421e-02,  1.0173e-01, -6.9088e-03,  1.4014e-02,  1.1849e-02,
         -3.4232e-02, -5.4487e-03,  2.8763e-02,  1.0164e-02,  6.1247e-02],
        [ 1.6817e-02,  5.0109e-02,  3.4046e-02, -1.6386e-02,  5.0289e-02,
         -1.4421e-03, -5.4495e-03,  2.3845e-04,  3.0507e-03,  3.9216e-02],
        [ 1.1521e-02,  6.0793e-02,  1.2322e-02, -1.1848e-02,  3.2992e-02,
         -2.1480e-02, -1.7049e-02,  4.9436e-03,  5.5265e-03,  4.8998e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.2935, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:07:32,864 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:07:32,869 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 1 :565.2578125MB
2025-02-27 17:07:32,871 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :565.25830078125MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 1 in valid loader:565.2412109375
Loader: valid. Accuracy: 0.109375
GPU End of epoch 1:565.2412109375
[31mSwitching template...[0m
2025-02-27 17:07:32,876 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:07:32,879 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:07:32,880 - INFO - [0] Instantiating RankWorker
Inital rank worker:565.2412109375MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0after initialization :565.2412109375MB

[32mCurrent descr name: submod_1, stage_id: 1, rank: 0[0m
2025-02-27 17:07:32,933 - INFO - [root] Sending stage_id = 0 mod to worker
[32mCurrent descr name: submod_0, stage_id: 0, rank: 1[0m
2025-02-27 17:07:33,051 - INFO - Instantiating PipeStageExecutor for stage 1
[31mSwitch template complete![0m
[31mTime taken to switch template: 5.924847602844238 seconds[0m
Epoch: 2
GPU Start of epoch 2:605.32470703125
2025-02-27 17:07:39,788 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:07:39,789 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:07:39,791 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:07:39,791 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:07:39,792 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:07:39,793 - DEBUG - [root] 2 instantiated
2025-02-27 17:07:39,793 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:07:39,793 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:07:39,794 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:07:39,794 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:07:39,794 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:07:39,795 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:07:39,800 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:07:39,801 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:07:39,805 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:07:39,806 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:07:39,806 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:39,806 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:07:39,807 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,807 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:07:39,807 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:39,807 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:07:39,811 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:07:39,814 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:07:39,815 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:07:39,815 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:07:39,815 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:07:39,817 - DEBUG - [1] Received getitem call: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:07:39,817 - DEBUG - [1] Received getitem call: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:07:39,820 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:07:39,820 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:07:39,825 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:07:39,826 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:07:39,828 - DEBUG - [1][0] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:07:39,829 - DEBUG - [1][0] Invoke call found 3 ValueReference arguments
2025-02-27 17:07:39,829 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:39,829 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 0_stage_backward
2025-02-27 17:07:39,829 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,830 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:07:39,830 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:39,830 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:07:39,832 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:07:39,834 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:07:39,835 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:07:39,836 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:07:39,836 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:07:39,836 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:07:39,837 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:07:39,839 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:07:39,840 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:07:39,840 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:07:39,841 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:07:39,841 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:07:39,843 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:07:39,844 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:07:39,846 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:07:39,847 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:07:39,847 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:07:39,847 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:07:39,847 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:07:39,849 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:07:39,850 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:07:39,852 - DEBUG - [1] Received getitem call: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:07:39,853 - DEBUG - [1] Received getitem call: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:07:39,853 - DEBUG - [1] Received getitem call: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:07:39,857 - DEBUG - [1] Received getitem call: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:07:39,859 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:07:39,859 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:07:39,860 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:07:39,860 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:07:39,861 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:07:39,861 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:39,861 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:07:39,862 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:07:39,862 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:07:39,862 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,863 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:07:39,863 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward'])
2025-02-27 17:07:39,864 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:39,865 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:07:39,868 - DEBUG - [1] Received getitem call: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:07:39,873 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:07:39,874 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:07:39,877 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:07:39,878 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:07:39,878 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:07:39,878 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:07:39,879 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:07:39,879 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:07:39,879 - DEBUG - [1][1] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:07:39,880 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:07:39,880 - DEBUG - [1][1] Invoke call found 3 ValueReference arguments
2025-02-27 17:07:39,880 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:07:39,881 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:39,882 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 1_stage_backward
2025-02-27 17:07:39,884 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,884 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1'])
2025-02-27 17:07:39,885 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:39,885 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:07:39,885 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:07:39,884 - DEBUG - [1] Received getitem call: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:07:39,886 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:07:39,888 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:07:39,889 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:07:39,891 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:07:39,892 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:07:39,892 - DEBUG - [1][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:07:39,893 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:39,893 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:07:39,893 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,893 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward'])
2025-02-27 17:07:39,893 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:39,894 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:07:39,896 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:07:39,897 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:07:39,898 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:07:39,901 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,902 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:07:39,903 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,903 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:07:39,904 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_3) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,905 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:07:39,906 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:07:39,906 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:07:39,907 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:07:39,907 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:07:39,908 - DEBUG - [1] Received getitem call: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:07:39,908 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:07:39,909 - DEBUG - [1] Received getitem call: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:07:39,909 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:07:39,910 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:07:39,924 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:07:39,925 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:07:39,926 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:07:39,927 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:07:39,928 - DEBUG - [1][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:07:39,928 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:39,928 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:07:39,928 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:07:39,929 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward', '0_sync_barrier'])
2025-02-27 17:07:39,929 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:07:39,929 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:07:39,930 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:07:39,931 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:07:39,932 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,932 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,934 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:07:39,935 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_3) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:07:39,936 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:07:39,927 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:07:39,939 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:07:39,940 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:07:39,942 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:07:46,291 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_4) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:07:46,304 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_4) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:07:50,541 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:50,542 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:07:50,542 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:50,543 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:50,543 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:50,543 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :637.82861328125MB
2025-02-27 17:07:50,544 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:07:50,811 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
2025-02-27 17:07:50,819 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:07:50,822 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:07:50,827 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:07:50,828 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
after processing the work_item.microbatch_id 0 :701.11962890625MB
2025-02-27 17:07:50,832 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :701.11962890625MB
All workitem count at loop begining: 5, current work item in ready runlist: 0, current work item in waiting runlist: 5
2025-02-27 17:07:54,082 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:54,083 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:07:54,083 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:54,083 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:54,084 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:07:54,084 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :701.11962890625MB
2025-02-27 17:07:54,085 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:07:54,144 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
2025-02-27 17:07:54,150 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:07:54,152 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:07:54,159 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:07:54,160 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
after processing the work_item.microbatch_id 1 :755.28564453125MB
2025-02-27 17:07:54,163 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :755.28564453125MB
All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:07:56,231 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:56,232 - DEBUG - [0][0] all operands ready: 0_stage_backward
2025-02-27 17:07:56,232 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:56,232 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:56,233 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:56,233 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 0 :755.28564453125MB
2025-02-27 17:07:56,234 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:07:56,234 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:07:56,340 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward
after processing the work_item.microbatch_id 0 :758.552734375MB
2025-02-27 17:07:56,346 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :758.552734375MB
All workitem count at loop begining: 3, current work item in ready runlist: 0, current work item in waiting runlist: 3
2025-02-27 17:07:56,379 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:07:58,562 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:07:58,563 - DEBUG - [0][1] all operands ready: 1_stage_backward
2025-02-27 17:07:58,564 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:07:58,564 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:58,565 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:07:58,566 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 1 :758.552734375MB
2025-02-27 17:07:58,567 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:07:58,568 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:07:58,596 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward
2025-02-27 17:07:58,602 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
after processing the work_item.microbatch_id 1 :704.38818359375MBBefore WorkItem Ready if: work_item.blocked_args_count(2) should be 0

2025-02-27 17:07:58,604 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :704.38818359375MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:08:15,033 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:08:15,034 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:15,034 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:08:15,034 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:15,035 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:15,035 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:15,035 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :704.38818359375MB
2025-02-27 17:08:15,039 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 1.3411e-01,  1.4175e-01,  3.9456e-01,  3.9655e-02,  1.9685e-02,
          1.2133e+00, -3.6322e-01, -3.7285e-01, -3.4111e-02,  7.9678e-03],
        [ 1.7503e-01,  1.6602e-01,  5.1718e-01, -2.0161e-01, -7.6799e-02,
          1.3326e+00, -7.7973e-01, -5.7182e-01,  1.4148e-01,  1.6075e-01],
        [-1.5918e-02,  2.3366e-01,  2.5886e-01, -3.7900e-01, -8.6869e-02,
          9.9103e-01, -3.3755e-01, -3.1507e-01,  4.1175e-01,  6.6665e-02],
        [ 1.6104e-01,  4.5135e-02,  2.9519e-01, -5.2369e-03,  2.0718e-01,
          1.0285e+00, -1.4835e-01, -2.7097e-01,  1.9322e-01,  9.5478e-02],
        [-3.3896e-02,  2.5503e-01,  2.9848e-01, -1.8202e-01,  8.7912e-02,
          1.2953e+00, -5.2436e-01, -5.5172e-01,  1.2750e-03,  3.1931e-01],
        [ 5.3658e-01,  2.8468e-02,  6.8745e-02, -2.0054e-01, -1.7028e-01,
          1.3640e+00, -5.4803e-01, -4.6118e-01, -2.5113e-01,  2.6091e-01],
        [-3.0952e-02, -3.9344e-02,  4.5345e-01, -1.1877e-01,  2.7180e-01,
          1.0713e+00, -2.9464e-01, -3.1629e-01, -4.5932e-02,  2.5057e-01],
        [ 2.9668e-01,  4.5212e-01,  3.1450e-01, -6.5659e-01, -9.1898e-02,
          1.5306e+00, -7.4645e-01, -4.6804e-01, -1.5537e-01,  3.4295e-01],
        [ 2.6964e-01,  1.1055e-01,  2.1084e-01, -2.6464e-01, -1.6857e-01,
          1.2494e+00, -5.1985e-01, -4.7449e-01,  1.3652e-02,  1.2226e-01],
        [ 1.3398e-01,  2.6097e-01,  1.6910e-01, -5.5644e-01, -2.3940e-01,
          1.2358e+00, -4.7996e-01, -4.3040e-01, -3.9402e-02,  1.5795e-01],
        [ 1.5494e-01,  2.1939e-01,  4.8816e-01, -5.3644e-02,  3.1895e-03,
          1.2387e+00, -1.7033e-01, -3.3340e-01,  9.1880e-03,  2.3641e-01],
        [ 2.2701e-01,  1.6779e-01,  2.0138e-01,  4.8455e-02,  2.9884e-02,
          1.0186e+00, -5.4943e-01, -4.0853e-01, -3.1065e-01,  4.5744e-01],
        [ 1.1156e-01,  8.3302e-02,  1.9369e-01, -1.6734e-01,  4.3289e-03,
          1.2599e+00, -5.8791e-01, -5.1904e-01,  7.3929e-02,  2.8714e-01],
        [ 2.4637e-01,  2.2165e-01,  4.7758e-01,  1.8358e-01, -1.1249e-01,
          1.4332e+00, -4.7160e-01, -3.3961e-01,  1.9996e-01,  1.3054e-01],
        [ 9.2242e-02,  2.9789e-01,  4.6990e-01, -9.0770e-02,  7.8032e-02,
          1.2158e+00, -2.8903e-01, -4.2319e-01,  2.1669e-01,  9.7807e-02],
        [ 3.2972e-01,  2.8065e-01,  2.6719e-01, -2.1076e-01,  1.8690e-01,
          1.0693e+00, -2.0214e-01, -1.5685e-01,  2.2650e-01,  5.6725e-03],
        [ 2.7906e-01,  2.4712e-01,  2.7771e-01, -1.7167e-01, -8.0346e-02,
          1.1845e+00, -5.7950e-01, -5.0188e-01, -6.7362e-02,  2.5061e-01],
        [-2.2972e-01,  3.4922e-01,  2.2985e-01, -2.4615e-01, -8.4827e-02,
          1.2139e+00, -5.0835e-01, -4.9525e-01,  1.2715e-01,  2.4965e-01],
        [ 2.2622e-01,  4.7666e-01, -6.3007e-02, -9.6888e-02, -4.5696e-01,
          1.4233e+00, -5.8317e-01, -7.3943e-01,  1.0819e-01,  2.8540e-01],
        [ 1.6841e-01,  5.4240e-02,  3.7927e-01, -3.1477e-01, -1.0890e-01,
          1.0959e+00, -4.1940e-01, -2.9726e-01,  1.7623e-01,  4.4366e-01],
        [ 1.3774e-01,  1.3282e-01,  3.6398e-01,  4.7025e-03,  1.7872e-01,
          9.7265e-01, -2.2612e-01, -3.2185e-01,  6.9051e-02,  1.4046e-03],
        [ 8.6417e-02,  3.1967e-01,  3.8319e-01, -3.7265e-01,  7.3565e-02,
          1.0789e+00, -3.8472e-01, -4.5868e-01, -1.5085e-01,  2.1161e-01],
        [ 3.9719e-01,  2.0071e-01,  3.1789e-01, -2.3924e-01, -3.4364e-03,
          1.2573e+00, -5.1635e-01, -5.4416e-01,  9.1486e-02,  2.5909e-01],
        [ 3.7186e-01,  1.9363e-01,  3.8042e-01,  7.7370e-02,  7.4497e-02,
          1.1273e+00, -1.1859e-01, -3.7964e-01,  5.1078e-02,  1.0214e-01],
        [ 4.6315e-03,  1.7002e-01,  3.6115e-01, -3.7471e-02,  4.8323e-02,
          1.2150e+00, -3.9995e-01, -4.4172e-01, -9.3399e-02,  1.1657e-01],
        [ 2.0480e-01,  5.2312e-01,  4.9692e-01, -2.4192e-01, -4.5953e-01,
          2.2595e+00, -1.1777e+00, -5.9714e-01, -1.8290e-02,  1.1016e-03],
        [-3.1323e-02,  1.6176e-01,  2.0214e-01, -2.2941e-01, -1.0630e-01,
          1.7154e+00, -6.1706e-01, -4.5917e-01, -6.1026e-02,  2.6944e-01],
        [ 1.1041e-01,  2.4587e-01,  2.3112e-01, -9.8989e-02,  1.8862e-01,
          1.1444e+00, -1.7464e-01, -2.5747e-01,  7.4628e-02,  1.8996e-01],
        [ 1.2090e-01,  2.0389e-01,  3.8583e-01, -8.1110e-02, -5.2826e-02,
          1.1522e+00, -3.9073e-01, -3.9017e-01,  2.3924e-01,  1.9219e-01],
        [ 1.9223e-01,  1.4553e-01,  4.4799e-01, -2.8042e-01, -5.0487e-02,
          1.0185e+00, -4.3604e-01, -4.1639e-01,  2.3752e-01,  3.0586e-01],
        [ 2.3516e-01,  1.0020e-01,  2.8275e-01, -1.5364e-01, -9.1187e-03,
          1.2009e+00, -4.8410e-01, -5.7174e-01,  7.0868e-02,  5.9503e-01],
        [ 6.1256e-02,  2.7281e-01,  2.8896e-01, -2.4851e-01,  1.7190e-01,
          1.1513e+00, -3.8410e-01, -2.6597e-01,  4.4568e-02,  8.4249e-02],
        [ 1.6656e-01,  2.1799e-01,  4.9752e-01, -1.4927e-01,  3.0052e-01,
          1.0815e+00, -1.4473e-01, -4.0586e-01, -7.2589e-02,  1.4847e-01],
        [ 2.1234e-01,  6.3481e-02,  3.5750e-01, -3.6730e-01, -1.3725e-01,
          1.4520e+00, -6.4358e-01, -4.6682e-01, -1.9205e-01, -1.3671e-01],
        [ 9.3867e-01,  5.1763e-01,  1.0385e-01, -5.5801e-02, -1.8878e-01,
          2.1468e+00, -8.6916e-01, -6.2092e-01, -2.2785e-01,  2.9507e-01],
        [ 9.8499e-02,  2.1945e-01,  2.3964e-01, -1.4443e-01,  9.7908e-02,
          9.3628e-01, -3.6794e-01, -4.1104e-01,  1.6972e-01,  7.1682e-02],
        [ 1.6976e-01,  2.5656e-03,  3.2213e-01, -2.0262e-01, -1.8691e-01,
          1.0273e+00, -4.4712e-01, -4.8979e-01, -1.3279e-01,  6.6309e-01],
        [ 2.6327e-01,  5.4581e-01,  2.3532e-01, -4.7995e-01, -4.1052e-01,
          1.4404e+00, -6.6003e-01, -4.4166e-01,  1.4168e-01,  3.3069e-01],
        [ 2.6153e-01,  1.4203e-01,  3.0206e-01, -3.0385e-02,  3.1430e-01,
          1.0786e+00, -5.8837e-02, -3.4064e-01,  2.0027e-01,  5.7992e-02],
        [ 4.5835e-02,  1.4721e-01,  5.2828e-01, -2.9783e-01,  1.4446e-01,
          1.1685e+00, -1.9073e-01, -4.6897e-01, -1.0395e-02,  3.7547e-01],
        [ 3.7349e-01,  1.0936e-01,  2.2667e-01,  6.4435e-04, -5.1589e-02,
          1.5029e+00, -7.9779e-01, -2.6468e-01, -5.1927e-02,  1.2453e-01],
        [ 1.5192e-01,  3.0757e-01,  2.4885e-01, -1.5745e-01,  1.1490e-02,
          1.1451e+00, -5.5133e-01, -6.6838e-01, -1.6658e-02,  2.1066e-01],
        [ 4.1300e-01,  3.9561e-01,  5.1093e-01, -2.8734e-01,  4.2425e-02,
          1.4375e+00, -4.1643e-01, -5.1865e-01,  1.7665e-01,  1.7924e-01],
        [ 2.9996e-01,  1.3286e-01,  5.0245e-01, -2.1430e-01,  1.4053e-01,
          1.2454e+00, -3.0327e-01, -5.6464e-01, -3.5766e-02,  2.3428e-01],
        [ 2.1929e-01,  2.7285e-01,  3.4317e-01, -3.2573e-02,  1.9224e-01,
          1.0812e+00, -3.6027e-01, -1.7453e-01,  8.6906e-02,  1.7140e-03],
        [ 1.5981e-01,  2.3333e-01,  4.0212e-01, -2.0783e-01, -1.9079e-01,
          1.1337e+00, -3.0795e-01, -3.1282e-01, -5.1356e-02,  1.6132e-01],
        [ 2.2999e-01,  9.0304e-02,  3.2187e-01, -2.2982e-01,  1.4957e-01,
          1.0660e+00, -2.4329e-01, -2.9740e-01,  1.2699e-01,  6.8972e-02],
        [ 1.6855e-02,  3.1407e-02,  3.8613e-01, -1.1715e-01,  1.9813e-01,
          1.0633e+00, -2.5252e-01, -3.8772e-01,  3.1716e-01,  2.0456e-01],
        [ 2.5051e-01,  3.7469e-01,  1.0996e-04, -2.8294e-01,  3.5846e-02,
          1.6732e+00, -3.7887e-01, -7.5292e-01, -1.0465e-01,  4.3551e-01],
        [ 9.1816e-02,  9.7893e-02,  4.7789e-01, -3.1818e-01,  2.0474e-01,
          1.2021e+00, -3.1559e-01, -3.2081e-01,  1.7340e-01,  3.8257e-01],
        [ 3.0620e-01,  2.8495e-01,  3.7002e-01,  2.2243e-01,  1.5835e-01,
          1.0473e+00, -2.3900e-01, -2.3866e-01,  5.5273e-02, -1.5632e-01],
        [ 3.4354e-01,  8.9934e-02,  2.9004e-01, -1.9314e-01, -4.9930e-02,
          1.4700e+00, -5.0789e-01, -5.4536e-01, -9.8929e-02,  2.6449e-01],
        [ 2.2552e-01,  4.5576e-01,  3.8673e-01, -3.2812e-01,  1.8905e-01,
          1.0314e+00, -2.1734e-01, -4.1734e-01, -1.5885e-01,  1.9000e-01],
        [ 2.4823e-01,  1.5596e-01,  3.7023e-01, -9.4831e-02, -2.0772e-01,
          1.5479e+00, -3.1683e-01, -4.3580e-01, -7.5894e-02,  3.6106e-01],
        [ 2.1342e-01,  3.6713e-01,  3.6589e-01, -2.1093e-01,  6.4286e-02,
          1.1713e+00, -4.6881e-01, -3.9804e-01, -1.9680e-01,  8.3191e-02],
        [ 5.2783e-02,  2.1278e-01,  2.6798e-01, -2.6113e-01,  1.2275e-02,
          1.1738e+00, -4.2265e-01, -5.8003e-01,  2.1401e-01,  2.1524e-01],
        [ 1.9186e-01,  3.4782e-01,  3.0758e-01, -5.7532e-02,  3.1793e-02,
          1.1800e+00, -2.7570e-01, -4.9169e-01,  8.7827e-03, -6.4295e-02],
        [ 2.9127e-01,  2.7625e-01,  5.2602e-01, -7.4405e-02, -7.1179e-02,
          1.6762e+00, -8.3113e-01, -3.9192e-01, -2.5137e-01,  9.8480e-02],
        [ 1.6322e-02,  2.5943e-01,  4.8653e-01, -1.4717e-01, -1.7122e-02,
          1.3444e+00, -4.8191e-01, -6.5849e-01, -1.3463e-02,  2.4886e-01],
        [ 3.7661e-01,  3.7141e-01,  5.1916e-01, -7.0209e-02, -1.9609e-01,
          1.6890e+00, -8.5216e-01, -5.8523e-01, -3.9324e-02,  3.6785e-01],
        [ 2.3643e-01,  3.5095e-01,  3.9399e-01, -8.4987e-02,  1.4957e-01,
          1.5358e+00, -6.7849e-01, -4.2526e-01,  7.4749e-02,  1.0105e-01],
        [ 1.7104e-01,  3.4131e-03,  1.7898e-01,  1.4170e-03,  5.8268e-02,
          1.3185e+00, -6.1473e-01, -3.3955e-01,  2.0073e-02,  4.0306e-01],
        [ 2.6250e-01,  2.3112e-01,  1.5405e-01, -1.0676e-01,  1.6560e-01,
          1.2391e+00, -4.8296e-01, -5.8200e-01,  1.6722e-01,  1.0194e-01],
        [-4.6907e-02,  1.0550e-01,  3.2771e-01, -2.6841e-01,  7.1337e-02,
          1.1686e+00, -5.6422e-01, -5.2729e-01,  8.1200e-02,  1.5407e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4071, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:08:15,119 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :688.3837890625MB
2025-02-27 17:08:15,125 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :688.3837890625MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:08:31,875 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:08:31,877 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:31,878 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:08:31,878 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:31,878 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:31,879 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:31,879 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :688.3837890625MB
2025-02-27 17:08:31,880 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 1.2155e-01,  2.7406e-01,  3.6408e-01, -5.3596e-02, -3.2892e-02,
          9.9197e-01, -3.0802e-01, -4.8115e-01,  1.0713e-01,  2.8984e-01],
        [-7.6214e-02, -6.4743e-02,  3.5984e-01, -4.2246e-02, -2.5294e-01,
          1.3024e+00, -5.8245e-01, -3.2776e-01, -2.2790e-02,  2.9001e-01],
        [ 1.1477e-01,  1.0855e-01,  2.3772e-01, -5.1559e-02,  1.9538e-01,
          9.0433e-01, -3.5170e-01, -2.8268e-01,  7.6723e-02,  1.9174e-01],
        [ 2.0261e-01,  4.4009e-01,  3.6747e-01, -2.6873e-01, -4.9451e-01,
          1.6822e+00, -7.1887e-01, -9.4125e-01,  9.5868e-02,  3.7328e-01],
        [ 1.9898e-01,  2.3774e-01,  4.0130e-01, -3.3460e-01,  1.4531e-01,
          1.3168e+00, -2.7281e-01, -3.0191e-01, -7.0584e-02, -4.1255e-02],
        [ 3.2061e-01,  7.5950e-01, -4.0910e-02,  2.5884e-01, -7.4068e-02,
          2.0468e+00, -9.8421e-01, -8.4973e-01,  4.3417e-01,  7.9771e-01],
        [-2.1706e-01,  2.1066e-01,  5.0446e-01, -2.8519e-01, -1.4999e-02,
          1.6614e+00, -6.3342e-01, -3.9499e-01, -1.0023e-01,  3.1647e-01],
        [ 2.1144e-01,  2.2134e-01,  4.1987e-01, -6.4941e-02,  1.0214e-01,
          1.0618e+00, -2.7290e-01, -5.5808e-01,  5.7028e-02,  1.8592e-01],
        [-4.5587e-02,  3.0537e-01,  2.1471e-01,  1.5238e-02,  2.0373e-01,
          9.8208e-01, -2.8463e-01, -4.1406e-01,  2.9611e-02,  7.0845e-02],
        [ 3.4875e-01,  7.6782e-02,  4.5386e-01, -2.0575e-01,  7.2270e-02,
          1.3379e+00, -7.1864e-01, -1.3497e-01, -8.8510e-02,  3.6423e-01],
        [ 8.7850e-02,  2.1484e-01,  2.8515e-01, -1.6657e-01,  1.4001e-01,
          9.8328e-01, -3.3474e-01, -3.7990e-01,  1.5775e-01,  1.7742e-01],
        [ 1.9057e-01,  2.2437e-01,  2.3893e-01, -1.1139e-01,  2.3250e-01,
          1.1487e+00, -2.9933e-01, -3.9928e-01,  2.5356e-01,  2.5233e-02],
        [ 4.8541e-01,  3.3984e-01,  2.2027e-01,  2.3721e-02, -5.2078e-03,
          1.0504e+00, -4.2164e-01, -5.3620e-01, -5.1528e-02,  2.4115e-01],
        [ 9.4518e-02,  1.4079e-01,  3.5430e-01, -1.9367e-01,  1.6312e-01,
          1.3650e+00, -3.5085e-01, -3.2011e-01,  3.4808e-02,  2.2971e-01],
        [ 8.0074e-02,  2.9504e-01,  3.3992e-01, -9.8129e-02, -4.9744e-02,
          1.0527e+00, -2.6181e-01, -2.0001e-01,  3.5357e-02,  5.5777e-02],
        [ 4.0717e-01,  1.9290e-01,  3.8666e-01, -1.2609e-01, -2.9209e-01,
          1.4163e+00, -5.4192e-01, -3.3305e-01, -8.4141e-04,  6.6473e-01],
        [ 4.4829e-01,  3.3417e-01,  2.7137e-01, -1.9747e-01,  4.4241e-02,
          1.1912e+00, -3.7249e-01, -4.0550e-01, -9.5855e-03,  1.8967e-01],
        [ 1.2374e-01,  1.4565e-01,  3.6670e-01, -1.5305e-01,  2.6540e-01,
          1.1212e+00, -2.5635e-01, -2.7209e-01,  1.4126e-01,  1.7833e-01],
        [ 4.9011e-02,  1.5439e-01,  3.6080e-01, -1.6754e-02,  8.7266e-02,
          1.1802e+00, -5.2505e-01, -4.4126e-01,  7.3347e-02,  8.9544e-02],
        [ 1.6056e-01,  2.2139e-01,  2.5882e-01, -8.5515e-03,  2.2917e-01,
          1.0646e+00, -1.2566e-01, -1.9109e-01,  6.2041e-03, -7.9358e-02],
        [ 2.3009e-01,  3.3007e-01,  3.6425e-01,  1.8404e-02, -2.5856e-02,
          1.1896e+00, -2.4084e-01, -4.2645e-01,  7.7796e-02,  3.6714e-01],
        [ 1.9653e-01,  1.8411e-01,  5.8798e-01, -2.0758e-01,  1.9898e-02,
          1.2253e+00, -7.5636e-01, -3.2002e-01, -2.8659e-01,  1.1898e-01],
        [ 1.6371e-01,  5.6032e-02,  3.9811e-01, -1.7435e-01,  6.7581e-02,
          1.0906e+00, -4.1313e-01, -2.7615e-01, -9.1253e-02,  3.5675e-02],
        [ 3.8674e-01,  2.0266e-02,  3.3029e-01, -3.9433e-01, -3.4710e-01,
          1.5224e+00, -2.8016e-01, -5.0281e-01,  1.8937e-01,  2.2485e-01],
        [-8.0706e-02,  1.6010e-01,  1.4518e-01, -9.3207e-02,  1.2773e-01,
          9.3060e-01, -2.8735e-01, -4.0833e-01,  1.2334e-01,  1.3230e-01],
        [ 4.3257e-01,  4.2945e-01,  5.3269e-01,  7.2024e-02, -2.8957e-01,
          2.0565e+00, -1.6656e+00, -7.2228e-01, -2.8422e-01,  5.3094e-01],
        [ 1.6620e-01,  2.2896e-01,  3.0503e-01,  1.2569e-02,  8.6245e-02,
          1.0218e+00, -3.5563e-01, -4.0931e-01,  1.6776e-03,  3.3048e-01],
        [ 2.9263e-01,  1.9271e-01,  2.2439e-01, -3.2579e-01,  2.1865e-01,
          1.3129e+00, -5.6284e-01, -4.9908e-01,  8.3081e-02,  1.5690e-01],
        [-2.0902e-02,  2.2432e-01,  2.6215e-01, -5.8673e-02, -5.7220e-02,
          1.3172e+00, -4.1232e-01, -5.9179e-01,  5.3037e-03,  1.4282e-01],
        [ 3.5346e-02,  5.2499e-01,  3.9252e-01, -2.4207e-01, -1.7954e-01,
          1.2516e+00, -4.9666e-01, -4.1901e-01,  5.0900e-02,  1.8068e-01],
        [ 2.1876e-01,  2.0093e-01,  5.4693e-01, -1.5712e-01,  1.2483e-01,
          1.3048e+00, -6.1809e-01, -5.5024e-01, -3.4138e-02, -2.8375e-02],
        [ 2.4418e-01,  2.0839e-01,  3.0734e-01, -1.7794e-01, -1.3536e-01,
          1.2708e+00, -5.8566e-01, -5.2948e-01,  2.5156e-01,  4.3411e-01],
        [ 2.0108e-01,  8.8240e-02,  2.9039e-01, -2.0060e-01,  1.2317e-01,
          8.0357e-01, -2.2649e-01, -3.4920e-01,  9.7241e-02,  1.8570e-01],
        [ 1.4320e-01,  4.7489e-02,  5.4077e-01, -7.3456e-02,  2.0094e-01,
          1.0330e+00, -1.2351e-01, -3.1207e-01,  3.5077e-02,  8.6742e-02],
        [ 1.6693e-01,  1.1155e-01,  4.3476e-01, -3.4700e-01, -5.0598e-02,
          1.7972e+00, -9.4231e-01, -1.0359e+00,  2.9765e-02,  3.0921e-01],
        [ 2.0684e-01,  1.2123e-02,  2.9241e-01, -2.7675e-01,  1.2795e-01,
          1.4117e+00, -8.7609e-01, -2.5104e-01, -1.5555e-01,  3.1689e-01],
        [ 3.5478e-01, -1.2922e-01,  4.9036e-02, -5.7053e-01,  1.5520e-01,
          1.1369e+00, -3.0777e-01, -3.1279e-01, -1.3111e-01,  4.4581e-01],
        [ 1.9862e-01,  6.1612e-02,  1.8627e-01, -1.4457e-01, -1.5088e-01,
          1.2494e+00, -4.8030e-01, -4.4439e-01,  3.0592e-01,  1.4070e-01],
        [ 2.3285e-01,  1.4917e-01,  4.9832e-01, -1.8311e-01, -1.9781e-02,
          9.0754e-01, -3.2789e-01, -3.3458e-01, -1.3741e-01,  1.6538e-01],
        [ 1.1976e-01,  2.0686e-01,  3.4476e-01, -7.4473e-02,  5.5760e-02,
          1.2670e+00, -5.9546e-01, -3.1386e-01, -9.5241e-02,  9.7999e-02],
        [ 1.7498e-01,  1.0378e-01,  3.0467e-01, -3.7548e-01,  9.0834e-02,
          1.1356e+00, -2.3241e-01, -2.5468e-01,  7.3553e-02, -8.3807e-02],
        [-4.9958e-02,  3.1661e-01,  3.9315e-01, -1.2169e-01,  9.6504e-02,
          1.2086e+00, -3.6736e-01, -3.5992e-01,  9.1296e-02,  1.4233e-01],
        [ 2.6806e-02,  2.2346e-01,  1.5512e-01, -2.6752e-01,  1.3403e-01,
          1.0684e+00, -3.1529e-01, -2.3844e-01, -2.0139e-02,  1.7938e-02],
        [ 1.6072e-01,  1.0770e-01,  9.5428e-02, -3.0780e-01, -2.3680e-01,
          1.4810e+00, -2.5985e-01, -6.3320e-01,  2.8151e-01,  1.7718e-01],
        [ 4.0234e-01,  1.9969e-01,  1.2329e-01, -1.9530e-02,  5.3042e-02,
          1.3160e+00, -7.0477e-02, -2.8078e-01,  9.1596e-02,  1.0007e-02],
        [ 2.0490e-01,  4.1248e-01,  2.5968e-01,  1.1635e-01, -3.5105e-01,
          2.1101e+00, -1.0270e+00, -3.6722e-01, -2.3202e-01,  3.9518e-01],
        [ 2.5141e-02,  3.0477e-01,  5.2939e-01, -3.3883e-01, -8.8977e-02,
          1.1052e+00, -2.7601e-01, -4.1253e-01, -9.6422e-03,  3.0195e-02],
        [ 2.4833e-01,  2.3499e-01,  3.2874e-01, -2.1091e-01,  1.2858e-01,
          8.9705e-01, -3.1456e-01, -4.4046e-01,  1.0322e-01,  7.7318e-02],
        [ 1.2067e-01,  1.3085e-01,  2.6168e-01, -1.6770e-01, -1.1636e-01,
          1.1378e+00, -2.2257e-01, -3.9415e-01,  3.1907e-02,  3.4051e-01],
        [ 2.3695e-01, -3.0410e-02,  4.1380e-01, -1.4010e-01,  7.4208e-02,
          1.0013e+00, -3.5936e-01, -3.4055e-01,  3.7157e-01,  1.7028e-01],
        [ 2.2001e-01,  1.0666e-01,  1.5638e-01, -5.7407e-01,  1.2186e-01,
          1.4082e+00, -3.8708e-01, -2.8626e-01, -1.5907e-01,  2.9642e-01],
        [-3.2804e-02,  2.5841e-01,  2.9702e-01, -3.3657e-01, -5.9086e-02,
          1.3850e+00, -5.0912e-01, -5.7127e-01,  5.4619e-02,  2.2001e-01],
        [ 1.3514e-01,  3.6113e-01,  2.0947e-01, -2.6017e-01,  5.6776e-02,
          1.1646e+00, -2.8250e-01, -3.3984e-01,  6.3246e-02,  8.2553e-02],
        [ 3.8635e-02,  2.3656e-01,  4.5800e-01,  1.0357e-02, -7.5003e-02,
          1.0970e+00, -3.7634e-01, -5.6913e-01,  3.0459e-01,  3.1256e-02],
        [ 1.3602e-01,  1.9501e-01,  3.6001e-01, -4.7755e-02,  2.3751e-01,
          1.0169e+00, -1.1355e-01, -4.7582e-01,  1.2298e-01, -4.8866e-02],
        [ 4.7146e-01,  4.7326e-01,  4.8971e-01, -3.4915e-01, -2.1422e-01,
          1.4515e+00, -4.8529e-01, -6.6162e-01, -6.0249e-02,  1.9668e-01],
        [ 4.7076e-01,  3.5247e-01,  3.5761e-01, -3.0008e-01,  1.0709e-02,
          1.3598e+00, -5.7821e-01, -7.2843e-01,  1.5998e-01,  2.7586e-01],
        [ 2.9893e-01,  3.3707e-01,  3.8026e-01, -2.6622e-03,  1.2777e-01,
          1.7297e+00, -4.8130e-01, -5.0581e-01,  4.7567e-03,  4.9060e-01],
        [-2.7602e-04,  2.7166e-01,  3.7460e-01, -1.4419e-01,  1.9428e-01,
          1.0174e+00, -3.4270e-01, -4.0812e-01, -5.3150e-02,  1.3564e-01],
        [ 1.9096e-01,  1.9765e-01,  2.0290e-01, -1.3074e-01, -4.8725e-01,
          1.4455e+00, -4.7357e-01, -4.0215e-01,  1.3745e-01,  3.4830e-01],
        [ 1.5703e-02, -1.2971e-02,  3.0003e-01, -3.5121e-01,  1.5284e-01,
          1.2604e+00, -6.5587e-01, -4.9561e-01, -1.9290e-03,  1.8356e-01],
        [ 2.4231e-01,  9.8405e-02,  2.4486e-01,  3.6694e-03,  2.5062e-01,
          1.3322e+00, -4.9117e-01, -5.4363e-01,  1.6342e-01,  2.8231e-01],
        [ 2.0543e-01,  1.0526e-01,  1.9813e-01, -1.8383e-01,  2.4323e-01,
          1.0693e+00, -2.1046e-01, -2.1605e-01, -4.0747e-02,  2.1175e-01],
        [ 3.4405e-01,  3.7603e-01, -2.4039e-01, -2.5625e-01, -3.1477e-01,
          1.6856e+00, -7.0256e-01, -6.4006e-01,  3.8870e-02,  6.9532e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4741, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:08:31,957 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:08:31,962 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 1 :688.3837890625MB
2025-02-27 17:08:31,963 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :688.38916015625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 9 in train loader:688.3837890625
Loader: train. Accuracy: 0.1171875
2025-02-27 17:08:32,419 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:08:32,420 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:08:32,422 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:08:32,422 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:08:32,424 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:08:32,424 - DEBUG - [root] 2 instantiated
2025-02-27 17:08:32,425 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:08:32,425 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:08:32,425 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:08:32,426 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:08:32,426 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:08:32,426 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:08:32,431 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:08:32,432 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:08:32,435 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:08:32,435 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:08:32,436 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:08:32,436 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:08:32,436 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:08:32,437 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:08:32,438 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:08:32,438 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:32,439 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:08:32,439 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:08:32,439 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:08:32,439 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:32,440 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:08:32,442 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:08:32,442 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:08:32,443 - DEBUG - [1] Received getitem call: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:08:32,447 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:08:32,448 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:08:32,448 - DEBUG - [1] Received getitem call: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:08:32,449 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:08:32,450 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:08:32,450 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:08:32,451 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:08:32,451 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:08:32,456 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:08:32,456 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:08:32,457 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:32,457 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:08:32,457 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:08:32,457 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:08:32,457 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:32,457 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:08:32,460 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:08:32,460 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:08:32,461 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:08:32,462 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:08:32,462 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:08:32,466 - DEBUG - [1] Received getitem call: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:08:32,467 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:08:32,467 - DEBUG - [1] Received getitem call: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:08:32,468 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:08:32,469 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:08:32,470 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:08:32,471 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:08:32,471 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:08:32,472 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:08:32,472 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:08:32,473 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:08:32,473 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:08:32,473 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:08:32,475 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:08:32,476 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:08:32,476 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:08:32,477 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:08:32,477 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:08:32,477 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:08:32,478 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:08:32,478 - DEBUG - [1][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:08:32,479 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:32,480 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:08:32,480 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:08:32,481 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:08:32,481 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:08:32,482 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:08:32,483 - DEBUG - [1][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:08:32,483 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:08:32,484 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:32,485 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:08:32,485 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:08:32,482 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1'])
2025-02-27 17:08:32,488 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:32,487 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:08:32,487 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:08:32,489 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1', '0_sync_barrier'])
2025-02-27 17:08:32,489 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:32,489 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:08:32,488 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:08:32,491 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:08:32,492 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:08:32,493 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:08:32,494 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:08:32,495 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:08:32,501 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:08:37,456 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:37,457 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:08:37,458 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:37,458 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:37,458 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:37,459 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :704.3857421875MB
2025-02-27 17:08:37,460 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:08:37,485 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
after processing the work_item.microbatch_id 0 :751.39013671875MB
2025-02-27 17:08:37,491 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:37,500 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:08:37,504 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:37,505 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:08:37,505 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :751.390625MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:08:37,506 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:37,506 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:37,506 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :751.390625MB
2025-02-27 17:08:37,507 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0380,  0.0005,  0.0526, -0.0525,  0.0402,  0.0241, -0.0110, -0.0585,
         -0.0360,  0.0526],
        [ 0.0441,  0.0043,  0.0505, -0.0549,  0.0389,  0.0253, -0.0104, -0.0537,
         -0.0315,  0.0535],
        [ 0.0479,  0.0072,  0.0498, -0.0492,  0.0347,  0.0308, -0.0169, -0.0550,
         -0.0280,  0.0640],
        [ 0.0494,  0.0126,  0.0425, -0.0415,  0.0465,  0.0250, -0.0085, -0.0531,
         -0.0250,  0.0631],
        [ 0.0463,  0.0113,  0.0468, -0.0545,  0.0474,  0.0219, -0.0096, -0.0576,
         -0.0297,  0.0553],
        [ 0.0350, -0.0088,  0.0533, -0.0608,  0.0505,  0.0187, -0.0117, -0.0563,
         -0.0439,  0.0524],
        [ 0.0460,  0.0133,  0.0455, -0.0517,  0.0282,  0.0236, -0.0104, -0.0534,
         -0.0343,  0.0537],
        [ 0.0472,  0.0084,  0.0427, -0.0391,  0.0442,  0.0306, -0.0045, -0.0562,
         -0.0212,  0.0637],
        [ 0.0402,  0.0012,  0.0441, -0.0489,  0.0391,  0.0210, -0.0097, -0.0583,
         -0.0315,  0.0583],
        [ 0.0478,  0.0146,  0.0456, -0.0420,  0.0492,  0.0196, -0.0090, -0.0578,
         -0.0244,  0.0634],
        [ 0.0452,  0.0145,  0.0386, -0.0435,  0.0424,  0.0219, -0.0085, -0.0552,
         -0.0212,  0.0644],
        [ 0.0441,  0.0061,  0.0438, -0.0435,  0.0334,  0.0192, -0.0053, -0.0556,
         -0.0268,  0.0600],
        [ 0.0372,  0.0034,  0.0494, -0.0496,  0.0394,  0.0240, -0.0122, -0.0546,
         -0.0375,  0.0557],
        [ 0.0381,  0.0085,  0.0424, -0.0443,  0.0360,  0.0124, -0.0048, -0.0532,
         -0.0226,  0.0599],
        [ 0.0472,  0.0059,  0.0477, -0.0535,  0.0490,  0.0269, -0.0121, -0.0520,
         -0.0334,  0.0598],
        [ 0.0319,  0.0010,  0.0509, -0.0526,  0.0407,  0.0230, -0.0066, -0.0554,
         -0.0337,  0.0521],
        [ 0.0384,  0.0053,  0.0500, -0.0452,  0.0447,  0.0183, -0.0083, -0.0589,
         -0.0321,  0.0552],
        [ 0.0488,  0.0079,  0.0449, -0.0477,  0.0463,  0.0201, -0.0092, -0.0561,
         -0.0272,  0.0582],
        [ 0.0396,  0.0185,  0.0447, -0.0475,  0.0335,  0.0243, -0.0027, -0.0568,
         -0.0299,  0.0696],
        [ 0.0392,  0.0045,  0.0456, -0.0531,  0.0396,  0.0246, -0.0132, -0.0565,
         -0.0333,  0.0623],
        [ 0.0417,  0.0054,  0.0488, -0.0513,  0.0485,  0.0231, -0.0063, -0.0615,
         -0.0336,  0.0571],
        [ 0.0440,  0.0111,  0.0474, -0.0415,  0.0372,  0.0265, -0.0085, -0.0571,
         -0.0226,  0.0632],
        [ 0.0352,  0.0106,  0.0375, -0.0431,  0.0330,  0.0271, -0.0100, -0.0540,
         -0.0270,  0.0684],
        [ 0.0369,  0.0018,  0.0486, -0.0524,  0.0439,  0.0191, -0.0117, -0.0569,
         -0.0299,  0.0559],
        [ 0.0411,  0.0059,  0.0393, -0.0447,  0.0352,  0.0219, -0.0113, -0.0545,
         -0.0281,  0.0635],
        [ 0.0471,  0.0110,  0.0414, -0.0440,  0.0363,  0.0245, -0.0067, -0.0514,
         -0.0268,  0.0647],
        [ 0.0319, -0.0091,  0.0490, -0.0637,  0.0447,  0.0226, -0.0137, -0.0578,
         -0.0447,  0.0553],
        [ 0.0367, -0.0035,  0.0476, -0.0618,  0.0482,  0.0265, -0.0129, -0.0606,
         -0.0393,  0.0610],
        [ 0.0400,  0.0093,  0.0421, -0.0472,  0.0467,  0.0218, -0.0093, -0.0599,
         -0.0302,  0.0537],
        [ 0.0466,  0.0120,  0.0416, -0.0406,  0.0463,  0.0228, -0.0079, -0.0543,
         -0.0240,  0.0623],
        [ 0.0450,  0.0104,  0.0405, -0.0397,  0.0422,  0.0239, -0.0131, -0.0532,
         -0.0230,  0.0589],
        [ 0.0379,  0.0033,  0.0476, -0.0592,  0.0473,  0.0231, -0.0087, -0.0606,
         -0.0405,  0.0570],
        [ 0.0414,  0.0090,  0.0498, -0.0537,  0.0384,  0.0158, -0.0082, -0.0553,
         -0.0247,  0.0581],
        [ 0.0362,  0.0049,  0.0379, -0.0490,  0.0394,  0.0174, -0.0119, -0.0552,
         -0.0260,  0.0609],
        [ 0.0355,  0.0188,  0.0504, -0.0452,  0.0285,  0.0216,  0.0021, -0.0604,
         -0.0326,  0.0664],
        [ 0.0464,  0.0165,  0.0408, -0.0419,  0.0440,  0.0158, -0.0125, -0.0546,
         -0.0277,  0.0538],
        [ 0.0344,  0.0104,  0.0511, -0.0524,  0.0411,  0.0255, -0.0093, -0.0567,
         -0.0386,  0.0587],
        [ 0.0373, -0.0064,  0.0547, -0.0479,  0.0431,  0.0254, -0.0035, -0.0563,
         -0.0408,  0.0593],
        [ 0.0418,  0.0067,  0.0460, -0.0508,  0.0433,  0.0293, -0.0021, -0.0623,
         -0.0287,  0.0548],
        [ 0.0390, -0.0059,  0.0572, -0.0547,  0.0464,  0.0195, -0.0060, -0.0614,
         -0.0472,  0.0574],
        [ 0.0408, -0.0062,  0.0528, -0.0555,  0.0499,  0.0312, -0.0104, -0.0594,
         -0.0418,  0.0611],
        [ 0.0363, -0.0060,  0.0546, -0.0587,  0.0497,  0.0249, -0.0144, -0.0609,
         -0.0505,  0.0598],
        [ 0.0468,  0.0075,  0.0478, -0.0548,  0.0532,  0.0238, -0.0135, -0.0562,
         -0.0329,  0.0576],
        [ 0.0400,  0.0148,  0.0500, -0.0487,  0.0337,  0.0277, -0.0051, -0.0563,
         -0.0386,  0.0689],
        [ 0.0332, -0.0032,  0.0465, -0.0516,  0.0342,  0.0239, -0.0112, -0.0586,
         -0.0302,  0.0553],
        [ 0.0317, -0.0034,  0.0472, -0.0565,  0.0410,  0.0211, -0.0073, -0.0601,
         -0.0396,  0.0630],
        [ 0.0416,  0.0155,  0.0433, -0.0478,  0.0323,  0.0278, -0.0058, -0.0561,
         -0.0313,  0.0686],
        [ 0.0410,  0.0146,  0.0493, -0.0516,  0.0330,  0.0288, -0.0061, -0.0551,
         -0.0359,  0.0602],
        [ 0.0355,  0.0084,  0.0432, -0.0492,  0.0295,  0.0197, -0.0025, -0.0553,
         -0.0296,  0.0600],
        [ 0.0550,  0.0134,  0.0388, -0.0337,  0.0491,  0.0250, -0.0079, -0.0531,
         -0.0188,  0.0628],
        [ 0.0351, -0.0072,  0.0481, -0.0593,  0.0511,  0.0198, -0.0136, -0.0626,
         -0.0417,  0.0535],
        [ 0.0320, -0.0161,  0.0603, -0.0684,  0.0489,  0.0261, -0.0097, -0.0629,
         -0.0561,  0.0592],
        [ 0.0353,  0.0038,  0.0507, -0.0587,  0.0450,  0.0255, -0.0126, -0.0661,
         -0.0440,  0.0558],
        [ 0.0379,  0.0114,  0.0501, -0.0425,  0.0420,  0.0259, -0.0050, -0.0605,
         -0.0347,  0.0644],
        [ 0.0387, -0.0062,  0.0504, -0.0542,  0.0461,  0.0217, -0.0133, -0.0553,
         -0.0318,  0.0454],
        [ 0.0382,  0.0085,  0.0456, -0.0461,  0.0398,  0.0226, -0.0105, -0.0612,
         -0.0371,  0.0628],
        [ 0.0421,  0.0110,  0.0450, -0.0442,  0.0439,  0.0247, -0.0091, -0.0583,
         -0.0294,  0.0632],
        [ 0.0352, -0.0061,  0.0547, -0.0592,  0.0494,  0.0196, -0.0161, -0.0659,
         -0.0512,  0.0565],
        [ 0.0395,  0.0009,  0.0475, -0.0514,  0.0460,  0.0282, -0.0080, -0.0546,
         -0.0337,  0.0631],
        [ 0.0386, -0.0017,  0.0475, -0.0527,  0.0409,  0.0206, -0.0106, -0.0558,
         -0.0315,  0.0623],
        [ 0.0464,  0.0143,  0.0396, -0.0381,  0.0421,  0.0219, -0.0093, -0.0566,
         -0.0238,  0.0597],
        [ 0.0388, -0.0022,  0.0447, -0.0504,  0.0415,  0.0285, -0.0161, -0.0593,
         -0.0324,  0.0621],
        [ 0.0417, -0.0076,  0.0591, -0.0612,  0.0548,  0.0243, -0.0115, -0.0673,
         -0.0509,  0.0583],
        [ 0.0486,  0.0118,  0.0430, -0.0446,  0.0445,  0.0197, -0.0083, -0.0545,
         -0.0292,  0.0594]], device='cuda:0', requires_grad=True), 'loss': tensor(2.3025, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:08:37,629 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :751.3935546875MB
2025-02-27 17:08:37,635 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :751.3935546875MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:08:40,541 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:40,541 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:08:40,542 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:40,542 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:40,542 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:08:40,543 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :751.3935546875MB
2025-02-27 17:08:40,544 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:08:40,579 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
2025-02-27 17:08:40,586 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:08:40,587 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:08:40,588 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:08:40,588 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 1 :806.0244140625MB
2025-02-27 17:08:40,590 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :806.0244140625MB
All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:08:40,593 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:08:40,593 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:08:40,594 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :806.0244140625MB
2025-02-27 17:08:40,599 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0388, -0.0007,  0.0470, -0.0517,  0.0333,  0.0255, -0.0096, -0.0527,
         -0.0347,  0.0550],
        [ 0.0441,  0.0125,  0.0489, -0.0443,  0.0368,  0.0217, -0.0087, -0.0591,
         -0.0327,  0.0650],
        [ 0.0348,  0.0036,  0.0477, -0.0508,  0.0354,  0.0221, -0.0116, -0.0599,
         -0.0364,  0.0595],
        [ 0.0487,  0.0119,  0.0496, -0.0419,  0.0311,  0.0317, -0.0113, -0.0555,
         -0.0261,  0.0656],
        [ 0.0486,  0.0083,  0.0467, -0.0546,  0.0268,  0.0212, -0.0055, -0.0496,
         -0.0278,  0.0591],
        [ 0.0378,  0.0012,  0.0490, -0.0538,  0.0484,  0.0202, -0.0116, -0.0623,
         -0.0387,  0.0590],
        [ 0.0558,  0.0139,  0.0464, -0.0435,  0.0367,  0.0232, -0.0126, -0.0505,
         -0.0220,  0.0612],
        [ 0.0446,  0.0163,  0.0461, -0.0395,  0.0397,  0.0270, -0.0077, -0.0528,
         -0.0289,  0.0643],
        [ 0.0462,  0.0154,  0.0376, -0.0380,  0.0462,  0.0288, -0.0066, -0.0530,
         -0.0219,  0.0671],
        [ 0.0415,  0.0029,  0.0500, -0.0507,  0.0432,  0.0263, -0.0088, -0.0546,
         -0.0368,  0.0567],
        [ 0.0422,  0.0127,  0.0380, -0.0409,  0.0374,  0.0303, -0.0096, -0.0571,
         -0.0215,  0.0660],
        [ 0.0435,  0.0026,  0.0515, -0.0512,  0.0431,  0.0261, -0.0115, -0.0560,
         -0.0310,  0.0575],
        [ 0.0374,  0.0105,  0.0549, -0.0529,  0.0430,  0.0226, -0.0099, -0.0615,
         -0.0415,  0.0550],
        [ 0.0344,  0.0063,  0.0457, -0.0543,  0.0405,  0.0216, -0.0119, -0.0552,
         -0.0311,  0.0556],
        [ 0.0413, -0.0013,  0.0478, -0.0610,  0.0500,  0.0295, -0.0134, -0.0529,
         -0.0431,  0.0572],
        [ 0.0382,  0.0027,  0.0435, -0.0513,  0.0392,  0.0183, -0.0078, -0.0557,
         -0.0284,  0.0575],
        [ 0.0365,  0.0061,  0.0452, -0.0551,  0.0422,  0.0193, -0.0106, -0.0609,
         -0.0337,  0.0592],
        [ 0.0440,  0.0120,  0.0380, -0.0381,  0.0368,  0.0289, -0.0057, -0.0564,
         -0.0239,  0.0683],
        [ 0.0415,  0.0108,  0.0468, -0.0561,  0.0322,  0.0257, -0.0054, -0.0553,
         -0.0315,  0.0589],
        [ 0.0479,  0.0124,  0.0480, -0.0477,  0.0446,  0.0210, -0.0103, -0.0602,
         -0.0336,  0.0601],
        [ 0.0463,  0.0122,  0.0436, -0.0386,  0.0417,  0.0240, -0.0054, -0.0590,
         -0.0293,  0.0619],
        [ 0.0334,  0.0033,  0.0528, -0.0546,  0.0439,  0.0171, -0.0094, -0.0687,
         -0.0442,  0.0532],
        [ 0.0330, -0.0107,  0.0552, -0.0655,  0.0471,  0.0296, -0.0128, -0.0545,
         -0.0547,  0.0567],
        [ 0.0388, -0.0076,  0.0465, -0.0615,  0.0507,  0.0247, -0.0150, -0.0579,
         -0.0425,  0.0597],
        [ 0.0362, -0.0076,  0.0629, -0.0626,  0.0525,  0.0205, -0.0115, -0.0704,
         -0.0555,  0.0535],
        [ 0.0463,  0.0107,  0.0473, -0.0458,  0.0446,  0.0223, -0.0073, -0.0586,
         -0.0290,  0.0642],
        [ 0.0287,  0.0013,  0.0426, -0.0489,  0.0297,  0.0196, -0.0125, -0.0580,
         -0.0258,  0.0591],
        [ 0.0357, -0.0003,  0.0489, -0.0560,  0.0407,  0.0164, -0.0170, -0.0604,
         -0.0301,  0.0550],
        [ 0.0366,  0.0077,  0.0431, -0.0441,  0.0299,  0.0203, -0.0067, -0.0551,
         -0.0271,  0.0616],
        [ 0.0401,  0.0136,  0.0456, -0.0481,  0.0261,  0.0192,  0.0006, -0.0582,
         -0.0275,  0.0642],
        [ 0.0425,  0.0108,  0.0472, -0.0524,  0.0418,  0.0164, -0.0132, -0.0605,
         -0.0386,  0.0600],
        [ 0.0337,  0.0090,  0.0510, -0.0525,  0.0410,  0.0262, -0.0142, -0.0628,
         -0.0367,  0.0608],
        [ 0.0411, -0.0110,  0.0572, -0.0628,  0.0527,  0.0269, -0.0075, -0.0632,
         -0.0533,  0.0621],
        [ 0.0294, -0.0143,  0.0615, -0.0709,  0.0513,  0.0212, -0.0113, -0.0695,
         -0.0633,  0.0549],
        [ 0.0372,  0.0052,  0.0530, -0.0545,  0.0462,  0.0239, -0.0119, -0.0617,
         -0.0421,  0.0567],
        [ 0.0407,  0.0080,  0.0465, -0.0470,  0.0476,  0.0194, -0.0151, -0.0579,
         -0.0340,  0.0567],
        [ 0.0509,  0.0142,  0.0414, -0.0436,  0.0337,  0.0242, -0.0046, -0.0522,
         -0.0255,  0.0690],
        [ 0.0495,  0.0165,  0.0418, -0.0397,  0.0475,  0.0198, -0.0116, -0.0541,
         -0.0239,  0.0620],
        [ 0.0433,  0.0124,  0.0463, -0.0481,  0.0472,  0.0197, -0.0102, -0.0556,
         -0.0303,  0.0583],
        [ 0.0443,  0.0147,  0.0442, -0.0444,  0.0378,  0.0251, -0.0094, -0.0569,
         -0.0280,  0.0642],
        [ 0.0359,  0.0068,  0.0491, -0.0491,  0.0391,  0.0247, -0.0066, -0.0574,
         -0.0342,  0.0615],
        [ 0.0409,  0.0084,  0.0457, -0.0515,  0.0362,  0.0166, -0.0045, -0.0549,
         -0.0302,  0.0621],
        [ 0.0377,  0.0100,  0.0513, -0.0555,  0.0405,  0.0220, -0.0076, -0.0574,
         -0.0391,  0.0664],
        [ 0.0365,  0.0036,  0.0490, -0.0446,  0.0349,  0.0240, -0.0042, -0.0584,
         -0.0317,  0.0610],
        [ 0.0390,  0.0038,  0.0445, -0.0487,  0.0307,  0.0353, -0.0059, -0.0614,
         -0.0365,  0.0670],
        [ 0.0367,  0.0030,  0.0511, -0.0544,  0.0367,  0.0236, -0.0049, -0.0494,
         -0.0343,  0.0567],
        [ 0.0458,  0.0083,  0.0439, -0.0447,  0.0379,  0.0212, -0.0031, -0.0550,
         -0.0268,  0.0609],
        [ 0.0362, -0.0005,  0.0499, -0.0559,  0.0454,  0.0179, -0.0142, -0.0552,
         -0.0433,  0.0554],
        [ 0.0386, -0.0014,  0.0465, -0.0530,  0.0415,  0.0174, -0.0069, -0.0564,
         -0.0323,  0.0579],
        [ 0.0366,  0.0153,  0.0503, -0.0423,  0.0301,  0.0223, -0.0022, -0.0589,
         -0.0308,  0.0693],
        [ 0.0412, -0.0010,  0.0485, -0.0589,  0.0489,  0.0152, -0.0149, -0.0578,
         -0.0411,  0.0536],
        [ 0.0436,  0.0127,  0.0428, -0.0433,  0.0346,  0.0282, -0.0084, -0.0536,
         -0.0239,  0.0595],
        [ 0.0351, -0.0012,  0.0515, -0.0563,  0.0457,  0.0259, -0.0124, -0.0560,
         -0.0389,  0.0594],
        [ 0.0351, -0.0080,  0.0519, -0.0579,  0.0434,  0.0246, -0.0051, -0.0577,
         -0.0421,  0.0620],
        [ 0.0467,  0.0127,  0.0433, -0.0506,  0.0448,  0.0167, -0.0132, -0.0587,
         -0.0296,  0.0594],
        [ 0.0397,  0.0037,  0.0512, -0.0490,  0.0437,  0.0220, -0.0121, -0.0607,
         -0.0387,  0.0578],
        [ 0.0336, -0.0138,  0.0575, -0.0692,  0.0559,  0.0277, -0.0102, -0.0622,
         -0.0555,  0.0604],
        [ 0.0428,  0.0108,  0.0403, -0.0429,  0.0306,  0.0220, -0.0043, -0.0592,
         -0.0310,  0.0671],
        [ 0.0360,  0.0071,  0.0488, -0.0485,  0.0391,  0.0187, -0.0038, -0.0582,
         -0.0297,  0.0586],
        [ 0.0413,  0.0116,  0.0469, -0.0389,  0.0311,  0.0325, -0.0105, -0.0549,
         -0.0227,  0.0595],
        [ 0.0348, -0.0028,  0.0469, -0.0562,  0.0335,  0.0148, -0.0082, -0.0587,
         -0.0350,  0.0591],
        [ 0.0408,  0.0114,  0.0444, -0.0433,  0.0391,  0.0241, -0.0125, -0.0577,
         -0.0287,  0.0594],
        [ 0.0390,  0.0129,  0.0423, -0.0519,  0.0442,  0.0196, -0.0154, -0.0565,
         -0.0317,  0.0583],
        [ 0.0441,  0.0035,  0.0494, -0.0531,  0.0432,  0.0255, -0.0117, -0.0577,
         -0.0319,  0.0625]], device='cuda:0', requires_grad=True), 'loss': tensor(2.2979, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:08:40,694 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:08:40,699 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 1 :806.0322265625MBGPU After processing batch 2 in valid loader:806.015625
Loader: valid. Accuracy: 0.109375
GPU End of epoch 2:806.015625
[31mSwitching template...[0m
2025-02-27 17:08:40,705 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:08:40,708 - INFO - [0] Instantiating RankWorker
Inital rank worker:806.015625MB
2025-02-27 17:08:40,710 - INFO - [root] Sending stage_id = 0 mod to worker
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
after initialization :806.015625MB

2025-02-27 17:08:40,712 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :806.015625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
[32mCurrent descr name: submod_0, stage_id: 0, rank: 0[0m
2025-02-27 17:08:40,730 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:08:40,768 - INFO - Instantiating PipeStageExecutor for stage 0
[32mCurrent descr name: submod_1, stage_id: 1, rank: 1[0m
[31mSwitch template complete![0m
[31mTime taken to switch template: 93.86824631690979 seconds[0m
Epoch: 3
GPU Start of epoch 3:808.609375
2025-02-27 17:10:16,668 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:10:16,670 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:10:16,671 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:10:16,671 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:10:16,672 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:10:16,673 - DEBUG - [root] 2 instantiated
2025-02-27 17:10:16,673 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:10:16,673 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:10:16,674 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:10:16,674 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:10:16,674 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:10:16,674 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:10:16,680 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:10:16,680 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:10:16,680 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:16,681 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:10:16,681 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:10:16,681 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:10:16,681 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:16,682 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:10:16,682 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:16,682 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :808.859375MB
2025-02-27 17:10:16,684 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:10:16,685 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:10:16,685 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:10:16,695 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:10:16,696 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:10:16,696 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:10:16,696 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:10:16,697 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:10:16,700 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:10:16,701 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:10:16,709 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:10:16,710 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:10:16,710 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:16,711 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:10:16,711 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:10:16,711 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:10:16,711 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:16,727 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:10:16,727 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:10:16,740 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:10:16,740 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:10:16,740 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:10:16,741 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:10:16,742 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:10:16,742 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:10:16,743 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:10:16,743 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:10:16,752 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:10:16,753 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:10:16,764 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:10:16,767 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:10:16,768 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:10:16,768 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:10:16,768 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:10:16,769 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:10:16,772 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:10:16,772 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:10:16,782 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:10:16,787 - DEBUG - [0][0] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:10:16,788 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:10:16,788 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:10:16,789 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 0_stage_backward_1
2025-02-27 17:10:16,794 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:10:16,796 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:10:16,796 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:10:16,797 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:10:16,797 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:10:16,797 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:10:16,798 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:10:16,798 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:10:16,799 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:10:16,810 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:10:16,813 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:10:16,810 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:10:16,815 - DEBUG - [0] Received getitem call: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:10:16,802 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:10:16,822 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:10:16,822 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:10:16,827 - DEBUG - [0] Received getitem call: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:10:16,831 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:10:16,832 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:10:16,833 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:10:16,833 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:10:16,834 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:10:16,834 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:10:16,834 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:10:16,835 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:10:16,850 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:10:16,850 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:10:16,852 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:10:16,852 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:10:16,855 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:10:16,855 - DEBUG - [0][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:10:16,856 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:10:16,856 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:10:16,856 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:10:16,856 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1'])
2025-02-27 17:10:16,856 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:10:16,857 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:10:16,857 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:10:16,857 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:10:16,858 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:10:16,860 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:10:16,863 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_7) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:10:16,864 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_6) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:10:16,870 - DEBUG - [0][1] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:10:16,870 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:10:16,871 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:10:16,871 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 1_stage_backward_1
2025-02-27 17:10:16,871 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:10:16,871 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier'])
2025-02-27 17:10:16,873 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:10:16,876 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:10:16,877 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:10:16,877 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:10:16,878 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:10:16,879 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:10:16,880 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:10:16,880 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:10:16,883 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:10:16,887 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:10:16,886 - DEBUG - [0] Received getitem call: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:10:16,891 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:10:16,892 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:10:16,893 - DEBUG - [0] Received getitem call: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:10:16,893 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:10:16,898 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:10:16,899 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:10:16,899 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:10:16,901 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:10:16,901 - DEBUG - [0][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:10:16,902 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:10:16,902 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:10:16,902 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:10:16,903 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier', '1_stage_backward_1'])
2025-02-27 17:10:16,903 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:10:16,903 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:10:16,904 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:10:16,906 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:10:16,908 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:10:16,909 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:10:16,910 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:10:16,912 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_7) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:10:16,913 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:10:16,916 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_6) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:10:17,573 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
2025-02-27 17:10:17,800 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
after processing the work_item.microbatch_id 0 :1051.119140625MB
2025-02-27 17:10:17,801 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1051.119140625MB
All workitem count at loop begining: 5, current work item in ready runlist: 1, current work item in waiting runlist: 4
2025-02-27 17:10:17,804 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:10:17,804 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:10:17,805 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :1051.119140625MB
2025-02-27 17:10:17,806 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:10:20,812 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :1283.12890625MB
2025-02-27 17:10:20,820 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1291.12890625MB
All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:10:20,881 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:10:54,592 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:10:54,593 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:10:56,430 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:11:29,502 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:11:29,503 - DEBUG - [0][0] all operands ready: 0_stage_backward_1
2025-02-27 17:11:29,504 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:11:29,504 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:29,504 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:11:29,504 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 0 :1307.134765625MB
2025-02-27 17:11:29,506 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:11:29,506 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:11:29,514 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:11:29,521 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:11:29,522 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:11:31,301 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward_1
2025-02-27 17:11:31,314 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:11:31,317 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:11:31,321 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:11:31,322 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 0 :1085.7041015625MB
2025-02-27 17:11:31,328 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
Periodic memory cleanup :1085.7041015625MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:11:31,420 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:31,420 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:31,420 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1085.7041015625MB
2025-02-27 17:11:31,422 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 3.0463e-01,  6.3271e-02,  2.0067e-01, -2.2721e-01,  4.6533e-02,
          9.9802e-01, -2.4185e-01, -2.2784e-01,  9.9102e-02,  5.5453e-02],
        [ 2.1251e-01,  3.6453e-02,  3.3296e-01, -3.8803e-01, -1.4919e-01,
          1.1707e+00, -5.2286e-01, -4.3432e-01, -2.3107e-01,  3.0226e-01],
        [ 5.7799e-02,  2.5625e-01,  5.0745e-01, -2.8196e-01,  2.3904e-01,
          1.1170e+00, -3.0287e-01, -4.7841e-01,  3.2806e-01,  1.6032e-01],
        [ 8.6965e-02,  2.5655e-02,  2.9869e-01, -6.6490e-03,  6.7865e-02,
          1.2014e+00, -2.8938e-01, -1.5832e-01,  1.6962e-01,  1.8654e-02],
        [ 4.4911e-02,  2.1983e-01,  3.8194e-01, -3.6242e-01,  1.8239e-01,
          1.2367e+00, -1.6367e-01, -3.3954e-01, -2.7189e-01,  2.9623e-01],
        [ 8.1019e-03,  3.1464e-01,  3.7604e-01, -2.2468e-01, -1.3274e-01,
          1.3078e+00, -6.6496e-01, -3.0118e-01,  1.7646e-02,  2.9349e-01],
        [ 1.8648e-01,  2.1507e-01,  3.5300e-01, -1.2378e-02,  1.6852e-01,
          1.0655e+00, -2.7133e-01, -3.3320e-01,  1.2623e-01,  4.7323e-02],
        [ 2.1485e-01, -6.4943e-02,  3.8629e-01, -1.1591e-01, -6.9259e-02,
          1.2342e+00, -6.7456e-01, -3.3158e-01,  1.9280e-01, -3.6083e-03],
        [ 2.7087e-01,  4.1198e-01,  6.1556e-02, -2.8438e-01, -2.1901e-01,
          1.4481e+00, -5.2009e-01, -4.5536e-01,  1.2680e-01,  2.6242e-01],
        [ 3.1407e-01,  4.0897e-01,  3.6552e-01, -1.6772e-01,  1.2707e-01,
          1.5595e+00, -8.5636e-01, -5.6068e-01,  1.6722e-02,  4.1825e-01],
        [-3.8704e-02,  8.9504e-02,  1.7617e-01, -4.6517e-02,  1.0393e-03,
          1.1466e+00, -5.1389e-01, -2.3713e-01,  5.3678e-02,  3.4113e-01],
        [ 1.1515e-01, -8.9412e-02,  3.4704e-01, -1.2550e-01,  1.1728e-01,
          1.0206e+00, -1.3146e-01, -2.9099e-01,  9.0360e-02,  1.7441e-01],
        [ 1.9233e-01,  2.1294e-01,  1.9051e-01, -1.0676e-01,  1.1031e-02,
          1.4030e+00, -4.5584e-01, -2.7065e-01,  1.0578e-01,  2.4748e-01],
        [ 2.2789e-01,  4.6466e-01,  2.0628e-01, -1.3433e-01, -1.6000e-01,
          1.4660e+00, -3.7897e-01, -4.4229e-01,  2.3812e-01,  3.1661e-01],
        [ 3.3959e-01,  1.8290e-01,  3.8412e-01, -4.2241e-01,  6.9359e-02,
          1.1942e+00, -2.3016e-01, -6.0785e-01, -2.4015e-02,  3.6279e-01],
        [ 1.2019e-01,  1.7177e-01,  3.6398e-01, -1.0637e-01,  2.0012e-01,
          1.2912e+00, -4.7000e-01, -3.9693e-01, -2.3576e-02,  2.8952e-01],
        [ 8.4829e-02,  4.9572e-01,  2.9189e-01, -2.4168e-01,  2.5049e-01,
          1.4895e+00, -4.4630e-01, -2.6917e-01, -4.8241e-02,  2.5814e-02],
        [ 4.3385e-01,  4.7591e-01,  3.5483e-01,  3.9367e-02, -2.4953e-01,
          1.6833e+00, -1.0432e+00, -3.6070e-01,  3.9464e-01,  4.4479e-01],
        [ 5.2619e-01,  3.5919e-01,  4.0969e-01,  2.0112e-01,  2.8162e-02,
          1.3648e+00, -5.4012e-01, -2.2441e-01, -1.2427e-01,  1.2356e-01],
        [ 2.7096e-02,  3.0287e-01,  3.5967e-01, -2.7616e-01, -1.0967e-01,
          1.2162e+00, -2.1697e-01, -5.1794e-01,  1.3585e-01,  1.1037e-01],
        [ 2.1562e-01,  1.6573e-01,  4.9644e-01, -9.4689e-02,  2.2463e-02,
          1.0551e+00, -1.3241e-01, -3.1041e-01,  1.1165e-01,  1.3616e-01],
        [ 3.7371e-01,  2.5936e-01,  1.1039e-01, -1.8155e-01,  1.2038e-01,
          1.4261e+00, -5.3676e-01, -6.0949e-01,  3.1880e-01,  2.6746e-01],
        [-3.2650e-02,  2.5193e-01,  2.6469e-01, -1.9079e-02,  1.4568e-01,
          9.9183e-01, -2.9857e-01, -1.4151e-01, -2.9317e-01,  4.7194e-02],
        [ 1.5505e-01,  4.0921e-01,  1.8170e-01, -3.0716e-01,  8.2647e-02,
          1.8340e+00, -6.6338e-01, -4.7209e-01,  2.6714e-01,  3.9049e-01],
        [ 9.6957e-02,  3.4059e-01,  4.2875e-01, -1.9842e-01, -5.2223e-02,
          1.3305e+00, -2.4001e-01, -5.6046e-01,  1.4188e-01,  4.2974e-01],
        [ 5.1352e-01,  2.0712e-01,  3.7166e-01, -8.7864e-02, -7.1345e-02,
          1.2496e+00, -6.3439e-01, -6.6798e-01, -4.5727e-02,  2.9146e-01],
        [ 1.9487e-01,  1.7603e-01,  3.4485e-01, -6.1973e-02, -1.6124e-01,
          1.0990e+00, -1.1162e-01, -3.2291e-01, -1.4514e-02,  2.7617e-01],
        [ 1.2213e-01,  1.7818e-01,  3.8807e-01, -2.6320e-01,  2.3658e-01,
          1.1019e+00, -3.0370e-01, -4.5432e-01,  1.5489e-01, -1.6770e-02],
        [ 6.6694e-01,  5.9236e-01,  1.6186e-01,  9.4357e-02, -4.3593e-01,
          1.4466e+00, -7.6690e-01, -8.0720e-01, -5.1943e-02, -1.4737e-02],
        [ 6.1710e-02,  3.9851e-01,  2.0089e-01, -4.6206e-01, -1.3848e-01,
          1.5754e+00, -6.3638e-01, -6.6130e-01,  1.6032e-01,  3.4291e-01],
        [ 6.1987e-02,  2.5124e-01,  4.0878e-01, -2.3627e-01,  1.8665e-01,
          1.1624e+00, -2.2246e-01, -4.3031e-01,  2.2366e-01,  5.1893e-02],
        [ 1.5760e-02,  1.8146e-01,  2.3479e-01,  4.6128e-02,  1.1138e-01,
          1.0402e+00, -3.0215e-01, -2.0415e-01,  1.3491e-01,  8.0620e-02],
        [ 2.6772e-01,  2.2677e-01,  5.7226e-01, -2.2164e-01,  1.4974e-01,
          1.3614e+00, -2.7605e-01, -3.9481e-01,  4.2519e-02,  1.3905e-01],
        [ 3.5876e-01,  2.5254e-01,  2.4561e-01, -2.4099e-01,  2.1747e-03,
          1.1684e+00, -5.8539e-01, -8.1509e-01, -2.2654e-01,  3.0559e-01],
        [ 2.3592e-01,  3.2691e-01,  3.2730e-01, -1.9065e-01, -6.2554e-02,
          1.2792e+00, -4.9945e-01, -5.2917e-01, -2.3509e-03,  2.3372e-01],
        [-2.8705e-02,  2.6294e-01,  4.1825e-01, -1.3798e-01,  1.8480e-01,
          1.0188e+00, -3.0119e-01, -3.2768e-01,  2.7993e-01,  1.0381e-01],
        [ 2.0386e-01, -1.6853e-02,  9.9177e-02,  1.9211e-02,  1.8271e-03,
          1.4610e+00, -4.8855e-01, -3.4957e-01, -3.6536e-01,  9.3549e-02],
        [ 2.8058e-01,  2.0095e-02,  3.1144e-01, -2.7653e-01,  3.6173e-02,
          1.1068e+00, -3.0549e-01, -2.3385e-01,  2.7345e-01,  1.9286e-01],
        [ 1.3304e-01,  1.7970e-01,  2.6600e-01, -1.4663e-01, -7.2775e-03,
          1.2015e+00, -2.4917e-01, -5.0370e-01,  1.0674e-01,  2.6832e-01],
        [ 9.5647e-02,  8.2825e-02,  3.9651e-01, -4.6557e-01, -9.3162e-02,
          1.2758e+00, -7.1690e-01, -4.9374e-01, -1.9792e-01,  9.0809e-02],
        [ 2.9442e-01,  1.5519e-01,  5.9128e-01, -1.1103e-01,  1.3825e-01,
          1.0702e+00, -2.2141e-01, -2.9494e-01, -7.6543e-02,  2.6515e-01],
        [ 7.5338e-02,  9.3805e-02,  1.4010e-01, -2.6610e-01, -7.0400e-02,
          1.2039e+00, -4.1914e-01, -3.9570e-01,  1.3215e-03, -4.9285e-02],
        [ 1.2837e-01,  2.1650e-02,  2.3113e-01, -4.4661e-01, -5.9449e-02,
          1.1345e+00, -3.9255e-01, -4.6057e-01,  2.5898e-02,  6.2309e-02],
        [-1.2171e-02, -8.3769e-03,  4.0734e-01, -3.3880e-01, -1.8455e-01,
          9.6176e-01, -5.3419e-01, -4.6584e-01,  1.5297e-01,  1.5506e-01],
        [ 3.5256e-01,  3.6134e-02,  4.3829e-01, -4.5074e-02, -2.5647e-01,
          1.3009e+00, -5.3115e-01, -5.4147e-01, -6.2210e-02,  3.7831e-01],
        [ 1.0456e-01,  2.8852e-01,  4.9874e-01, -3.1789e-02,  8.8615e-02,
          1.2444e+00, -4.3897e-01, -2.8625e-01,  6.9099e-02,  2.2283e-03],
        [ 3.1079e-02,  2.0112e-01,  3.4910e-01, -7.6083e-02,  1.2175e-01,
          1.0391e+00, -3.3892e-01, -3.9576e-01,  2.9681e-01,  2.0101e-01],
        [ 2.5747e-01,  3.3009e-01,  3.1691e-01, -2.5996e-01, -1.0861e-01,
          1.3788e+00, -6.6657e-01, -2.6026e-01, -1.3268e-02, -2.2306e-02],
        [ 4.3371e-01,  4.9972e-01,  1.5498e-01,  9.3400e-02,  5.8609e-02,
          1.2972e+00, -6.5689e-01, -7.4176e-01, -1.3666e-01,  6.0046e-02],
        [ 9.7701e-02,  3.3304e-01,  2.6964e-01, -2.9680e-01, -5.6639e-02,
          1.5734e+00, -6.5417e-01, -5.3028e-01,  3.1831e-02,  4.7116e-01],
        [-7.5350e-02,  1.9374e-01,  5.6065e-01, -8.6760e-02,  1.3096e-01,
          1.1442e+00, -2.4696e-01, -5.1449e-01, -4.7202e-02,  4.0572e-01],
        [ 2.2041e-01,  2.5874e-01,  3.9886e-01, -2.6098e-01, -7.7960e-02,
          1.1850e+00, -5.8489e-01, -6.1785e-01,  3.4014e-02,  4.0993e-02],
        [ 1.7618e-01,  2.7931e-01,  3.2509e-01, -2.3468e-01,  9.9426e-03,
          1.3282e+00, -4.8802e-01, -4.6365e-01,  5.8467e-02,  4.0320e-01],
        [ 1.6256e-01, -1.4192e-01,  2.0414e-01, -1.9955e-01, -1.1735e-02,
          1.0207e+00, -4.0497e-01, -4.0814e-01, -1.0223e-01,  2.2137e-01],
        [ 9.7903e-02,  1.4028e-01,  3.3308e-01, -2.4753e-01, -1.9732e-01,
          1.4477e+00, -6.5710e-01, -3.5905e-01,  8.0787e-03,  1.0994e-01],
        [ 2.4284e-01,  3.0908e-01,  2.4703e-01, -2.8096e-01,  1.2225e-02,
          1.0240e+00, -4.5786e-01, -3.8408e-01,  2.3018e-01, -8.8559e-02],
        [ 2.7818e-01,  3.7624e-01,  1.4798e-01, -2.9061e-01,  9.8600e-02,
          1.2129e+00, -1.2811e-01, -5.5957e-01,  1.2935e-01,  1.1556e-02],
        [ 1.4852e-01,  2.7198e-01,  7.7253e-03,  3.0353e-01, -4.7468e-01,
          1.9982e+00, -1.3468e+00, -1.0219e+00, -1.8636e-01,  3.5123e-01],
        [ 4.6872e-01,  2.5382e-01,  4.4331e-01, -2.4907e-01, -3.8665e-02,
          1.5295e+00, -3.6105e-01, -4.5400e-01, -1.4274e-01,  3.8915e-01],
        [ 2.1697e-01, -1.2694e-03,  2.4665e-01, -2.2239e-01,  1.7173e-01,
          9.5540e-01, -3.4975e-01, -4.2430e-01,  1.0870e-01,  1.7407e-01],
        [ 2.4858e-02,  1.8414e-01,  2.5163e-01,  1.0464e-02,  5.1822e-02,
          1.2895e+00, -4.7556e-01, -3.3364e-01,  1.4591e-02,  1.8996e-01],
        [ 2.6814e-01,  4.1138e-02,  5.0771e-01, -2.8956e-01, -1.0161e-01,
          1.3316e+00, -7.2738e-01, -2.5159e-01, -3.1944e-02,  2.9720e-01],
        [ 1.1660e-01,  2.7839e-01,  4.5933e-01, -9.6972e-02,  7.4485e-02,
          1.1719e+00, -4.9688e-01, -4.8010e-01,  7.7112e-02,  5.6647e-02],
        [ 1.5863e-01,  1.8806e-01,  5.2895e-01,  2.0540e-02,  7.4541e-02,
          1.2286e+00, -3.1822e-01, -4.4111e-01,  7.2348e-02,  3.0763e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3925, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:11:31,625 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :1060.20703125MB
2025-02-27 17:11:31,638 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1060.20703125MB2025-02-27 17:11:31,643 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:11:31,650 - DEBUG - [0][1] all operands ready: 1_stage_backward_1
2025-02-27 17:11:31,650 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))

All workitem count at loop begining: 2, current work item in ready runlist: 1, current work item in waiting runlist: 1
2025-02-27 17:11:31,654 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:31,655 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:11:31,655 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 1 :1060.20703125MB
2025-02-27 17:11:31,656 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:11:31,656 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:11:31,841 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward_1
after processing the work_item.microbatch_id 1 :836.1943359375MB
2025-02-27 17:11:31,849 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:11:31,971 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 02025-02-27 17:11:31,973 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0

Periodic memory cleanup :836.1943359375MBBefore WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:11:31,974 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:11:31,975 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))

All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:11:31,975 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:31,975 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:31,976 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :836.1943359375MB
2025-02-27 17:11:31,977 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 3.6219e-01, -1.2303e-01,  1.8263e-01,  6.3243e-03, -1.7006e-01,
          1.2232e+00, -2.8397e-01, -4.2571e-01, -5.5406e-02,  3.2517e-01],
        [ 6.8528e-02,  1.1566e-01,  2.3220e-01, -2.1034e-01, -2.3790e-02,
          1.3515e+00, -5.2473e-01, -1.5623e-01,  5.6867e-02,  1.6981e-01],
        [ 4.5437e-01,  1.7917e-01,  3.9944e-01, -1.2220e-01,  9.5542e-02,
          1.0931e+00, -3.1188e-01, -2.9437e-01, -1.8087e-01,  7.5794e-02],
        [ 7.4777e-02,  4.2974e-02,  3.5229e-01, -2.4270e-01, -6.8034e-03,
          1.0090e+00, -2.3274e-01, -3.8838e-01,  1.9777e-01,  2.3722e-01],
        [ 1.7383e-01,  2.3819e-01,  2.1158e-01,  6.2816e-02,  3.7540e-02,
          1.1938e+00, -2.0217e-01, -1.8557e-01,  9.5566e-02,  1.6488e-01],
        [ 2.0914e-01,  3.6343e-01,  3.6372e-01, -3.5058e-01,  2.1644e-01,
          1.2405e+00, -2.0865e-01, -4.8181e-01,  7.2138e-02,  6.7325e-02],
        [ 1.9495e-01,  3.1120e-01,  4.5044e-01, -9.4841e-02, -6.5636e-02,
          1.3170e+00, -7.0035e-01, -5.6002e-01,  1.9674e-01,  3.0167e-01],
        [ 3.3481e-01,  2.0536e-01,  2.8640e-01, -6.0174e-04, -2.2615e-01,
          1.2717e+00, -6.0409e-01, -6.7625e-01,  7.5348e-02,  4.1982e-01],
        [ 8.5563e-02,  2.3406e-01,  2.4220e-01, -1.7432e-01,  4.5502e-02,
          1.1846e+00, -6.9329e-01, -4.5913e-01,  8.8312e-02,  2.3841e-01],
        [-6.9913e-02,  3.6398e-01,  2.9674e-01, -3.2820e-01, -8.2569e-02,
          1.0478e+00, -1.2537e-01, -5.8316e-01,  1.9931e-02,  4.3013e-02],
        [ 1.7381e-01,  8.7301e-02,  2.9945e-01, -6.9645e-02,  2.3164e-01,
          1.1321e+00, -3.6460e-01, -4.9946e-01,  3.8450e-01,  1.4124e-01],
        [ 1.1267e-01,  2.0769e-01,  3.9989e-01, -7.4938e-02,  2.3915e-01,
          9.6826e-01, -2.5599e-01, -3.7507e-01,  8.0180e-02,  1.2451e-01],
        [ 1.1252e-01,  1.2559e-01,  9.5788e-02, -1.1834e-01,  1.6612e-01,
          1.1590e+00, -2.7236e-01, -2.6757e-01, -1.4914e-02,  4.1643e-02],
        [ 1.9721e-01,  1.0097e-01,  5.4656e-01, -2.3888e-01,  4.5379e-02,
          1.1488e+00, -3.1760e-01, -4.3210e-01, -1.3530e-02,  3.2801e-01],
        [ 3.9920e-01, -1.1251e-01,  1.7425e-01, -5.9228e-02, -2.7402e-02,
          1.2460e+00, -5.9448e-01, -3.3417e-01, -1.0208e-01,  1.7760e-01],
        [ 1.1725e-01,  1.9366e-01,  5.2879e-01, -3.0704e-01, -1.1206e-01,
          1.5348e+00, -7.4627e-01, -5.6302e-01, -1.9007e-01,  6.7939e-01],
        [ 3.3997e-01, -6.6014e-02,  9.7533e-02, -2.0241e-01,  2.1779e-01,
          1.2551e+00, -5.4671e-01, -3.8400e-01, -1.3132e-01,  9.1659e-02],
        [ 7.4183e-02,  6.7171e-02,  3.1570e-01, -2.4342e-01,  8.6496e-02,
          1.0838e+00, -3.7200e-01, -4.5899e-01,  1.5149e-01,  1.2112e-01],
        [ 8.0138e-02,  2.4531e-01,  2.1788e-01, -1.6282e-01, -3.6271e-02,
          1.3055e+00, -5.2531e-01, -2.4308e-01,  6.8177e-03,  2.0098e-01],
        [ 1.3519e-01,  3.1770e-01,  3.7730e-01, -3.0064e-01,  1.4950e-01,
          1.1619e+00, -2.3078e-01, -3.8353e-01, -1.4048e-01, -1.1931e-01],
        [ 1.5913e-01,  4.6778e-01,  3.0721e-01, -2.0725e-01,  1.4001e-01,
          1.5397e+00, -7.6635e-01, -3.8008e-01,  1.9451e-01,  1.5900e-01],
        [ 1.3969e-01,  4.0060e-01,  2.8795e-01, -1.5371e-01,  1.3881e-01,
          1.2020e+00, -4.3374e-01, -3.6614e-01,  5.2925e-02,  2.8524e-01],
        [ 1.7103e-02,  2.7652e-01,  2.2931e-01,  6.2361e-03,  1.5343e-01,
          1.1229e+00, -2.4519e-01, -6.6207e-01, -5.7926e-02,  1.8551e-02],
        [-1.2404e-02,  2.0076e-01,  4.2446e-01, -2.4655e-01, -6.9419e-03,
          8.4541e-01, -2.6948e-01, -5.0862e-01,  3.4167e-01,  2.5629e-01],
        [ 3.8693e-01,  2.7289e-01,  3.1017e-01,  1.3929e-02, -1.0866e-01,
          1.2575e+00, -4.1011e-01, -3.7196e-01,  1.3380e-01,  1.5564e-01],
        [ 1.9338e-01,  4.5288e-01,  4.1130e-01, -5.3061e-01, -4.3599e-01,
          1.5664e+00, -3.6110e-01, -7.3749e-01, -3.0428e-01,  2.6381e-01],
        [ 1.3905e-01,  1.7936e-01,  3.2872e-01, -8.2869e-02, -5.0752e-02,
          1.6390e+00, -5.7274e-01, -2.2104e-01, -3.4466e-03,  1.5851e-01],
        [ 1.1074e-01,  2.1275e-01,  2.2710e-01, -1.8448e-01, -2.0114e-01,
          1.3222e+00, -1.8807e-01, -3.8455e-01, -7.5949e-02,  1.7034e-01],
        [ 6.4543e-02,  7.1760e-02,  3.0860e-01, -2.3315e-01,  2.1992e-01,
          1.1945e+00, -2.7393e-01, -4.0365e-01, -2.7760e-02,  8.9077e-02],
        [ 2.5558e-01,  2.7533e-01,  4.1956e-01, -2.2539e-01, -2.2785e-01,
          1.1661e+00, -1.6887e-01, -4.5438e-01, -4.3945e-02,  1.5942e-02],
        [ 1.4929e-01,  2.3627e-01,  3.1895e-01, -4.1234e-02,  1.9418e-01,
          1.1241e+00, -3.0671e-01, -4.2274e-01,  7.7960e-02,  2.8433e-01],
        [ 2.0269e-01,  3.2494e-01,  3.6115e-01, -3.2876e-01, -6.6007e-02,
          1.7119e+00, -6.1824e-01, -5.3625e-01, -2.9468e-01,  3.9935e-01],
        [ 3.5508e-01,  6.9281e-02,  2.5533e-01, -1.7423e-01, -2.2201e-02,
          1.4980e+00, -5.5918e-01, -4.1613e-01,  2.3756e-02,  2.8657e-01],
        [ 2.9224e-02,  9.7819e-02,  5.3336e-01, -1.9123e-01,  5.2215e-02,
          1.1365e+00, -3.9559e-01, -4.4907e-01,  1.2350e-01,  3.2507e-01],
        [ 1.4674e-01,  5.8776e-01,  1.7066e-01, -1.3758e-01, -2.4522e-01,
          1.5734e+00, -9.3361e-01, -7.1387e-01, -6.5129e-02,  5.3741e-01],
        [ 2.9412e-01,  2.0310e-01,  1.5539e-01, -1.3405e-01, -6.2146e-02,
          9.6245e-01, -1.5528e-01, -4.0051e-01,  1.2401e-01, -6.3920e-02],
        [ 9.9721e-02,  2.9757e-01,  4.6859e-01, -4.3003e-01,  7.8271e-02,
          1.1641e+00, -4.2460e-01, -3.7616e-01,  2.3168e-01,  1.3510e-01],
        [ 7.8374e-02,  1.6538e-01,  3.8405e-01, -8.0450e-02, -1.0989e-01,
          1.1570e+00, -1.3708e-01, -1.9526e-01,  4.0826e-02,  1.5041e-01],
        [ 1.0715e-01,  2.4537e-01,  4.5207e-01, -2.1923e-02,  3.6149e-02,
          1.0913e+00,  3.3167e-04, -3.6084e-01,  2.9289e-02,  3.2306e-01],
        [-2.5103e-01,  1.9894e-01,  3.3600e-01, -2.3916e-01, -6.1517e-02,
          1.0973e+00, -4.7673e-01, -3.4566e-01,  2.1243e-01,  2.9243e-01],
        [ 2.3473e-01,  2.7246e-01,  2.8702e-01, -2.3438e-01,  1.2071e-01,
          1.1852e+00, -1.6616e-01, -4.6849e-01,  1.7513e-01, -1.4690e-02],
        [ 2.3087e-01,  4.9459e-02,  3.8862e-01, -9.8792e-02,  1.2066e-01,
          1.2387e+00, -4.8570e-01, -4.8135e-01, -2.0272e-02,  1.6479e-01],
        [-5.5967e-02,  2.0430e-01,  3.3734e-01, -2.0333e-01,  3.8713e-02,
          1.1246e+00, -4.2843e-01, -3.1298e-01,  1.7995e-01,  9.8171e-04],
        [ 9.8184e-02,  4.0319e-02,  3.0872e-01, -2.3545e-01, -8.6490e-02,
          1.2302e+00, -4.9331e-01, -4.7127e-01,  1.6533e-01,  2.8684e-01],
        [ 1.3349e-01,  3.0855e-01,  3.0094e-01, -1.9515e-02,  9.3198e-02,
          1.2754e+00, -3.8786e-01, -3.7491e-01, -2.6540e-02,  1.5364e-01],
        [-1.6215e-01,  1.6411e-01,  2.4190e-01, -1.9382e-01, -6.4817e-02,
          1.1658e+00, -4.6470e-01, -4.6930e-01, -1.0390e-02,  3.1038e-01],
        [ 1.7862e-01,  2.1044e-01,  5.1336e-01, -3.4760e-01, -6.1288e-02,
          1.5621e+00, -5.1922e-01, -5.3898e-01, -1.3279e-01,  5.4075e-01],
        [ 1.8814e-01,  2.5026e-01,  2.4266e-01, -1.9172e-01,  5.6007e-03,
          1.2806e+00, -5.3936e-01, -2.2975e-01,  2.3017e-01,  1.2392e-01],
        [ 1.9194e-01,  2.1724e-01,  4.4586e-01, -2.0518e-01,  1.5017e-01,
          1.3676e+00, -4.7596e-01, -3.2791e-01,  1.6256e-01,  7.4534e-02],
        [ 2.1887e-01,  2.1144e-02,  5.3009e-01, -1.8660e-01, -2.8334e-01,
          1.2451e+00, -6.7107e-01, -5.7450e-01,  1.7860e-01,  4.6864e-01],
        [ 1.8880e-01,  1.0975e-01,  4.8593e-01, -8.2610e-02,  6.7012e-02,
          9.5623e-01, -1.8137e-01, -3.6050e-01,  2.0572e-01,  3.9380e-02],
        [ 6.4204e-01,  3.9569e-01, -2.0752e-01, -1.8775e-01, -7.7614e-01,
          2.7540e+00, -1.5299e+00, -7.6518e-01, -4.3870e-01,  4.3812e-01],
        [ 1.5246e-01,  1.8313e-01,  3.8380e-01, -3.2658e-01,  1.4926e-01,
          1.1585e+00, -2.4971e-01, -7.1961e-01, -4.8426e-02,  1.4446e-01],
        [ 1.6302e-01,  1.5975e-01,  3.0456e-01, -1.6250e-02, -1.6300e-02,
          1.4443e+00, -1.7065e-01, -5.3652e-01,  2.5525e-01, -8.6313e-03],
        [ 5.9424e-03,  4.3933e-01,  6.1205e-02, -2.1714e-01, -7.4887e-02,
          1.6207e+00, -1.1291e+00, -5.6693e-01,  1.5739e-02,  2.5132e-02],
        [ 3.4121e-01,  2.5043e-01,  1.1162e-01, -1.0691e-01, -1.3610e-01,
          1.2175e+00, -5.5397e-01, -4.2187e-01, -4.1595e-02,  2.0515e-01],
        [ 1.1018e-01,  2.3611e-01,  4.2872e-01, -1.4132e-01,  2.6265e-01,
          1.1287e+00, -2.9071e-01, -3.5873e-01,  9.0864e-02, -4.3356e-03],
        [ 1.2666e-01,  7.6857e-02,  2.9702e-01, -1.9955e-01,  1.2823e-01,
          1.0628e+00, -4.5255e-01, -2.9062e-01, -1.8396e-01,  1.2054e-02],
        [ 6.5196e-01,  6.7547e-01,  9.4239e-02,  1.4696e-01, -2.8134e-01,
          2.1452e+00, -9.1083e-01, -6.7547e-01,  3.6705e-01,  2.2041e-01],
        [ 5.4186e-02,  1.4993e-01,  3.0610e-01, -2.2862e-01,  2.4778e-01,
          1.2509e+00, -3.8637e-01, -4.2283e-01,  4.4413e-02,  1.1485e-01],
        [-2.9543e-03,  2.3583e-01,  5.2899e-01, -2.8553e-01, -5.6360e-02,
          1.0377e+00, -2.2716e-01, -4.7123e-01,  2.2328e-01,  1.5557e-01],
        [ 1.5223e-01,  2.0624e-01,  5.0332e-01, -7.3735e-02, -1.1793e-02,
          1.0456e+00, -2.6035e-01, -3.1333e-01,  8.6684e-02,  1.5577e-01],
        [ 3.0067e-01,  2.8660e-01,  3.1355e-01, -3.9352e-01, -2.1720e-01,
          1.4145e+00, -5.0531e-01, -7.1080e-01,  5.6723e-02,  2.3744e-01],
        [ 2.5252e-01,  2.1824e-01,  2.2233e-01,  7.2405e-02,  2.4373e-01,
          1.1428e+00, -4.1653e-01, -3.1640e-01,  2.2812e-01,  1.5404e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.5172, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:11:32,147 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :827.447265625MB
2025-02-27 17:11:32,155 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :827.447265625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
2025-02-27 17:11:32,165 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
GPU After processing batch 23 in train loader:827.447265625
Loader: train. Accuracy: 0.0859375
2025-02-27 17:11:32,493 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:11:32,494 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:11:32,496 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:11:32,497 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:11:32,498 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:11:32,498 - DEBUG - [root] 2 instantiated
2025-02-27 17:11:32,499 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:11:32,499 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:11:32,500 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:11:32,500 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:11:32,501 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:11:32,501 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:11:32,506 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:11:32,507 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:11:32,507 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:11:32,508 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:11:32,508 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,510 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:11:32,510 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:11:32,510 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:11:32,510 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,511 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:32,511 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,511 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :828.697265625MB
2025-02-27 17:11:32,512 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:11:32,541 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:11:32,541 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:11:32,541 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:11:32,542 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:11:32,542 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:11:32,549 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:11:32,549 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:11:32,551 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:11:32,558 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:11:32,558 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:11:32,559 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,559 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:11:32,559 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:11:32,559 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:11:32,559 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,565 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:11:32,566 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:11:32,567 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:11:32,567 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:11:32,567 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:11:32,568 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:11:32,568 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:11:32,586 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:11:32,587 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:11:32,587 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:11:32,587 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:11:32,588 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:11:32,591 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:11:32,592 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:11:32,592 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:11:32,592 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:11:32,593 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:11:32,593 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:11:32,594 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:11:32,594 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:11:32,594 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:11:32,595 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:11:32,595 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:11:32,597 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:11:32,597 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:11:32,598 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:11:32,598 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:11:32,599 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:11:32,599 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:11:32,600 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:11:32,600 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:11:32,600 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:32,601 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:11:32,601 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:11:32,602 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:11:32,602 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:32,603 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:11:32,605 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:11:32,606 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:11:32,605 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:11:32,605 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:11:32,608 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:11:32,607 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:11:32,606 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:32,611 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:11:32,612 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:11:32,612 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_sync_barrier'])
2025-02-27 17:11:32,612 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:32,612 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:11:32,614 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:11:32,618 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:11:32,619 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:11:32,620 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:11:32,634 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :1060.6943359375MB
2025-02-27 17:11:32,641 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1060.6943359375MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:11:32,646 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:32,646 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:11:32,646 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :1060.6943359375MB
2025-02-27 17:11:32,648 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:11:32,791 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :1292.6943359375MB
2025-02-27 17:11:32,795 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1292.6943359375MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:11:51,283 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:11:51,296 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:11:51,297 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:11:51,297 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:51,297 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:11:51,298 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:11:51,298 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1292.697265625MB
2025-02-27 17:11:51,299 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 4.6287e-02,  1.7150e-02,  4.1630e-02, -4.0955e-02,  4.4393e-02,
          2.9035e-02, -1.2655e-02, -5.8688e-02, -2.6886e-02,  6.4295e-02],
        [ 4.0771e-02,  1.3691e-02,  5.2422e-02, -5.6348e-02,  5.1777e-02,
          1.7379e-02, -1.5036e-02, -6.0410e-02, -3.7579e-02,  5.7013e-02],
        [ 4.6963e-02,  9.7680e-03,  4.1033e-02, -3.8321e-02,  4.5564e-02,
          3.0144e-02, -1.1588e-02, -5.7201e-02, -2.5545e-02,  6.4756e-02],
        [ 2.7996e-02,  7.0903e-03,  4.3989e-02, -5.4733e-02,  3.2202e-02,
          2.0674e-02, -1.7408e-02, -5.5958e-02, -3.1476e-02,  5.5399e-02],
        [ 5.0307e-02,  1.2125e-02,  4.2683e-02, -5.4694e-02,  3.1908e-02,
          1.9616e-02, -1.2265e-02, -5.0801e-02, -3.8658e-02,  6.2187e-02],
        [ 3.9445e-02,  1.6825e-02,  4.8613e-02, -5.3958e-02,  3.5986e-02,
          2.5136e-02, -8.8856e-03, -5.9844e-02, -4.1697e-02,  6.7272e-02],
        [ 4.0133e-02,  1.9310e-02,  4.3032e-02, -4.1133e-02,  3.7243e-02,
          2.8564e-02, -8.2859e-03, -5.4071e-02, -3.0323e-02,  6.8916e-02],
        [ 2.8131e-02, -4.3191e-03,  5.8524e-02, -5.8194e-02,  4.5230e-02,
          2.0886e-02, -9.0051e-03, -6.5562e-02, -4.4541e-02,  5.4484e-02],
        [ 3.9790e-02,  9.7598e-04,  5.2365e-02, -5.8760e-02,  5.0238e-02,
          2.5351e-02, -8.5732e-03, -5.8358e-02, -4.3140e-02,  6.2383e-02],
        [ 3.5828e-02,  5.6175e-03,  5.0900e-02, -6.3244e-02,  3.4119e-02,
          2.0076e-02, -1.7961e-02, -6.0868e-02, -4.0835e-02,  5.7593e-02],
        [ 4.5099e-02,  6.2463e-03,  5.4722e-02, -4.8145e-02,  2.5227e-02,
          2.6138e-02, -8.0340e-03, -5.7802e-02, -3.2638e-02,  6.2659e-02],
        [ 4.4089e-02,  9.7802e-03,  4.8875e-02, -5.0010e-02,  3.1434e-02,
          3.1724e-02, -7.0568e-03, -5.8104e-02, -2.8343e-02,  6.0130e-02],
        [ 4.1526e-02, -9.4798e-03,  5.5391e-02, -5.7981e-02,  4.1708e-02,
          2.3058e-02, -8.8206e-03, -5.4501e-02, -3.9866e-02,  6.5044e-02],
        [ 4.0034e-02,  7.5093e-03,  4.6742e-02, -5.0734e-02,  4.0649e-02,
          2.8529e-02, -1.0056e-02, -6.1184e-02, -3.6187e-02,  6.6003e-02],
        [ 4.1997e-02,  1.5237e-02,  4.3835e-02, -4.3111e-02,  4.0064e-02,
          3.6776e-02, -1.3565e-02, -5.8426e-02, -2.6592e-02,  6.2319e-02],
        [ 3.9691e-02,  6.6486e-03,  4.7897e-02, -5.4325e-02,  3.3341e-02,
          3.0680e-02, -1.0896e-02, -5.5279e-02, -4.1976e-02,  6.4171e-02],
        [ 4.1181e-02,  1.0908e-02,  4.7227e-02, -4.3033e-02,  3.8345e-02,
          1.8617e-02, -1.0450e-02, -5.7185e-02, -3.0372e-02,  6.2155e-02],
        [ 3.6932e-02,  9.9284e-03,  4.7635e-02, -4.7041e-02,  3.8528e-02,
          2.0128e-02, -9.9305e-03, -6.2004e-02, -3.1952e-02,  5.8976e-02],
        [ 3.9023e-02,  1.0896e-02,  4.6577e-02, -4.9899e-02,  3.6810e-02,
          2.5382e-02, -9.7436e-03, -6.2923e-02, -3.1995e-02,  5.9948e-02],
        [ 3.1593e-02,  1.1836e-02,  4.2459e-02, -6.2809e-02,  3.3683e-02,
          3.4263e-02, -5.6808e-03, -7.0092e-02, -2.9763e-02,  5.3834e-02],
        [ 3.9189e-02,  9.3788e-03,  4.8434e-02, -5.5494e-02,  4.5538e-02,
          1.6999e-02, -1.3670e-02, -5.9016e-02, -3.8358e-02,  6.1599e-02],
        [ 3.2609e-02,  1.5891e-03,  4.4848e-02, -4.9908e-02,  3.5144e-02,
          1.1933e-02, -8.6963e-03, -5.5642e-02, -2.9644e-02,  5.7161e-02],
        [ 4.5513e-02,  1.4928e-02,  4.5099e-02, -4.1041e-02,  3.9909e-02,
          2.5448e-02, -8.4925e-03, -5.7249e-02, -2.8487e-02,  6.0857e-02],
        [ 3.7571e-02,  1.1224e-03,  5.1616e-02, -5.2606e-02,  4.2531e-02,
          2.7480e-02, -1.5263e-02, -6.2752e-02, -5.0716e-02,  6.0890e-02],
        [ 3.1395e-02, -7.3415e-03,  5.2316e-02, -6.5851e-02,  3.9780e-02,
          2.3573e-02, -1.0773e-02, -5.6327e-02, -4.4545e-02,  5.5144e-02],
        [ 4.5340e-02,  1.4796e-02,  3.9791e-02, -4.2550e-02,  4.4829e-02,
          2.5328e-02, -9.2491e-03, -5.3240e-02, -2.1989e-02,  6.1574e-02],
        [ 4.4520e-02,  1.5963e-02,  4.5738e-02, -4.2324e-02,  4.3822e-02,
          2.1666e-02, -6.9516e-03, -5.5026e-02, -2.8653e-02,  5.8995e-02],
        [ 4.5065e-02,  1.3534e-02,  4.6761e-02, -5.5058e-02,  3.3377e-02,
          2.3543e-02, -1.0103e-02, -5.3883e-02, -3.5904e-02,  6.7532e-02],
        [ 3.4719e-02,  6.8012e-03,  5.7406e-02, -5.7868e-02,  4.8349e-02,
          2.2328e-02, -1.2178e-02, -6.9730e-02, -5.0243e-02,  6.0759e-02],
        [ 3.3132e-02,  1.1774e-02,  5.0014e-02, -4.8891e-02,  2.7340e-02,
          1.8987e-02, -4.8066e-03, -5.2984e-02, -3.1280e-02,  6.4936e-02],
        [ 3.6010e-02,  9.1927e-03,  4.8438e-02, -4.6530e-02,  3.4907e-02,
          2.3751e-02, -8.6709e-03, -5.9634e-02, -3.1201e-02,  5.8995e-02],
        [ 3.5168e-02, -2.6441e-04,  5.5277e-02, -5.8014e-02,  4.6687e-02,
          2.3054e-02, -1.0143e-02, -6.0257e-02, -4.8825e-02,  5.6735e-02],
        [ 3.9369e-02,  1.3707e-02,  5.0285e-02, -4.6011e-02,  3.6586e-02,
          2.2699e-02, -5.6533e-03, -5.9151e-02, -3.0279e-02,  6.1022e-02],
        [ 4.0878e-02,  5.2959e-03,  5.4671e-02, -5.2272e-02,  3.9738e-02,
          2.4052e-02, -3.5111e-03, -5.8558e-02, -2.9732e-02,  5.4688e-02],
        [ 3.5044e-02, -1.0764e-02,  5.5065e-02, -5.3181e-02,  4.4339e-02,
          2.4817e-02, -9.0717e-03, -5.7293e-02, -4.6217e-02,  5.6928e-02],
        [ 3.4153e-02, -3.9306e-03,  5.0447e-02, -5.5635e-02,  4.1052e-02,
          2.3283e-02, -1.0128e-02, -5.8906e-02, -4.5567e-02,  6.8640e-02],
        [ 3.8193e-02,  9.5925e-03,  4.7296e-02, -5.5940e-02,  3.7451e-02,
          2.2528e-02, -1.0660e-02, -5.8157e-02, -3.1994e-02,  6.1496e-02],
        [ 3.8717e-02,  1.2431e-02,  3.5713e-02, -4.1437e-02,  3.6252e-02,
          2.9038e-02, -1.1550e-02, -5.2757e-02, -2.3156e-02,  6.4276e-02],
        [ 3.9134e-02,  1.5839e-03,  4.8974e-02, -4.5395e-02,  3.5709e-02,
          2.0019e-02, -8.0428e-03, -5.4011e-02, -2.6658e-02,  5.7617e-02],
        [ 3.8009e-02,  1.2781e-02,  4.9460e-02, -4.4376e-02,  3.9295e-02,
          2.3881e-02, -1.1285e-02, -6.1732e-02, -3.1886e-02,  6.5429e-02],
        [ 3.4048e-02,  6.4673e-03,  4.7576e-02, -5.3726e-02,  3.7193e-02,
          2.1829e-02, -1.2800e-02, -6.2059e-02, -3.5617e-02,  5.9517e-02],
        [ 4.4548e-02,  1.1139e-02,  4.3026e-02, -4.5068e-02,  4.1101e-02,
          2.9979e-02, -1.0069e-02, -5.6601e-02, -3.0058e-02,  6.3808e-02],
        [ 3.5750e-02,  8.4960e-03,  4.4403e-02, -4.8813e-02,  3.4887e-02,
          2.2126e-02, -1.0211e-02, -5.9838e-02, -3.0062e-02,  5.7050e-02],
        [ 4.1489e-02,  1.2158e-02,  4.6510e-02, -4.7925e-02,  3.1141e-02,
          2.4526e-02, -1.0169e-02, -5.3751e-02, -3.3227e-02,  6.6229e-02],
        [ 4.6296e-02,  1.5933e-02,  4.1569e-02, -4.2506e-02,  4.4144e-02,
          2.4650e-02, -9.9308e-03, -5.5309e-02, -2.6888e-02,  6.1615e-02],
        [ 3.5060e-02, -2.6542e-03,  5.4620e-02, -5.5698e-02,  4.8334e-02,
          2.0037e-02, -9.9244e-03, -5.4169e-02, -3.6404e-02,  5.2042e-02],
        [ 3.7980e-02,  7.3064e-03,  4.8187e-02, -4.9180e-02,  2.3078e-02,
          2.2811e-02, -1.1870e-02, -5.6741e-02, -3.2361e-02,  6.2329e-02],
        [ 3.7176e-02,  1.0832e-02,  4.4718e-02, -4.1636e-02,  3.1829e-02,
          2.5995e-02, -7.8488e-03, -5.6381e-02, -3.0165e-02,  6.6702e-02],
        [ 3.1351e-02, -9.5640e-03,  6.3222e-02, -6.3654e-02,  4.9159e-02,
          2.7976e-02, -6.4665e-03, -5.7241e-02, -5.1071e-02,  5.7077e-02],
        [ 3.8511e-02,  1.6412e-02,  4.4884e-02, -4.0917e-02,  4.0374e-02,
          3.3798e-02, -1.1507e-02, -5.7462e-02, -3.1318e-02,  7.0111e-02],
        [ 3.3666e-02,  7.4449e-03,  4.5230e-02, -5.2737e-02,  3.4065e-02,
          2.1724e-02, -1.3671e-02, -5.8488e-02, -3.2648e-02,  5.7266e-02],
        [ 3.8428e-02, -4.7382e-03,  5.5863e-02, -6.0418e-02,  5.3610e-02,
          2.4777e-02, -1.1337e-02, -6.2031e-02, -5.1857e-02,  5.9124e-02],
        [ 3.5992e-02,  6.6625e-03,  5.5662e-02, -5.2884e-02,  3.8255e-02,
          3.3508e-02, -5.2180e-03, -6.1190e-02, -3.6638e-02,  6.5615e-02],
        [ 4.0250e-02,  8.6985e-03,  4.5323e-02, -4.9121e-02,  4.2966e-02,
          1.6399e-02, -1.3487e-02, -5.6009e-02, -3.1758e-02,  5.6624e-02],
        [ 4.1302e-02, -1.0735e-03,  5.1572e-02, -4.8805e-02,  3.9505e-02,
          2.0832e-02, -5.7123e-03, -6.2767e-02, -3.5056e-02,  6.0062e-02],
        [ 3.0424e-02, -2.9754e-03,  4.5128e-02, -5.8782e-02,  4.5839e-02,
          2.3038e-02, -1.9064e-02, -6.1921e-02, -4.3861e-02,  5.7958e-02],
        [ 4.0872e-02,  1.2333e-02,  4.9153e-02, -4.7441e-02,  3.9807e-02,
          2.2925e-02, -4.9103e-03, -5.7670e-02, -3.3224e-02,  6.4254e-02],
        [ 3.7201e-02,  7.9218e-03,  5.4682e-02, -5.1961e-02,  3.3512e-02,
          2.9440e-02, -1.2657e-02, -6.1702e-02, -4.0606e-02,  6.0840e-02],
        [ 4.0712e-02,  1.5374e-02,  4.2850e-02, -4.4308e-02,  4.0870e-02,
          3.4185e-02, -6.7523e-03, -5.7020e-02, -3.0825e-02,  6.8589e-02],
        [ 3.3553e-02,  6.0261e-05,  5.5955e-02, -5.3376e-02,  4.2661e-02,
          2.8601e-02, -1.2002e-02, -6.4747e-02, -4.9126e-02,  6.5924e-02],
        [ 3.7367e-02,  1.1081e-02,  4.3950e-02, -4.0561e-02,  4.1402e-02,
          1.9757e-02, -1.1011e-02, -5.6400e-02, -2.7237e-02,  5.7994e-02],
        [ 3.6788e-02,  1.0048e-02,  4.7222e-02, -4.5599e-02,  4.0828e-02,
          2.2430e-02, -1.1159e-02, -6.0364e-02, -3.1598e-02,  6.0150e-02],
        [ 3.8625e-02,  1.7837e-02,  4.8847e-02, -4.7192e-02,  4.1162e-02,
          1.9603e-02, -1.1230e-02, -5.7226e-02, -3.4986e-02,  6.2016e-02],
        [ 3.7595e-02,  6.5262e-03,  5.2716e-02, -5.7984e-02,  4.3033e-02,
          2.3989e-02, -1.2530e-02, -6.4313e-02, -4.5156e-02,  5.9590e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3033, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:11:51,382 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :1276.697265625MB
2025-02-27 17:11:51,387 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1276.7001953125MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:12:05,678 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:12:05,680 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:05,680 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:12:05,680 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:05,681 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:05,681 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:05,681 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :1276.703125MB
2025-02-27 17:12:05,682 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0394, -0.0002,  0.0522, -0.0619,  0.0470,  0.0224, -0.0106, -0.0608,
         -0.0493,  0.0553],
        [ 0.0363,  0.0055,  0.0533, -0.0553,  0.0487,  0.0209, -0.0164, -0.0647,
         -0.0393,  0.0551],
        [ 0.0364,  0.0133,  0.0490, -0.0534,  0.0468,  0.0248, -0.0162, -0.0593,
         -0.0323,  0.0597],
        [ 0.0394,  0.0095,  0.0476, -0.0519,  0.0482,  0.0225, -0.0142, -0.0521,
         -0.0322,  0.0578],
        [ 0.0327,  0.0119,  0.0455, -0.0465,  0.0324,  0.0277, -0.0084, -0.0568,
         -0.0323,  0.0651],
        [ 0.0369,  0.0038,  0.0512, -0.0510,  0.0397,  0.0242, -0.0151, -0.0632,
         -0.0350,  0.0584],
        [ 0.0339, -0.0003,  0.0601, -0.0602,  0.0475,  0.0229, -0.0164, -0.0730,
         -0.0517,  0.0521],
        [ 0.0358,  0.0140,  0.0480, -0.0438,  0.0316,  0.0272, -0.0059, -0.0547,
         -0.0333,  0.0683],
        [ 0.0379, -0.0003,  0.0600, -0.0609,  0.0389,  0.0257, -0.0135, -0.0627,
         -0.0494,  0.0618],
        [ 0.0460,  0.0162,  0.0451, -0.0468,  0.0476,  0.0284, -0.0086, -0.0590,
         -0.0316,  0.0614],
        [ 0.0355,  0.0105,  0.0549, -0.0484,  0.0453,  0.0236, -0.0113, -0.0614,
         -0.0362,  0.0565],
        [ 0.0325,  0.0032,  0.0510, -0.0561,  0.0424,  0.0228, -0.0132, -0.0546,
         -0.0392,  0.0599],
        [ 0.0336,  0.0059,  0.0506, -0.0514,  0.0358,  0.0220, -0.0062, -0.0604,
         -0.0357,  0.0593],
        [ 0.0330,  0.0136,  0.0495, -0.0485,  0.0305,  0.0241, -0.0035, -0.0571,
         -0.0311,  0.0673],
        [ 0.0371,  0.0065,  0.0496, -0.0468,  0.0287,  0.0284, -0.0082, -0.0576,
         -0.0333,  0.0583],
        [ 0.0276,  0.0087,  0.0389, -0.0636,  0.0461,  0.0243, -0.0105, -0.0576,
         -0.0390,  0.0446],
        [ 0.0331, -0.0107,  0.0544, -0.0535,  0.0437,  0.0244, -0.0092, -0.0627,
         -0.0432,  0.0573],
        [ 0.0473,  0.0091,  0.0510, -0.0574,  0.0271,  0.0192, -0.0130, -0.0472,
         -0.0341,  0.0555],
        [ 0.0394,  0.0084,  0.0529, -0.0571,  0.0449,  0.0254, -0.0132, -0.0640,
         -0.0439,  0.0560],
        [ 0.0371,  0.0155,  0.0450, -0.0512,  0.0356,  0.0248, -0.0062, -0.0605,
         -0.0344,  0.0655],
        [ 0.0399,  0.0044,  0.0500, -0.0489,  0.0485,  0.0209, -0.0142, -0.0575,
         -0.0371,  0.0585],
        [ 0.0461,  0.0171,  0.0422, -0.0399,  0.0387,  0.0248, -0.0097, -0.0544,
         -0.0277,  0.0653],
        [ 0.0374,  0.0144,  0.0444, -0.0420,  0.0327,  0.0268, -0.0100, -0.0588,
         -0.0290,  0.0709],
        [ 0.0439,  0.0050,  0.0472, -0.0489,  0.0448,  0.0221, -0.0118, -0.0537,
         -0.0320,  0.0611],
        [ 0.0410,  0.0156,  0.0438, -0.0422,  0.0362,  0.0265, -0.0085, -0.0547,
         -0.0266,  0.0675],
        [ 0.0378,  0.0145,  0.0495, -0.0444,  0.0308,  0.0271, -0.0054, -0.0550,
         -0.0308,  0.0703],
        [ 0.0380,  0.0014,  0.0540, -0.0549,  0.0393,  0.0257, -0.0053, -0.0605,
         -0.0395,  0.0642],
        [ 0.0378,  0.0060,  0.0470, -0.0457,  0.0282,  0.0229, -0.0126, -0.0608,
         -0.0251,  0.0620],
        [ 0.0396,  0.0137,  0.0533, -0.0528,  0.0369,  0.0275, -0.0094, -0.0662,
         -0.0411,  0.0572],
        [ 0.0438,  0.0153,  0.0414, -0.0385,  0.0373,  0.0248, -0.0054, -0.0523,
         -0.0260,  0.0630],
        [ 0.0317,  0.0114,  0.0481, -0.0485,  0.0262,  0.0177, -0.0085, -0.0517,
         -0.0366,  0.0665],
        [ 0.0275, -0.0115,  0.0566, -0.0657,  0.0519,  0.0235, -0.0100, -0.0626,
         -0.0552,  0.0558],
        [ 0.0357,  0.0012,  0.0538, -0.0560,  0.0266,  0.0310, -0.0039, -0.0657,
         -0.0332,  0.0658],
        [ 0.0363,  0.0139,  0.0397, -0.0453,  0.0270,  0.0233, -0.0101, -0.0555,
         -0.0327,  0.0668],
        [ 0.0260, -0.0141,  0.0530, -0.0550,  0.0417,  0.0212, -0.0119, -0.0592,
         -0.0421,  0.0457],
        [ 0.0401,  0.0099,  0.0481, -0.0539,  0.0482,  0.0229, -0.0130, -0.0608,
         -0.0369,  0.0602],
        [ 0.0351,  0.0084,  0.0505, -0.0489,  0.0308,  0.0222, -0.0133, -0.0576,
         -0.0333,  0.0629],
        [ 0.0417,  0.0122,  0.0519, -0.0493,  0.0361,  0.0269, -0.0093, -0.0561,
         -0.0380,  0.0648],
        [ 0.0345,  0.0096,  0.0500, -0.0470,  0.0404,  0.0234, -0.0034, -0.0612,
         -0.0343,  0.0649],
        [ 0.0449,  0.0090,  0.0429, -0.0435,  0.0429,  0.0233, -0.0092, -0.0560,
         -0.0254,  0.0619],
        [ 0.0413,  0.0145,  0.0488, -0.0418,  0.0372,  0.0240, -0.0128, -0.0580,
         -0.0268,  0.0578],
        [ 0.0335,  0.0188,  0.0528, -0.0515,  0.0247,  0.0243, -0.0067, -0.0539,
         -0.0374,  0.0686],
        [ 0.0354, -0.0093,  0.0602, -0.0551,  0.0466,  0.0194, -0.0148, -0.0632,
         -0.0481,  0.0584],
        [ 0.0415,  0.0134,  0.0506, -0.0453,  0.0372,  0.0267, -0.0114, -0.0619,
         -0.0307,  0.0614],
        [ 0.0314,  0.0076,  0.0483, -0.0504,  0.0335,  0.0237, -0.0081, -0.0600,
         -0.0364,  0.0573],
        [ 0.0319,  0.0074,  0.0366, -0.0634,  0.0506,  0.0202, -0.0150, -0.0657,
         -0.0410,  0.0475],
        [ 0.0294,  0.0166,  0.0469, -0.0551,  0.0295,  0.0215, -0.0109, -0.0594,
         -0.0366,  0.0595],
        [ 0.0354, -0.0047,  0.0548, -0.0625,  0.0457,  0.0236, -0.0155, -0.0597,
         -0.0428,  0.0556],
        [ 0.0409,  0.0206,  0.0500, -0.0513,  0.0286,  0.0247, -0.0055, -0.0548,
         -0.0399,  0.0654],
        [ 0.0373,  0.0109,  0.0473, -0.0493,  0.0254,  0.0245, -0.0093, -0.0525,
         -0.0318,  0.0646],
        [ 0.0359, -0.0016,  0.0575, -0.0564,  0.0434,  0.0222, -0.0099, -0.0545,
         -0.0440,  0.0566],
        [ 0.0339,  0.0079,  0.0460, -0.0516,  0.0217,  0.0292, -0.0046, -0.0613,
         -0.0317,  0.0638],
        [ 0.0393,  0.0104,  0.0436, -0.0481,  0.0277,  0.0247, -0.0112, -0.0547,
         -0.0280,  0.0631],
        [ 0.0463,  0.0178,  0.0392, -0.0383,  0.0417,  0.0265, -0.0096, -0.0529,
         -0.0256,  0.0686],
        [ 0.0394,  0.0134,  0.0477, -0.0453,  0.0339,  0.0200, -0.0075, -0.0579,
         -0.0291,  0.0639],
        [ 0.0383,  0.0135,  0.0397, -0.0393,  0.0378,  0.0217, -0.0106, -0.0548,
         -0.0243,  0.0620],
        [ 0.0423, -0.0033,  0.0587, -0.0509,  0.0435,  0.0246, -0.0103, -0.0503,
         -0.0448,  0.0564],
        [ 0.0369,  0.0044,  0.0515, -0.0437,  0.0322,  0.0256, -0.0100, -0.0539,
         -0.0292,  0.0576],
        [ 0.0322,  0.0065,  0.0534, -0.0561,  0.0318,  0.0380, -0.0007, -0.0606,
         -0.0376,  0.0691],
        [ 0.0346,  0.0021,  0.0444, -0.0576,  0.0312,  0.0297, -0.0136, -0.0547,
         -0.0294,  0.0612],
        [ 0.0374,  0.0127,  0.0510, -0.0430,  0.0400,  0.0304, -0.0135, -0.0617,
         -0.0339,  0.0641],
        [ 0.0384,  0.0059,  0.0472, -0.0482,  0.0378,  0.0205, -0.0147, -0.0600,
         -0.0276,  0.0586],
        [ 0.0397,  0.0150,  0.0467, -0.0506,  0.0410,  0.0292, -0.0117, -0.0588,
         -0.0321,  0.0609],
        [ 0.0304,  0.0049,  0.0472, -0.0572,  0.0429,  0.0231, -0.0183, -0.0660,
         -0.0374,  0.0562]], device='cuda:0', requires_grad=True), 'loss': tensor(2.2995, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:12:05,756 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:12:05,761 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 1 :1276.708984375MB
2025-02-27 17:12:05,763 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1276.70263671875MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 1 in valid loader:1276.69140625
Loader: valid. Accuracy: 0.1328125
GPU End of epoch 3:1276.69140625
[31mSwitching template...[0m
2025-02-27 17:12:05,768 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:12:05,771 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:12:05,771 - INFO - [0] Instantiating RankWorker
Inital rank worker:1276.69140625MB
after initialization :1276.69140625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
[32mCurrent descr name: submod_1, stage_id: 1, rank: 0[0m
2025-02-27 17:12:05,824 - INFO - [root] Sending stage_id = 0 mod to worker
2025-02-27 17:12:05,878 - INFO - Instantiating PipeStageExecutor for stage 1
[32mCurrent descr name: submod_0, stage_id: 0, rank: 1[0m
[31mSwitch template complete![0m
[31mTime taken to switch template: 5.434096336364746 seconds[0m
Epoch: 4
GPU Start of epoch 4:1316.77490234375
2025-02-27 17:12:11,993 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:12:11,995 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:12:11,996 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:12:11,996 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:12:11,997 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:12:11,997 - DEBUG - [root] 2 instantiated
2025-02-27 17:12:11,998 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:12:11,998 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:12:11,998 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:12:11,998 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:12:11,999 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:12:11,999 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:12:12,005 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:12:12,006 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:12:12,010 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:12:12,010 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:12:12,011 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:12:12,011 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:12:12,011 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:12:12,012 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:12,012 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:12:12,013 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:12:12,013 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:12:12,013 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,017 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:12:12,017 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:12,017 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:12:12,019 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:12:12,019 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:12:12,021 - DEBUG - [1] Received getitem call: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:12:12,022 - DEBUG - [1] Received getitem call: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:12:12,027 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:12:12,028 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:12:12,035 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:12:12,036 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:12:12,036 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:12:12,036 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:12:12,036 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:12:12,037 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:12:12,037 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:12:12,037 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:12:12,038 - DEBUG - [1][0] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:12:12,042 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:12:12,042 - DEBUG - [1] Received getitem call: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:12:12,043 - DEBUG - [1][0] Invoke call found 3 ValueReference arguments
2025-02-27 17:12:12,043 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:12:12,044 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:12,045 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 0_stage_backward
2025-02-27 17:12:12,045 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,045 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:12:12,046 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:12,049 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:12:12,048 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:12:12,050 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:12:12,050 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:12:12,052 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:12,051 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:12:12,052 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:12:12,053 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:12:12,054 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,053 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:12:12,054 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward'])
2025-02-27 17:12:12,055 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:12,054 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:12:12,055 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:12:12,051 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:12:12,055 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:12:12,061 - DEBUG - [1] Received getitem call: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:12:12,061 - DEBUG - [1] Received getitem call: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:12:12,065 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:12:12,065 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:12:12,066 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:12:12,067 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:12:12,073 - DEBUG - [1] Received getitem call: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:12:12,073 - DEBUG - [1] Received getitem call: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:12:12,076 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:12:12,077 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:12:12,077 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:12:12,078 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:12:12,078 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:12:12,079 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:12:12,083 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:12:12,083 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:12:12,087 - DEBUG - [1][1] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:12:12,088 - DEBUG - [1][1] Invoke call found 3 ValueReference arguments
2025-02-27 17:12:12,088 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:12,088 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 1_stage_backward
2025-02-27 17:12:12,089 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,089 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1'])
2025-02-27 17:12:12,089 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:12,089 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:12:12,090 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:12:12,092 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:12:12,093 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:12:12,093 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:12:12,099 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:12:12,099 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:12:12,099 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:12:12,100 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:12:12,100 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:12:12,100 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:12:12,101 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:12:12,101 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:12:12,103 - DEBUG - [1] Received getitem call: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:12:12,103 - DEBUG - [1] Received getitem call: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:12:12,103 - DEBUG - [1] Received getitem call: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:12:12,107 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:12:12,107 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:12:12,108 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:12:12,109 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:12:12,110 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:12:12,111 - DEBUG - [1][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:12:12,112 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:12,112 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:12:12,112 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,114 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward'])
2025-02-27 17:12:12,114 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:12,115 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:12:12,116 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:12:12,117 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:12:12,118 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:12:12,118 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:12:12,119 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,118 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:12:12,119 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:12:12,120 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:12:12,122 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:12:12,123 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,126 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_3) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,127 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:12:12,127 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:12:12,127 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:12:12,128 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:12:12,130 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:12:12,130 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:12:12,130 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:12:12,132 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:12:12,135 - DEBUG - [1][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:12:12,136 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:12,136 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:12:12,136 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:12:12,136 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward', '0_sync_barrier'])
2025-02-27 17:12:12,136 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:12,136 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:12:12,135 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:12:12,134 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:12:12,138 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:12:12,139 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,140 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:12:12,141 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,142 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_3) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:12:12,143 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:12:12,143 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:12:18,270 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_4) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:12:18,273 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_4) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:12:23,372 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:23,373 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:12:23,374 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:23,374 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:23,375 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:23,375 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :1348.27880859375MB
2025-02-27 17:12:23,377 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:12:23,458 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
after processing the work_item.microbatch_id 0 :1411.06640625MB
2025-02-27 17:12:23,466 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :1411.06689453125MB
All workitem count at loop begining: 5, current work item in ready runlist: 0, current work item in waiting runlist: 5
2025-02-27 17:12:23,475 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:12:23,486 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:12:23,495 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:12:23,496 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:12:28,382 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:12:33,227 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:33,228 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:12:33,228 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:33,228 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:33,229 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:12:33,229 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :1411.06982421875MB
2025-02-27 17:12:33,231 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:12:33,309 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
after processing the work_item.microbatch_id 1 :1465.23486328125MB
2025-02-27 17:12:33,321 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :1465.23583984375MB2025-02-27 17:12:33,326 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:12:33,327 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0

2025-02-27 17:12:33,328 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:12:33,330 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1

Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:33,331 - DEBUG - [0][1] all operands ready: 1_stage_backward
2025-02-27 17:12:33,331 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:33,335 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:33,335 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 1 :1465.23583984375MB
2025-02-27 17:12:33,336 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:12:33,336 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:12:33,334 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:33,417 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward
2025-02-27 17:12:33,423 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
after processing the work_item.microbatch_id 1 :1459.2529296875MB
2025-02-27 17:12:33,428 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :1459.2529296875MB
All workitem count at loop begining: 3, current work item in ready runlist: 0, current work item in waiting runlist: 3
2025-02-27 17:12:36,170 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:36,171 - DEBUG - [0][0] all operands ready: 0_stage_backward
2025-02-27 17:12:36,171 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:36,172 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:36,172 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:12:36,172 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 0 :1459.2529296875MB
2025-02-27 17:12:36,174 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:12:36,174 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:12:36,211 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward
2025-02-27 17:12:36,217 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
after processing the work_item.microbatch_id 0 :1404.58935546875MB
2025-02-27 17:12:36,219 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :1404.58935546875MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:12:53,323 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:12:53,324 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:12:53,325 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:12:53,325 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:53,325 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:12:53,326 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:12:53,326 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :1404.58935546875MB
2025-02-27 17:12:53,327 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[-9.9151e-03,  5.7298e-01,  9.6425e-02,  4.2478e-02, -3.2290e-01,
          2.0182e+00, -1.2751e+00, -6.0562e-01, -1.0165e-01,  2.7358e-01],
        [ 3.2705e-01,  1.9288e-01,  3.9304e-01, -2.8309e-01,  4.0235e-01,
          1.0969e+00, -1.8512e-01, -4.9266e-01, -5.9861e-02,  1.8575e-01],
        [ 2.8566e-01,  3.9590e-01,  3.1360e-02, -1.7586e-01,  4.0899e-02,
          1.3550e+00, -4.9945e-01, -3.9676e-01,  6.1076e-02,  1.7876e-01],
        [ 2.4144e-02,  1.4045e-01,  2.8615e-01, -1.5400e-01,  1.8266e-01,
          1.0374e+00, -1.4629e-01, -3.0876e-01,  3.1490e-01,  2.0628e-01],
        [ 2.2135e-01,  1.7677e-01,  5.2978e-01, -2.0036e-01,  6.9891e-02,
          1.0487e+00, -2.1631e-01, -3.1946e-01, -1.6145e-01,  2.3601e-01],
        [ 4.6686e-01,  4.0260e-01,  4.1628e-01, -2.3468e-01,  1.6890e-01,
          1.3910e+00, -5.7331e-01, -3.8547e-01, -7.5305e-02,  6.6732e-01],
        [ 3.0097e-01,  4.3814e-02,  2.0422e-01, -1.0603e-01, -1.5231e-01,
          1.2016e+00, -3.6164e-01, -3.9970e-01,  1.6640e-01,  3.1954e-01],
        [ 3.8625e-01,  1.7252e-01,  5.4655e-01, -3.3525e-01, -9.9082e-02,
          1.4316e+00, -5.2548e-01, -6.8168e-01, -3.4742e-02,  7.3227e-02],
        [ 1.2635e-01,  3.5189e-01,  3.2447e-01,  1.8120e-02,  3.8645e-02,
          1.0174e+00, -4.4805e-01, -2.7169e-01,  1.3323e-01,  1.6314e-01],
        [-2.5400e-02,  1.5374e-01,  3.2849e-01, -4.0885e-01, -2.2890e-01,
          1.5097e+00, -4.8380e-01, -4.2779e-01, -8.1583e-02,  4.8890e-02],
        [ 4.3631e-01,  2.4523e-01,  8.6515e-02, -2.4115e-01,  1.5360e-03,
          1.0897e+00, -2.7036e-01, -5.8614e-01, -5.3813e-02,  4.7076e-01],
        [ 7.2082e-02,  6.8057e-02,  2.5141e-01, -4.5985e-01, -3.2696e-02,
          1.3533e+00, -1.2513e-01, -5.5414e-01,  1.9211e-01,  2.7861e-01],
        [ 8.1188e-02,  2.0587e-01,  3.4152e-01, -2.3357e-01,  2.2001e-01,
          1.0635e+00, -2.7572e-01, -3.9305e-01,  2.1298e-01,  8.3094e-02],
        [ 1.3445e-01,  1.1674e-01,  4.4578e-01, -2.7011e-01,  1.3250e-01,
          1.4401e+00, -6.5159e-01, -1.1940e-01, -1.2505e-01,  1.0832e-01],
        [ 3.2126e-01,  2.4866e-01,  3.8407e-01, -2.2419e-01,  1.6576e-02,
          1.3934e+00, -1.7032e-01, -4.6834e-01,  6.1409e-02,  5.8690e-02],
        [ 1.0736e-01,  1.3350e-02,  2.9750e-01, -1.7288e-01, -1.4393e-01,
          1.5233e+00, -3.7708e-01, -6.5699e-01,  5.4259e-02,  1.9245e-01],
        [ 2.0427e-01,  2.0620e-01,  3.7491e-01, -4.2074e-02,  5.7199e-02,
          1.2632e+00, -3.5671e-01, -3.4087e-01, -5.9022e-02,  4.0617e-02],
        [ 2.5163e-01,  2.3299e-01,  2.5117e-01, -4.6228e-02, -4.8706e-02,
          1.0947e+00, -3.8307e-01, -5.2301e-01,  1.7356e-01,  1.9952e-01],
        [ 2.3922e-01,  2.0572e-01,  1.5203e-01,  4.8851e-02,  6.3966e-02,
          1.1712e+00, -4.1857e-01, -4.4688e-01, -2.3375e-01,  3.9708e-02],
        [ 1.0543e-01,  1.1266e-01,  8.6586e-02, -1.6685e-01,  1.4028e-01,
          1.2316e+00, -5.1474e-01, -5.4558e-01,  2.3123e-01,  1.0648e-01],
        [ 1.3030e-01,  2.1756e-01,  5.2528e-01,  5.4409e-02,  2.8543e-01,
          1.3200e+00, -4.7423e-01, -4.8590e-01,  1.4376e-01,  1.7044e-01],
        [ 1.4289e-01,  2.0236e-01,  3.9129e-01,  5.9243e-03, -2.2022e-01,
          9.9274e-01, -2.6644e-01, -3.7809e-01,  1.1240e-01, -2.2602e-02],
        [ 9.3206e-02,  2.7053e-01,  2.3507e-01,  1.1033e-01,  4.6003e-02,
          1.6653e+00, -8.5316e-01, -4.1848e-01, -2.4087e-02,  1.1685e-01],
        [ 5.0139e-02,  2.3151e-01,  4.5400e-01, -1.0275e-01,  2.8725e-02,
          9.5237e-01, -4.0417e-01, -2.4027e-01,  5.6845e-02,  1.9533e-01],
        [ 5.1685e-01,  4.0172e-01,  5.1327e-01, -3.8556e-01,  2.0378e-01,
          1.7077e+00, -5.2194e-01, -5.6686e-01, -3.0665e-01,  3.7147e-01],
        [ 2.9740e-01,  1.5309e-01,  4.4116e-01, -6.3468e-02,  4.3090e-02,
          1.2743e+00, -6.3062e-01, -4.1807e-01, -2.4941e-02,  1.6898e-01],
        [ 1.2039e-01,  3.2067e-01,  3.0754e-01, -1.7525e-01, -1.1112e-01,
          1.2680e+00, -5.0413e-01, -4.5421e-01, -6.7886e-02, -2.2959e-02],
        [ 6.1661e-01,  3.5367e-01,  2.7951e-01, -8.0326e-02, -2.5673e-02,
          1.3231e+00, -6.9656e-01, -4.5256e-01, -1.1017e-01,  5.1423e-02],
        [ 1.7580e-01,  1.6642e-01,  2.1523e-01, -9.8606e-02, -1.4842e-01,
          1.4054e+00, -1.4932e-01, -5.5725e-01,  3.3871e-01,  3.9080e-01],
        [ 1.1754e-02,  2.1088e-01,  2.0784e-01, -2.8445e-01, -3.6539e-01,
          1.4594e+00, -6.3268e-01, -4.9321e-01,  1.3769e-01,  2.3679e-01],
        [ 7.6404e-01,  3.5347e-01,  3.0021e-01, -4.1261e-01, -1.7082e-01,
          1.7042e+00, -8.3864e-01, -6.1731e-01,  1.5815e-01,  4.1132e-01],
        [ 1.5087e-01,  3.2267e-01,  1.9495e-01, -3.7781e-01, -3.4012e-01,
          1.8353e+00, -7.2266e-01, -5.5898e-01, -1.0065e-01,  3.0201e-01],
        [ 1.1001e-01,  3.1515e-01,  3.8429e-01, -2.6920e-01, -2.6850e-02,
          1.0299e+00, -3.0939e-01, -3.6722e-01,  3.3376e-01,  2.4581e-02],
        [ 8.8618e-02,  2.1861e-01,  4.7443e-01, -1.6231e-01, -6.3671e-02,
          1.3850e+00, -5.3722e-01, -3.7353e-01,  4.9685e-02,  5.6248e-02],
        [ 6.5148e-02,  1.4232e-01,  4.2443e-01,  7.5663e-02, -7.9574e-02,
          1.1394e+00, -2.8665e-01, -5.7165e-01,  1.2158e-03,  2.6509e-01],
        [ 3.1630e-01,  2.7210e-02,  3.0247e-01, -9.4440e-02, -3.2916e-02,
          1.2540e+00, -4.2706e-01, -4.3406e-01,  2.7464e-02,  2.6699e-01],
        [ 2.4419e-01,  1.5963e-01,  4.2619e-01, -5.4682e-02,  1.4190e-01,
          1.0617e+00, -2.9906e-01, -4.9345e-01, -5.6325e-02,  2.8139e-01],
        [-1.2151e-01,  9.1131e-02,  5.1431e-01, -1.1218e-01,  7.2894e-02,
          1.0657e+00, -4.6898e-01, -4.0688e-01,  2.3551e-01,  3.8237e-01],
        [ 2.1624e-01,  3.0395e-01,  2.0419e-01,  1.0002e-01,  3.7821e-02,
          1.0309e+00, -1.6054e-01, -4.1834e-01,  1.9545e-01,  1.5097e-01],
        [ 2.1306e-01,  2.1934e-02,  3.5760e-01, -2.5950e-01, -1.1315e-01,
          1.1878e+00, -7.0383e-01, -4.2140e-01, -1.3652e-02,  1.0144e-02],
        [ 8.8748e-02,  2.2278e-01,  3.1150e-01, -8.0191e-02, -2.5290e-02,
          1.1336e+00, -3.8978e-01, -4.6802e-01, -4.3185e-02,  3.8919e-01],
        [ 3.0582e-02,  3.6116e-01,  2.7353e-01, -1.2759e-01, -9.1386e-02,
          1.1649e+00, -3.0827e-01, -3.5630e-01,  9.6101e-02,  3.6837e-01],
        [ 2.2249e-01,  1.3666e-01,  3.1367e-01, -2.0371e-01, -1.9699e-01,
          1.2149e+00, -3.4620e-01, -4.5596e-01,  2.4874e-01,  1.8209e-01],
        [ 2.4334e-01,  4.5502e-02,  2.9961e-01, -1.3675e-01, -2.8235e-02,
          1.3477e+00, -6.4336e-01, -6.7667e-01, -1.7409e-01,  3.5977e-01],
        [ 1.9093e-01,  8.5559e-02,  3.6910e-01, -1.8284e-01,  2.8998e-02,
          8.6184e-01, -4.3171e-01, -2.7253e-01,  1.5589e-01,  7.1298e-02],
        [ 1.0854e-01, -7.9809e-02,  2.9079e-01, -2.5484e-01,  7.1818e-02,
          1.0140e+00, -1.8934e-01, -4.7163e-01,  3.9392e-02,  5.4564e-02],
        [ 1.9506e-01,  8.4186e-02,  3.3406e-01, -1.9156e-01,  1.1309e-01,
          1.1534e+00, -3.6442e-01, -3.8340e-01,  1.7222e-01,  1.4892e-01],
        [ 3.8036e-02,  1.5394e-01,  5.0098e-01, -3.0248e-01,  2.2471e-01,
          1.1286e+00, -5.6682e-01, -3.9154e-01,  7.9112e-02,  1.6059e-01],
        [ 2.5811e-01,  2.6003e-01,  4.0444e-01, -2.8616e-01, -2.6487e-02,
          8.9783e-01, -1.5892e-01, -4.5938e-01,  1.9079e-01,  1.1088e-01],
        [-7.2505e-02,  1.4044e-01,  4.7609e-01, -2.0614e-01,  9.6084e-02,
          1.0883e+00, -5.8572e-01, -4.0870e-01, -4.2801e-02,  3.8473e-01],
        [ 3.9650e-01,  4.8250e-01,  3.4703e-01, -3.4495e-01, -2.4460e-01,
          1.9023e+00, -7.1334e-01, -9.1497e-01,  2.9592e-01,  2.4375e-01],
        [ 9.5286e-02,  3.6166e-01,  3.2211e-01, -1.3975e-01,  9.2447e-02,
          1.2577e+00, -3.5338e-01, -3.8924e-01,  1.0957e-03,  1.9077e-01],
        [ 1.5354e-01,  3.6088e-01,  2.3265e-01, -2.7932e-01,  9.7650e-02,
          1.2036e+00, -3.5614e-01, -3.7615e-01,  1.3300e-01,  5.4376e-02],
        [-1.2362e-01,  3.6084e-01,  3.7244e-01, -3.4935e-01, -3.2451e-01,
          1.5695e+00, -6.0214e-01, -6.3424e-01, -1.8172e-01,  3.1147e-01],
        [ 1.5269e-01,  2.8271e-01,  3.2644e-01, -3.3909e-01,  3.0751e-01,
          1.4500e+00, -4.8800e-01, -4.9401e-01, -9.1745e-02,  1.6173e-01],
        [ 2.1223e-01,  2.7520e-01,  3.9526e-01, -2.4919e-01,  1.6556e-01,
          9.7962e-01, -3.9362e-01, -3.2943e-01,  2.4924e-02,  1.9234e-01],
        [ 9.5593e-03,  3.0825e-01,  2.3946e-01, -1.6208e-01,  1.0272e-01,
          1.3162e+00, -4.8012e-01, -2.0155e-01,  1.5015e-01,  3.8726e-02],
        [ 1.8602e-01,  2.5613e-01,  1.4775e-01,  2.7631e-04,  2.2865e-01,
          1.0650e+00, -1.6019e-01, -3.3155e-01,  3.0574e-01,  3.3415e-02],
        [ 1.2073e-01,  2.0104e-01,  2.2697e-01,  3.4295e-02, -9.4618e-02,
          1.3533e+00, -7.7905e-01, -5.5535e-01,  1.2687e-01,  1.8777e-01],
        [ 3.0190e-01,  2.7808e-01,  3.0289e-01,  1.2644e-02, -1.9923e-01,
          1.4217e+00, -3.6601e-01, -6.8461e-01, -1.0212e-01,  2.3234e-01],
        [ 3.9774e-02,  1.3517e-01,  4.1457e-01, -9.2088e-02, -1.2170e-01,
          1.4912e+00, -5.2647e-01, -4.5447e-01,  1.8273e-01,  2.8051e-01],
        [ 2.9687e-01,  5.2003e-02,  2.3344e-01, -1.4695e-01, -1.5314e-02,
          9.7811e-01, -2.6176e-01, -3.3724e-01, -1.1097e-01,  2.6165e-01],
        [ 1.7274e-01,  2.2395e-01,  2.5875e-01, -3.8773e-01, -2.0623e-01,
          1.5843e+00, -7.7716e-01, -4.4949e-01, -5.2892e-02,  1.4890e-01],
        [ 2.5647e-01,  2.6074e-01,  2.2973e-01, -1.2180e-01, -2.4174e-01,
          1.4299e+00, -5.2125e-01, -3.8144e-01, -2.0590e-01,  1.0222e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4692, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:12:53,410 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :1388.583984375MB
2025-02-27 17:12:53,417 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1388.583984375MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:13:08,929 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:13:08,931 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:13:08,931 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:13:08,932 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:08,932 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:13:08,932 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:08,932 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1388.583984375MB
2025-02-27 17:13:08,933 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 1.1789e-01,  2.9532e-02,  4.4193e-01, -4.3214e-02,  5.1914e-02,
          1.0369e+00, -4.4694e-01, -4.5079e-01,  2.4230e-01,  8.3442e-02],
        [-9.9693e-02,  2.1613e-01,  2.9205e-01, -2.3850e-01,  4.8911e-02,
          1.3736e+00, -4.9714e-01, -5.2306e-01,  1.2664e-01,  1.4731e-01],
        [ 1.8374e-02,  2.9515e-01,  4.0129e-01, -2.1306e-01, -1.4654e-01,
          1.3164e+00, -6.2280e-01, -3.5743e-01, -2.8969e-01,  3.6378e-01],
        [ 2.3288e-01,  1.0707e-01,  4.8611e-01, -2.3766e-01, -2.2377e-01,
          1.2602e+00, -3.5308e-01, -5.7191e-01, -2.0051e-01,  8.2994e-02],
        [ 1.7900e-03,  3.8550e-01,  2.3944e-01, -1.7397e-01, -1.1480e-01,
          1.3400e+00, -6.4677e-01, -3.5902e-01,  6.1087e-02, -8.4686e-02],
        [ 5.7506e-03,  3.4702e-01,  2.5894e-01, -3.8262e-01, -1.6323e-01,
          1.1231e+00, -5.6050e-01, -3.9755e-01,  1.0008e-01,  6.2551e-02],
        [ 3.6574e-01,  1.9138e-01,  2.3817e-01,  2.6191e-02,  1.5616e-01,
          1.0946e+00, -2.8922e-01, -3.5665e-01,  2.6086e-01, -1.9277e-03],
        [ 1.9331e-01,  3.1548e-01, -2.4450e-01, -1.6791e-01,  9.6300e-02,
          1.8105e+00, -6.7625e-01, -8.1273e-01, -1.0300e-01,  1.8367e-01],
        [ 5.3639e-01,  4.3059e-01,  8.9098e-02, -2.9925e-01, -3.1579e-02,
          1.6955e+00, -5.6438e-01, -7.6087e-01,  4.0740e-02,  1.8068e-01],
        [-7.5900e-02,  2.7997e-01,  3.3960e-01, -1.9927e-01,  6.0107e-02,
          1.4052e+00, -6.5601e-01, -4.4192e-01, -2.9969e-01,  3.5370e-02],
        [ 2.5164e-01,  1.5511e-01,  4.5305e-01, -8.5763e-02, -2.3346e-02,
          9.2267e-01, -2.7053e-01, -2.2722e-01, -1.5672e-01,  2.2801e-01],
        [ 1.8520e-01,  1.0197e-01,  4.2160e-01, -3.0673e-01, -1.9568e-01,
          1.4740e+00, -6.0876e-01, -5.5826e-01,  9.4889e-02,  2.6419e-01],
        [ 2.0180e-01,  2.0606e-01,  3.6430e-01, -6.7052e-02,  2.6480e-01,
          1.3656e+00, -5.5162e-01, -4.6165e-01, -3.1205e-02,  4.1111e-01],
        [ 2.4899e-01,  6.8614e-02,  4.1267e-01, -3.0752e-01, -7.1833e-02,
          1.4812e+00, -6.6432e-01, -6.3514e-01,  2.5401e-01,  4.6362e-01],
        [ 5.1995e-01,  3.9710e-01,  1.4756e-01, -3.7436e-01, -9.2850e-02,
          1.5720e+00, -3.5632e-01, -4.4783e-01, -6.2815e-02,  1.1715e-01],
        [-9.4731e-02,  1.5380e-01,  2.9083e-01, -1.1750e-01, -2.3115e-01,
          1.5084e+00, -9.1407e-01, -6.2589e-01, -2.0116e-03,  3.6338e-01],
        [ 2.1244e-01,  3.3315e-01, -3.7533e-02, -2.6801e-01, -3.7531e-03,
          1.4216e+00, -4.0501e-01, -5.4551e-01,  7.4609e-02,  1.2353e-01],
        [ 1.1786e-01,  1.3183e-01,  4.4735e-01, -1.0035e-01,  2.5014e-01,
          1.0433e+00, -7.6816e-02, -3.0839e-01,  2.4500e-01,  2.4242e-01],
        [ 1.4684e-01,  2.0763e-01,  5.2892e-01, -2.8063e-01,  1.9803e-01,
          1.0628e+00, -3.5166e-01, -3.8146e-01,  1.6367e-01, -4.8003e-02],
        [ 5.4152e-02,  3.2424e-01,  1.7606e-01, -1.3160e-01,  1.7979e-02,
          1.2899e+00, -5.5393e-01, -4.4801e-01, -9.6419e-02,  2.2757e-01],
        [ 4.6406e-02,  3.9480e-01,  2.3252e-01, -2.1429e-01, -5.7555e-01,
          1.4752e+00, -9.5502e-01, -6.2194e-01,  2.4074e-02,  1.9675e-01],
        [ 2.2409e-01, -1.1278e-02,  3.4738e-01, -5.8954e-02,  6.5464e-02,
          1.1519e+00, -2.4044e-01, -3.0873e-01, -2.1654e-01,  1.3822e-01],
        [ 3.6507e-01,  3.7589e-01,  5.8051e-01, -2.3878e-01,  1.1044e-01,
          1.1239e+00, -6.0349e-01, -7.3502e-01,  6.0253e-02,  5.2535e-01],
        [ 2.4698e-02,  1.9545e-01,  3.2111e-01,  3.7579e-02,  2.0976e-01,
          1.0064e+00, -1.4972e-01, -3.0644e-01,  1.6334e-01,  3.1563e-01],
        [ 1.5121e-01,  3.3606e-01,  2.9471e-01, -1.3718e-01,  1.3278e-01,
          1.0037e+00, -1.7511e-01, -2.9075e-01, -4.5209e-02,  2.9100e-01],
        [ 8.3257e-02,  1.2663e-01,  5.3831e-01, -1.7731e-01,  9.1846e-03,
          1.4110e+00, -6.9017e-01, -5.2969e-01,  1.3296e-01,  4.1077e-01],
        [ 5.1483e-01,  3.0602e-02,  2.6260e-01, -1.8698e-01, -9.4433e-02,
          1.3643e+00, -6.3843e-01, -2.6687e-01,  1.0682e-01,  1.0561e-01],
        [ 3.4713e-01,  1.1440e-01,  3.1340e-01, -3.0120e-01, -1.5022e-02,
          1.4260e+00, -4.6137e-01, -2.8036e-01, -5.5554e-02,  2.9145e-01],
        [ 7.9865e-02,  7.9902e-02,  3.8123e-01, -3.9174e-01,  6.8184e-02,
          1.3498e+00, -4.9324e-01, -2.9573e-01, -1.1970e-01,  2.0769e-01],
        [-5.9382e-02,  2.7675e-01,  4.8761e-01, -6.5515e-02,  1.3979e-01,
          1.0960e+00, -1.8611e-01, -4.5288e-01,  8.3114e-02,  8.8727e-02],
        [ 1.3997e-01,  1.1299e-01,  4.4447e-01,  6.2943e-03, -1.1101e-01,
          1.2252e+00, -3.6582e-01, -3.4619e-01,  2.8403e-02,  2.4238e-01],
        [ 6.7619e-02,  6.2682e-01,  3.5419e-01, -1.1954e-04, -1.8516e-01,
          1.4786e+00, -7.5651e-01, -8.1134e-01, -2.2397e-01,  2.8634e-01],
        [ 1.5688e-01,  3.6850e-01,  4.2568e-01, -4.1963e-02, -1.1663e-01,
          1.1611e+00, -2.2030e-01, -2.0459e-01,  8.9106e-02, -1.3262e-02],
        [ 9.8617e-02,  1.5861e-01,  2.4996e-01, -2.7291e-01,  1.0988e-01,
          1.1413e+00, -3.6486e-01, -3.0424e-01,  3.4226e-01,  2.8647e-01],
        [ 8.1318e-02,  3.4846e-01,  4.5161e-01, -2.2017e-01, -2.1348e-02,
          1.1085e+00, -2.9071e-01, -3.5614e-01,  2.3893e-01,  2.9262e-01],
        [ 1.5413e-01,  3.5695e-01,  3.8625e-01,  3.4465e-02,  1.4465e-02,
          1.1530e+00, -3.1203e-01, -2.9446e-01,  1.6190e-01,  3.4765e-01],
        [ 3.0333e-01,  1.9686e-01,  3.4631e-01, -2.1095e-01,  1.2160e-01,
          1.1069e+00, -3.1117e-01, -2.4096e-01, -1.1734e-02,  6.6513e-02],
        [ 1.9727e-01,  8.9972e-02,  2.1625e-01, -2.5695e-01, -3.7187e-01,
          1.6042e+00, -8.1351e-01, -2.0028e-01,  2.2595e-01,  1.6774e-02],
        [ 6.1833e-02,  3.0226e-01,  3.6098e-01, -3.3455e-01,  2.5277e-01,
          1.2879e+00, -2.1756e-01, -4.9161e-01, -4.1740e-03,  2.7312e-01],
        [-3.4651e-02,  8.3086e-04,  4.4414e-01, -2.1818e-01, -5.2809e-03,
          1.0543e+00, -1.7096e-01, -5.1507e-01,  2.4464e-01,  3.0869e-01],
        [-8.8769e-02,  1.2072e-01,  2.5441e-01, -4.3389e-01, -6.9148e-02,
          1.4109e+00, -4.6818e-01, -6.1997e-01,  3.8666e-02,  2.9163e-01],
        [ 1.3375e-01,  2.3385e-01,  4.0373e-01, -1.7280e-01,  1.5699e-01,
          1.2390e+00, -2.6658e-01, -5.0248e-01,  1.9771e-01,  1.5707e-01],
        [ 3.0097e-01,  4.6055e-01,  3.9765e-01, -1.3829e-01,  2.5999e-01,
          9.9853e-01, -1.7603e-01, -2.6376e-01, -6.4910e-02,  1.4940e-01],
        [ 3.4801e-01,  4.1668e-01,  2.0165e-01, -1.0371e-01, -1.6013e-01,
          1.1583e+00, -5.9179e-01, -6.3828e-01,  3.3993e-01,  3.1801e-01],
        [ 1.8741e-01,  1.5979e-01,  1.9057e-01, -3.5090e-01, -6.3254e-02,
          1.2415e+00, -2.8582e-01, -2.9655e-01,  1.0663e-01,  3.2316e-01],
        [ 1.5595e-01,  2.6317e-01,  5.1676e-01, -2.6522e-01,  1.0794e-01,
          1.4060e+00, -5.4528e-01, -7.0097e-01, -2.1428e-01,  3.4562e-01],
        [ 5.5713e-02,  1.4215e-01,  4.5249e-01, -4.4601e-01,  2.1554e-01,
          1.1684e+00, -4.4231e-01, -3.2785e-01, -1.4706e-01, -2.1592e-01],
        [ 1.6575e-01,  2.0051e-01,  2.4136e-01, -7.6335e-02, -1.5401e-02,
          1.1447e+00, -2.5282e-01, -3.1916e-01, -1.7014e-01,  2.9338e-02],
        [ 3.4117e-01, -9.6980e-03,  5.0319e-01, -2.4902e-01,  5.9777e-02,
          1.6511e+00, -8.8695e-01, -4.9485e-01, -1.0283e-01,  8.7284e-02],
        [ 3.3569e-01, -8.1909e-03,  1.3776e-01, -1.5613e-01, -4.6893e-01,
          1.8553e+00, -6.1757e-01, -5.8630e-01, -1.4411e-01,  3.1211e-01],
        [ 5.1980e-01, -1.4724e-01,  1.6392e-01, -1.6994e-01, -1.8754e-01,
          1.3163e+00, -6.1733e-01, -5.6728e-01, -9.5749e-03,  3.2885e-01],
        [ 6.8475e-01,  2.9899e-01,  2.8115e-01, -2.1712e-02, -7.8087e-01,
          2.1549e+00, -9.7802e-01, -5.0542e-01,  4.4124e-02,  3.3274e-01],
        [ 2.6629e-01,  1.2345e-01,  1.8131e-01, -5.6388e-02,  1.3233e-01,
          1.0279e+00, -3.4320e-01, -4.5452e-01, -7.3114e-02,  1.9848e-01],
        [ 1.0685e-01,  2.1136e-01,  2.6446e-01, -6.5559e-02, -2.9825e-02,
          9.9131e-01, -1.7505e-01, -4.5723e-01,  2.4920e-01,  1.0739e-01],
        [ 1.9113e-01,  6.5932e-02,  4.9818e-01, -3.4167e-02, -6.8646e-02,
          1.0815e+00, -3.4030e-01, -5.5264e-01,  1.3110e-01,  1.4961e-01],
        [-1.5236e-02, -1.3426e-01,  3.2690e-01, -2.9698e-02, -1.7356e-01,
          1.5867e+00, -6.0337e-01, -4.8188e-01,  2.0168e-01,  5.8623e-01],
        [-1.8093e-02,  2.3866e-01,  1.6630e-01, -2.7864e-01,  1.8361e-01,
          9.5226e-01, -1.3115e-01, -2.8535e-01,  1.1550e-01,  2.1748e-02],
        [ 3.1167e-01,  1.7174e-01,  2.6113e-01, -1.8681e-01,  2.5673e-01,
          1.1921e+00, -3.4764e-01, -5.5308e-01, -1.0822e-01,  3.4870e-01],
        [ 2.4619e-01,  2.3113e-01,  2.3861e-01, -2.8533e-01,  1.4565e-01,
          9.0188e-01, -1.4586e-01, -3.7955e-01,  2.6829e-01, -3.3527e-02],
        [ 1.0531e-01,  1.5864e-01,  4.9453e-01, -1.3889e-01,  2.1895e-01,
          9.1488e-01, -2.3475e-01, -3.3150e-01,  3.5318e-01,  1.1671e-01],
        [-4.7354e-02,  1.4404e-01,  4.1042e-01, -2.9956e-02,  1.8015e-01,
          1.3587e+00, -3.0057e-01, -5.2536e-01, -9.6227e-02,  1.7267e-01],
        [ 1.8850e-01,  7.3995e-02,  5.2946e-01, -1.0212e-02,  2.3843e-01,
          1.4198e+00, -3.2072e-01, -3.2784e-01,  3.6379e-03,  2.2758e-01],
        [ 1.4985e-01,  1.5855e-01,  1.9040e-01, -2.7033e-01,  1.0166e-02,
          1.0841e+00, -5.1861e-01, -3.2993e-01, -7.3486e-02,  1.3263e-01],
        [ 5.7338e-01,  3.4633e-01,  1.8180e-02,  8.0002e-02, -4.1328e-01,
          1.7135e+00, -7.4259e-01, -4.0016e-01, -1.0650e-01,  1.9984e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4284, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:13:09,011 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
2025-02-27 17:13:09,016 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 0 :1388.58935546875MB
2025-02-27 17:13:09,018 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1388.5849609375MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 8 in train loader:1388.583984375
Loader: train. Accuracy: 0.078125
2025-02-27 17:13:09,327 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:13:09,328 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:13:09,330 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:13:09,330 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:13:09,331 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:13:09,331 - DEBUG - [root] 2 instantiated
2025-02-27 17:13:09,332 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:13:09,332 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:13:09,332 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:13:09,333 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:13:09,333 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:13:09,333 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:13:09,338 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:13:09,339 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:13:09,341 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:13:09,341 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:13:09,342 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:09,342 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:13:09,342 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:13:09,342 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:13:09,343 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:09,343 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:13:09,349 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:13:09,349 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:13:09,349 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:13:09,350 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:13:09,350 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:13:09,353 - DEBUG - [1] Received getitem call: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:13:09,354 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:13:09,354 - DEBUG - [1] Received getitem call: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:13:09,355 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:13:09,361 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:13:09,362 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:13:09,362 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:13:09,363 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:13:09,363 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:13:09,363 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:13:09,363 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:13:09,367 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:13:09,368 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:13:09,368 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:09,368 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:13:09,368 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:13:09,369 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:13:09,369 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:09,369 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:13:09,375 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:13:09,375 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:13:09,375 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:13:09,375 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:13:09,376 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:13:09,379 - DEBUG - [1] Received getitem call: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:13:09,380 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:13:09,380 - DEBUG - [1] Received getitem call: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:13:09,381 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:13:09,382 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:13:09,383 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:13:09,383 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:13:09,384 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:13:09,384 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:13:09,384 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:13:09,385 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:13:09,385 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:13:09,385 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:13:09,387 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:13:09,388 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:13:09,388 - DEBUG - [1][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:13:09,389 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:09,389 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:13:09,389 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:13:09,389 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1'])
2025-02-27 17:13:09,389 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:09,389 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:13:09,390 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:13:09,388 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:13:09,391 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:13:09,393 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:13:09,394 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:13:09,395 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:13:09,395 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:13:09,396 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:13:09,400 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:13:09,401 - DEBUG - [1][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:13:09,401 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:09,401 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:13:09,401 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:13:09,402 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1', '0_sync_barrier'])
2025-02-27 17:13:09,402 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:09,402 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:13:09,403 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:13:09,404 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:13:09,406 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:13:09,410 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:13:09,411 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:13:09,411 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:13:09,413 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:13:09,415 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:13:17,358 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:13:17,359 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:13:17,359 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:13:17,359 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:17,360 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:17,361 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :1404.8359375MB
2025-02-27 17:13:17,362 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:13:17,400 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
2025-02-27 17:13:17,408 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:13:17,410 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
after processing the work_item.microbatch_id 0 :1450.9658203125MBBefore WorkItem Ready if: work_item.blocked_args_count(0) should be 0

2025-02-27 17:13:17,415 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :1450.9658203125MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:13:17,415 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:13:17,420 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:13:17,423 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:17,423 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1450.9658203125MB
2025-02-27 17:13:17,424 - DEBUG - [0][0] Running sync_barrier
----------loss----------
2025-02-27 17:13:17,422 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
{'output': tensor([[ 4.7102e-02,  1.3192e-02,  4.3129e-02, -4.9828e-02,  4.4924e-02,
          2.3790e-02, -8.6080e-03, -5.6543e-02, -2.5889e-02,  6.1700e-02],
        [ 4.0081e-02,  2.2342e-03,  5.0784e-02, -5.7865e-02,  4.2265e-02,
          3.4040e-02, -1.2048e-02, -5.7238e-02, -3.6320e-02,  5.6562e-02],
        [ 3.6916e-02,  9.0568e-03,  4.9642e-02, -5.6008e-02,  4.5570e-02,
          2.1505e-02, -1.4032e-02, -6.5040e-02, -3.6054e-02,  5.5303e-02],
        [ 3.5747e-02, -5.7867e-03,  5.1494e-02, -6.1772e-02,  4.6561e-02,
          1.8016e-02, -1.5383e-02, -5.2197e-02, -3.6609e-02,  5.4625e-02],
        [ 4.3957e-02,  1.0065e-02,  4.6060e-02, -5.0218e-02,  3.8994e-02,
          2.1175e-02, -1.6286e-02, -5.8937e-02, -3.2584e-02,  5.5278e-02],
        [ 3.7331e-02, -6.6420e-03,  5.5705e-02, -6.4162e-02,  5.3333e-02,
          2.0489e-02, -1.0905e-02, -6.2041e-02, -5.1720e-02,  5.4912e-02],
        [ 2.9329e-02,  3.4453e-03,  4.3104e-02, -5.0714e-02,  2.3352e-02,
          1.7465e-02, -2.8422e-03, -6.3063e-02, -2.9170e-02,  6.4506e-02],
        [ 3.7227e-02,  9.2821e-03,  5.0944e-02, -5.4688e-02,  3.1318e-02,
          1.1973e-02, -1.1095e-02, -5.3212e-02, -3.5633e-02,  6.3529e-02],
        [ 3.7361e-02,  2.1907e-03,  5.2225e-02, -6.0704e-02,  4.5514e-02,
          2.0077e-02, -1.5055e-02, -6.5163e-02, -4.6519e-02,  5.2524e-02],
        [ 3.6274e-02, -8.6938e-03,  6.3291e-02, -5.3635e-02,  5.0385e-02,
          2.4759e-02, -1.0537e-02, -5.1779e-02, -4.2118e-02,  5.1479e-02],
        [ 3.6096e-02,  6.3434e-03,  5.3556e-02, -5.2366e-02,  4.2225e-02,
          2.4558e-02, -8.0733e-03, -5.6108e-02, -3.4700e-02,  6.4778e-02],
        [ 3.9720e-02,  1.4745e-03,  5.5266e-02, -5.0764e-02,  4.4859e-02,
          2.2498e-02, -7.4028e-03, -5.6896e-02, -3.6222e-02,  6.8141e-02],
        [ 2.9629e-02,  1.1969e-02,  5.4980e-02, -4.9149e-02,  3.2290e-02,
          3.8351e-02, -2.2771e-03, -6.3181e-02, -4.1386e-02,  6.6600e-02],
        [ 3.2332e-02, -3.2054e-04,  5.6083e-02, -6.0473e-02,  4.5531e-02,
          2.3806e-02, -1.1432e-02, -5.8114e-02, -4.6399e-02,  5.9115e-02],
        [ 4.0007e-02,  1.3284e-02,  4.6249e-02, -4.4454e-02,  3.6537e-02,
          2.1358e-02, -8.7644e-03, -5.7824e-02, -2.9762e-02,  5.8764e-02],
        [ 3.5101e-02,  8.4170e-03,  5.2809e-02, -5.7278e-02,  3.4991e-02,
          2.1900e-02, -2.3834e-03, -5.8622e-02, -3.0649e-02,  6.1499e-02],
        [ 3.3292e-02, -5.1257e-03,  4.7487e-02, -5.4311e-02,  4.3177e-02,
          1.8854e-02, -1.3689e-02, -6.2322e-02, -4.0013e-02,  5.9185e-02],
        [ 3.6588e-02,  7.7579e-03,  4.5925e-02, -5.0606e-02,  2.9246e-02,
          2.6838e-02, -7.8633e-03, -5.4459e-02, -2.0868e-02,  5.8457e-02],
        [ 3.5607e-02,  2.7372e-03,  5.1914e-02, -5.0701e-02,  3.8045e-02,
          2.3474e-02, -1.2125e-02, -6.5344e-02, -3.1922e-02,  6.2477e-02],
        [ 3.4073e-02,  1.9302e-02,  4.7562e-02, -4.6681e-02,  3.0295e-02,
          3.3083e-02, -2.9840e-03, -5.7329e-02, -3.7627e-02,  7.3510e-02],
        [ 4.5036e-02,  1.3651e-02,  4.3503e-02, -4.4373e-02,  4.3139e-02,
          1.3043e-02, -1.0218e-02, -5.2327e-02, -2.6381e-02,  5.8194e-02],
        [ 3.0519e-02,  1.7936e-02,  4.6048e-02, -5.1043e-02,  2.7476e-02,
          2.4198e-02, -3.6911e-03, -5.8577e-02, -3.4142e-02,  7.0761e-02],
        [ 3.2980e-02,  6.1975e-03,  4.8653e-02, -5.4088e-02,  3.9709e-02,
          2.0557e-02, -5.7161e-03, -5.8109e-02, -3.0967e-02,  6.0029e-02],
        [ 4.8141e-02,  1.8037e-02,  4.5319e-02, -4.0488e-02,  4.3998e-02,
          2.2057e-02, -5.2519e-03, -5.7537e-02, -2.4365e-02,  6.3129e-02],
        [ 3.6591e-02,  1.4457e-02,  5.7657e-02, -5.2742e-02,  3.3700e-02,
          3.2132e-02, -1.5065e-03, -6.2824e-02, -3.5130e-02,  7.3026e-02],
        [ 3.9578e-02,  1.5915e-02,  4.1791e-02, -4.4586e-02,  3.1499e-02,
          2.3209e-02, -6.9051e-03, -5.7630e-02, -2.6563e-02,  6.7264e-02],
        [ 3.6810e-02,  1.0437e-02,  5.5991e-02, -4.7010e-02,  3.3285e-02,
          2.7399e-02, -4.6741e-03, -6.1428e-02, -3.3680e-02,  6.2990e-02],
        [ 3.9178e-02,  3.7135e-03,  4.4129e-02, -4.8017e-02,  4.4556e-02,
          2.6319e-02, -9.2182e-03, -6.2126e-02, -3.5652e-02,  5.5962e-02],
        [ 4.0771e-02,  1.6332e-02,  4.8824e-02, -5.1671e-02,  3.4613e-02,
          1.8569e-02, -5.1059e-03, -5.5038e-02, -3.8258e-02,  5.7166e-02],
        [ 4.1039e-02,  1.3535e-02,  4.6909e-02, -4.6759e-02,  4.8256e-02,
          2.4033e-02, -1.0005e-02, -5.7233e-02, -2.5791e-02,  6.1270e-02],
        [ 3.8420e-02, -2.8739e-05,  5.1457e-02, -5.0846e-02,  4.1905e-02,
          1.8305e-02, -7.9145e-03, -5.8672e-02, -3.9350e-02,  6.5063e-02],
        [ 3.6347e-02,  6.7775e-05,  5.0767e-02, -4.7997e-02,  3.9661e-02,
          2.5185e-02, -9.1760e-03, -5.5735e-02, -3.0784e-02,  6.3188e-02],
        [ 3.4884e-02,  1.4741e-02,  4.3244e-02, -4.2785e-02,  3.0377e-02,
          1.8215e-02, -7.4056e-03, -5.5394e-02, -2.5251e-02,  6.6442e-02],
        [ 3.6526e-02,  1.1989e-02,  4.2901e-02, -5.0233e-02,  3.5098e-02,
          2.0894e-02, -6.4392e-03, -5.3546e-02, -2.4744e-02,  6.1214e-02],
        [ 3.5387e-02,  1.7309e-02,  4.4629e-02, -4.3380e-02,  3.5853e-02,
          3.0418e-02, -8.2171e-03, -5.4352e-02, -3.1183e-02,  7.0842e-02],
        [ 3.4282e-02,  4.3910e-03,  5.2990e-02, -5.5788e-02,  3.4692e-02,
          2.4326e-02, -8.9503e-03, -6.3310e-02, -3.0653e-02,  6.6943e-02],
        [ 3.7955e-02,  6.3634e-04,  4.8931e-02, -4.8963e-02,  2.9243e-02,
          2.0095e-02, -1.2777e-02, -5.4031e-02, -2.0322e-02,  5.4588e-02],
        [ 3.6572e-02,  1.0200e-02,  4.8678e-02, -5.0976e-02,  3.1854e-02,
          2.0502e-02, -7.6507e-03, -5.8021e-02, -3.1122e-02,  6.5285e-02],
        [ 3.1923e-02,  1.1005e-02,  4.9048e-02, -4.5384e-02,  2.8586e-02,
          2.5523e-02, -2.8668e-03, -6.1052e-02, -3.1629e-02,  5.7969e-02],
        [ 3.0574e-02,  7.3346e-03,  5.1627e-02, -4.6450e-02,  3.0167e-02,
          2.8943e-02, -8.7559e-03, -5.9680e-02, -3.0553e-02,  6.1583e-02],
        [ 4.2066e-02,  1.4033e-02,  5.0560e-02, -5.5393e-02,  3.1313e-02,
          2.9250e-02, -7.9848e-03, -5.0479e-02, -3.4642e-02,  7.0276e-02],
        [ 3.5606e-02,  2.6575e-03,  5.0132e-02, -5.3467e-02,  2.8878e-02,
          2.6809e-02, -5.3477e-03, -5.7602e-02, -3.0116e-02,  5.8919e-02],
        [ 3.2755e-02,  1.1596e-02,  4.9264e-02, -5.1996e-02,  4.0974e-02,
          2.2208e-02, -9.0727e-03, -6.1102e-02, -3.3411e-02,  6.0427e-02],
        [ 3.6131e-02,  9.9970e-03,  4.9670e-02, -4.7463e-02,  2.8061e-02,
          2.2611e-02, -5.5054e-03, -6.2311e-02, -3.2145e-02,  6.3578e-02],
        [ 3.3193e-02,  2.3096e-03,  4.9633e-02, -5.3545e-02,  3.7076e-02,
          1.6335e-02, -8.6502e-03, -5.8772e-02, -3.3622e-02,  5.7305e-02],
        [ 3.0498e-02,  1.2214e-02,  4.6517e-02, -4.9276e-02,  2.5265e-02,
          1.8570e-02,  2.7939e-03, -5.6055e-02, -3.1937e-02,  6.3490e-02],
        [ 3.3939e-02,  1.5469e-02,  5.0196e-02, -4.4518e-02,  2.7942e-02,
          1.8358e-02, -1.1440e-03, -5.6553e-02, -3.0826e-02,  6.5721e-02],
        [ 3.5725e-02, -4.6797e-03,  5.6209e-02, -5.4781e-02,  4.4027e-02,
          3.8132e-02, -1.3800e-02, -6.3111e-02, -4.4086e-02,  6.4903e-02],
        [ 4.0622e-02,  1.4653e-02,  4.9605e-02, -5.7696e-02,  2.7317e-02,
          2.5602e-02, -7.1432e-03, -5.3235e-02, -3.4588e-02,  6.3478e-02],
        [ 3.8602e-02, -3.8518e-04,  5.2955e-02, -6.2018e-02,  5.3307e-02,
          1.8759e-02, -8.1859e-03, -6.2863e-02, -4.7338e-02,  5.3194e-02],
        [ 3.4590e-02,  7.3200e-03,  5.0047e-02, -5.8557e-02,  4.8223e-02,
          1.8383e-02, -1.2905e-02, -5.9629e-02, -3.8364e-02,  5.6804e-02],
        [ 4.0306e-02,  4.0837e-03,  5.0523e-02, -4.8964e-02,  4.7766e-02,
          2.7052e-02, -6.2437e-03, -6.1679e-02, -3.4669e-02,  5.8635e-02],
        [ 3.4947e-02,  6.2585e-03,  5.2043e-02, -5.1954e-02,  3.6160e-02,
          2.7476e-02, -4.4107e-03, -5.8834e-02, -3.0843e-02,  5.7689e-02],
        [ 3.5625e-02,  4.4871e-03,  5.1097e-02, -5.0459e-02,  3.0225e-02,
          2.4342e-02, -5.3428e-03, -5.8092e-02, -2.6913e-02,  5.8478e-02],
        [ 4.3203e-02,  5.8611e-03,  4.6474e-02, -5.0168e-02,  3.4583e-02,
          3.0805e-02, -6.9551e-03, -4.9856e-02, -2.6412e-02,  6.0507e-02],
        [ 3.6564e-02, -2.8336e-03,  5.8652e-02, -5.0665e-02,  3.3895e-02,
          2.2293e-02, -6.9388e-03, -5.2823e-02, -3.5177e-02,  5.5861e-02],
        [ 4.3012e-02,  1.0958e-02,  4.4645e-02, -4.5231e-02,  3.3840e-02,
          1.9651e-02, -5.7907e-03, -5.3378e-02, -2.5874e-02,  5.8935e-02],
        [ 4.2175e-02,  1.0179e-02,  4.8433e-02, -4.1580e-02,  3.7309e-02,
          2.7988e-02, -1.0031e-02, -5.5428e-02, -2.3966e-02,  5.5565e-02],
        [ 4.2451e-02,  1.1519e-02,  4.5846e-02, -5.0735e-02,  4.2197e-02,
          1.8446e-02, -7.3952e-03, -5.3273e-02, -3.1454e-02,  5.7877e-02],
        [ 3.8889e-02,  1.5574e-02,  4.1145e-02, -4.7825e-02,  3.7999e-02,
          1.7062e-02, -1.0992e-02, -5.7495e-02, -2.6766e-02,  6.3419e-02],
        [ 3.8199e-02,  1.4481e-02,  4.4555e-02, -4.3525e-02,  3.4469e-02,
          2.2970e-02, -5.0551e-03, -5.6905e-02, -2.6180e-02,  6.8471e-02],
        [ 3.5147e-02,  1.7310e-02,  5.2625e-02, -4.4651e-02,  3.2563e-02,
          2.5864e-02, -2.9028e-03, -6.0230e-02, -2.9293e-02,  6.7526e-02],
        [ 3.5475e-02,  5.8492e-03,  5.4879e-02, -4.9349e-02,  3.9452e-02,
          2.2532e-02, -5.1325e-03, -5.9778e-02, -3.7320e-02,  5.9942e-02],
        [ 4.6193e-02,  1.2012e-02,  3.9816e-02, -3.9612e-02,  3.9816e-02,
          2.2780e-02, -8.5716e-03, -4.9410e-02, -2.0605e-02,  6.0569e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3052, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:13:17,548 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :1450.96875MB
2025-02-27 17:13:17,555 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1450.96875MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:13:19,304 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:13:19,305 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:13:19,305 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:19,306 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:13:19,306 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:13:19,306 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :1450.96875MB
2025-02-27 17:13:19,307 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:13:19,362 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
2025-02-27 17:13:19,370 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
after processing the work_item.microbatch_id 1 :1506.099609375MB
2025-02-27 17:13:19,371 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:13:19,373 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0Periodic memory cleanup :1506.099609375MB

2025-02-27 17:13:19,376 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:13:19,377 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:13:19,378 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:13:19,378 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:13:19,378 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :1506.099609375MB
2025-02-27 17:13:19,379 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0478,  0.0164,  0.0445, -0.0482,  0.0504,  0.0174, -0.0123, -0.0557,
         -0.0276,  0.0581],
        [ 0.0396,  0.0181,  0.0466, -0.0456,  0.0399,  0.0290, -0.0074, -0.0547,
         -0.0341,  0.0648],
        [ 0.0365,  0.0151,  0.0505, -0.0533,  0.0318,  0.0179, -0.0086, -0.0572,
         -0.0338,  0.0624],
        [ 0.0340, -0.0049,  0.0623, -0.0657,  0.0519,  0.0264, -0.0103, -0.0624,
         -0.0510,  0.0599],
        [ 0.0390,  0.0050,  0.0484, -0.0508,  0.0462,  0.0241, -0.0131, -0.0572,
         -0.0314,  0.0629],
        [ 0.0415,  0.0084,  0.0433, -0.0503,  0.0421,  0.0235, -0.0071, -0.0564,
         -0.0264,  0.0586],
        [ 0.0264,  0.0169,  0.0426, -0.0520,  0.0310,  0.0286, -0.0096, -0.0571,
         -0.0253,  0.0694],
        [ 0.0319,  0.0080,  0.0458, -0.0498,  0.0346,  0.0266, -0.0115, -0.0602,
         -0.0333,  0.0603],
        [ 0.0352,  0.0158,  0.0489, -0.0499,  0.0304,  0.0283, -0.0073, -0.0589,
         -0.0367,  0.0688],
        [ 0.0339,  0.0208,  0.0470, -0.0436,  0.0321,  0.0263, -0.0044, -0.0576,
         -0.0320,  0.0713],
        [ 0.0363,  0.0116,  0.0486, -0.0501,  0.0261,  0.0215, -0.0067, -0.0560,
         -0.0305,  0.0669],
        [ 0.0356,  0.0080,  0.0478, -0.0534,  0.0311,  0.0245, -0.0089, -0.0549,
         -0.0310,  0.0591],
        [ 0.0445,  0.0096,  0.0491, -0.0468,  0.0463,  0.0194, -0.0090, -0.0560,
         -0.0273,  0.0591],
        [ 0.0341, -0.0047,  0.0510, -0.0574,  0.0486,  0.0234, -0.0116, -0.0597,
         -0.0458,  0.0541],
        [ 0.0371,  0.0110,  0.0480, -0.0536,  0.0321,  0.0273, -0.0048, -0.0570,
         -0.0249,  0.0671],
        [ 0.0467,  0.0169,  0.0458, -0.0449,  0.0366,  0.0289, -0.0055, -0.0558,
         -0.0248,  0.0676],
        [ 0.0368,  0.0013,  0.0554, -0.0563,  0.0494,  0.0272, -0.0112, -0.0626,
         -0.0471,  0.0595],
        [ 0.0328,  0.0043,  0.0521, -0.0555,  0.0432,  0.0253, -0.0080, -0.0532,
         -0.0359,  0.0581],
        [ 0.0367,  0.0126,  0.0450, -0.0466,  0.0344,  0.0275, -0.0075, -0.0588,
         -0.0330,  0.0619],
        [ 0.0400,  0.0148,  0.0414, -0.0469,  0.0398,  0.0271, -0.0095, -0.0554,
         -0.0265,  0.0666],
        [ 0.0420,  0.0122,  0.0489, -0.0542,  0.0456,  0.0171, -0.0135, -0.0601,
         -0.0322,  0.0585],
        [ 0.0310,  0.0132,  0.0511, -0.0467,  0.0353,  0.0309, -0.0035, -0.0609,
         -0.0392,  0.0657],
        [ 0.0405,  0.0067,  0.0511, -0.0561,  0.0411,  0.0237, -0.0100, -0.0557,
         -0.0342,  0.0560],
        [ 0.0385,  0.0160,  0.0539, -0.0571,  0.0502,  0.0207, -0.0135, -0.0612,
         -0.0369,  0.0534],
        [ 0.0455,  0.0104,  0.0478, -0.0543,  0.0324,  0.0234, -0.0083, -0.0571,
         -0.0302,  0.0609],
        [ 0.0290, -0.0030,  0.0547, -0.0589,  0.0361,  0.0271, -0.0121, -0.0611,
         -0.0378,  0.0521],
        [ 0.0403,  0.0101,  0.0490, -0.0526,  0.0485,  0.0224, -0.0105, -0.0553,
         -0.0344,  0.0604],
        [ 0.0395,  0.0047,  0.0597, -0.0514,  0.0380,  0.0219, -0.0040, -0.0578,
         -0.0337,  0.0589],
        [ 0.0366,  0.0104,  0.0494, -0.0382,  0.0334,  0.0253, -0.0051, -0.0582,
         -0.0268,  0.0669],
        [ 0.0442,  0.0151,  0.0422, -0.0447,  0.0456,  0.0215, -0.0096, -0.0515,
         -0.0262,  0.0589],
        [ 0.0402,  0.0125,  0.0448, -0.0480,  0.0381,  0.0181, -0.0083, -0.0553,
         -0.0261,  0.0547],
        [ 0.0470,  0.0093,  0.0446, -0.0420,  0.0420,  0.0273, -0.0060, -0.0560,
         -0.0242,  0.0614],
        [ 0.0393,  0.0027,  0.0556, -0.0598,  0.0532,  0.0213, -0.0092, -0.0665,
         -0.0467,  0.0576],
        [ 0.0385,  0.0095,  0.0486, -0.0527,  0.0387,  0.0210, -0.0048, -0.0596,
         -0.0270,  0.0573],
        [ 0.0392, -0.0029,  0.0501, -0.0587,  0.0446,  0.0213, -0.0036, -0.0542,
         -0.0372,  0.0657],
        [ 0.0340, -0.0021,  0.0568, -0.0614,  0.0511,  0.0181, -0.0129, -0.0689,
         -0.0474,  0.0560],
        [ 0.0386,  0.0122,  0.0472, -0.0504,  0.0272,  0.0225, -0.0059, -0.0566,
         -0.0295,  0.0625],
        [ 0.0366,  0.0069,  0.0486, -0.0446,  0.0329,  0.0241, -0.0126, -0.0554,
         -0.0281,  0.0546],
        [ 0.0480,  0.0157,  0.0406, -0.0408,  0.0410,  0.0269, -0.0104, -0.0536,
         -0.0219,  0.0619],
        [ 0.0428,  0.0179,  0.0410, -0.0424,  0.0451,  0.0318, -0.0062, -0.0522,
         -0.0247,  0.0653],
        [ 0.0300,  0.0128,  0.0548, -0.0511,  0.0396,  0.0199, -0.0115, -0.0553,
         -0.0329,  0.0523],
        [ 0.0399,  0.0146,  0.0485, -0.0466,  0.0242,  0.0215, -0.0073, -0.0547,
         -0.0256,  0.0675],
        [ 0.0344,  0.0003,  0.0508, -0.0591,  0.0363,  0.0211, -0.0089, -0.0554,
         -0.0379,  0.0620],
        [ 0.0407,  0.0129,  0.0456, -0.0447,  0.0392,  0.0263, -0.0084, -0.0565,
         -0.0266,  0.0610],
        [ 0.0382,  0.0129,  0.0456, -0.0533,  0.0349,  0.0279, -0.0035, -0.0560,
         -0.0291,  0.0619],
        [ 0.0396,  0.0127,  0.0477, -0.0490,  0.0414,  0.0210, -0.0119, -0.0568,
         -0.0252,  0.0572],
        [ 0.0337, -0.0047,  0.0496, -0.0568,  0.0461,  0.0200, -0.0128, -0.0640,
         -0.0435,  0.0560],
        [ 0.0431,  0.0154,  0.0410, -0.0418,  0.0422,  0.0218, -0.0105, -0.0536,
         -0.0203,  0.0633],
        [ 0.0374, -0.0026,  0.0468, -0.0534,  0.0380,  0.0241, -0.0120, -0.0561,
         -0.0354,  0.0591],
        [ 0.0380,  0.0104,  0.0443, -0.0431,  0.0388,  0.0204, -0.0043, -0.0500,
         -0.0232,  0.0578],
        [ 0.0387,  0.0170,  0.0490, -0.0475,  0.0412,  0.0263, -0.0121, -0.0633,
         -0.0344,  0.0573],
        [ 0.0366,  0.0043,  0.0503, -0.0545,  0.0438,  0.0250, -0.0088, -0.0574,
         -0.0342,  0.0647],
        [ 0.0602,  0.0060,  0.0565, -0.0575,  0.0313,  0.0303, -0.0248, -0.0459,
         -0.0190,  0.0425],
        [ 0.0400, -0.0061,  0.0536, -0.0537,  0.0454,  0.0281, -0.0094, -0.0561,
         -0.0362,  0.0611],
        [ 0.0392,  0.0086,  0.0481, -0.0488,  0.0423,  0.0202, -0.0105, -0.0548,
         -0.0336,  0.0545],
        [ 0.0405,  0.0036,  0.0456, -0.0556,  0.0470,  0.0242, -0.0133, -0.0527,
         -0.0335,  0.0637],
        [ 0.0417,  0.0150,  0.0449, -0.0451,  0.0401,  0.0265, -0.0098, -0.0583,
         -0.0272,  0.0676],
        [ 0.0413,  0.0042,  0.0474, -0.0489,  0.0272,  0.0267, -0.0031, -0.0524,
         -0.0321,  0.0609],
        [ 0.0364, -0.0001,  0.0542, -0.0579,  0.0443,  0.0222, -0.0144, -0.0633,
         -0.0385,  0.0549],
        [ 0.0421,  0.0143,  0.0466, -0.0508,  0.0388,  0.0262, -0.0068, -0.0554,
         -0.0291,  0.0622],
        [ 0.0397,  0.0024,  0.0514, -0.0612,  0.0513,  0.0240, -0.0117, -0.0662,
         -0.0464,  0.0587],
        [ 0.0344,  0.0065,  0.0502, -0.0634,  0.0365,  0.0272, -0.0118, -0.0608,
         -0.0411,  0.0604],
        [ 0.0347,  0.0166,  0.0469, -0.0475,  0.0280,  0.0250, -0.0076, -0.0567,
         -0.0297,  0.0686],
        [ 0.0382,  0.0121,  0.0495, -0.0504,  0.0355,  0.0292, -0.0061, -0.0606,
         -0.0329,  0.0637]], device='cuda:0', requires_grad=True), 'loss': tensor(2.3057, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:13:19,483 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :1506.1025390625MB2025-02-27 17:13:19,490 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters

2025-02-27 17:13:19,491 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1506.107421875MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 0 in valid loader:1506.0908203125
Loader: valid. Accuracy: 0.1015625
GPU End of epoch 4:1506.0908203125
[31mSwitching template...[0m
2025-02-27 17:13:19,496 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:13:19,498 - INFO - [root] Sending stage_id = 0 mod to worker
2025-02-27 17:13:19,499 - INFO - [0] Instantiating RankWorker
Inital rank worker:1506.0908203125MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0after initialization :1506.0908203125MB

[32mCurrent descr name: submod_0, stage_id: 0, rank: 0[0m
2025-02-27 17:13:19,521 - INFO - [root] Sending stage_id = 1 mod to worker
2025-02-27 17:13:19,572 - INFO - Instantiating PipeStageExecutor for stage 0
[32mCurrent descr name: submod_1, stage_id: 1, rank: 1[0m
[31mSwitch template complete![0m
[31mTime taken to switch template: 81.5187075138092 seconds[0m
Epoch: 5
GPU Start of epoch 5:1508.6845703125
2025-02-27 17:14:43,360 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:14:43,361 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:14:43,363 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:14:43,363 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:14:43,364 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:14:43,365 - DEBUG - [root] 2 instantiated
2025-02-27 17:14:43,365 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:14:43,365 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:14:43,366 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:14:43,366 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:14:43,366 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:14:43,367 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:14:43,369 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:14:43,370 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:14:43,372 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,373 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:14:43,373 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:14:43,373 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:14:43,374 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:14:43,375 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:14:43,376 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,376 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:14:43,377 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,377 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :1509.3095703125MB
2025-02-27 17:14:43,380 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:14:43,399 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:14:43,400 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:14:43,400 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:14:43,401 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:14:43,401 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:14:43,405 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:14:43,405 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:14:43,424 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:14:43,424 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:14:43,425 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:14:43,426 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:14:43,426 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,427 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:14:43,427 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:14:43,429 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:14:43,430 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:14:43,430 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,448 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:14:43,449 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:14:43,449 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:14:43,449 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:14:43,450 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:14:43,450 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:14:43,451 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:14:43,451 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:14:43,454 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:14:43,455 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:14:43,460 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:14:43,461 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:14:43,461 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:14:43,461 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:14:43,461 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:14:43,466 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:14:43,467 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:14:43,487 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:14:43,488 - DEBUG - [0][0] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:14:43,489 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:14:43,490 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:14:43,490 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 0_stage_backward_1
2025-02-27 17:14:43,491 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:14:43,491 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:14:43,491 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:14:43,491 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:14:43,493 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:14:43,500 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:14:43,501 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:14:43,501 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:14:43,502 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:14:43,502 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:14:43,503 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:14:43,503 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:14:43,503 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:14:43,505 - DEBUG - [0] Received getitem call: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:14:43,507 - DEBUG - [0] Received getitem call: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:14:43,508 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:14:43,508 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:14:43,523 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:14:43,523 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:14:43,524 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:14:43,524 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:14:43,524 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:14:43,524 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:14:43,525 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:14:43,525 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:14:43,529 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:14:43,529 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:14:43,531 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:14:43,531 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:14:43,535 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:14:43,535 - DEBUG - [0][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:14:43,536 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:14:43,536 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:14:43,536 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:14:43,537 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1'])
2025-02-27 17:14:43,537 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:14:43,537 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:14:43,537 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:14:43,539 - DEBUG - [0][1] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:14:43,541 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:14:43,541 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:14:43,542 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:14:43,546 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 1_stage_backward_1
2025-02-27 17:14:43,546 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:14:43,546 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier'])
2025-02-27 17:14:43,547 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:14:43,547 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:14:43,549 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:14:43,550 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:14:43,543 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:14:43,557 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:14:43,559 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_7) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:14:43,561 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_6) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:14:43,566 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:14:43,568 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:14:43,569 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:14:43,569 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:14:43,569 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:14:43,570 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:14:43,575 - DEBUG - [0] Received getitem call: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:14:43,576 - DEBUG - [0] Received getitem call: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:14:43,581 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:14:43,581 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:14:43,585 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:14:43,595 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:14:43,596 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:14:43,598 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:14:43,599 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:14:43,600 - DEBUG - [0][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:14:43,602 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:14:43,602 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:14:43,603 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:14:43,610 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier', '1_stage_backward_1'])
2025-02-27 17:14:43,611 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:14:43,611 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:14:43,613 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:14:43,614 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:14:43,615 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:14:43,617 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:14:43,618 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:14:43,620 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_7) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:14:43,625 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_6) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:14:43,626 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:14:43,793 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :1751.5693359375MB
2025-02-27 17:14:43,892 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1751.5693359375MB
All workitem count at loop begining: 5, current work item in ready runlist: 1, current work item in waiting runlist: 4
2025-02-27 17:14:43,895 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:14:43,896 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:43,896 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :1751.5693359375MB
2025-02-27 17:14:43,897 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:14:43,936 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:14:47,223 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :1991.5791015625MB
2025-02-27 17:14:47,375 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:14:47,380 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
Periodic memory cleanup :1991.5791015625MB
All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:15:00,512 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:15:00,514 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:15:16,720 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:15:51,035 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:15:51,037 - DEBUG - [0][0] all operands ready: 0_stage_backward_1
2025-02-27 17:15:51,037 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:15:51,037 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:15:51,038 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:15:51,038 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 0 :2007.5849609375MB
2025-02-27 17:15:51,040 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:15:51,040 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:15:51,041 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
2025-02-27 17:15:51,041 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:15:51,042 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:15:53,843 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:15:53,849 - DEBUG - [0][1] all operands ready: 1_stage_backward_1
2025-02-27 17:15:53,850 - INFO - WorkItem is ready: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:15:53,882 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward_1
2025-02-27 17:15:53,902 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:15:53,904 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:15:53,904 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:15:53,904 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 0 :1786.154296875MB
2025-02-27 17:15:53,905 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
Periodic memory cleanup :1786.154296875MB
All workitem count at loop begining: 3, current work item in ready runlist: 2, current work item in waiting runlist: 1
2025-02-27 17:15:53,966 - DEBUG - [0] Dequeueing workitem from set of 2
2025-02-27 17:15:53,966 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:15:53,967 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
before processing the work_item.microbatch_id 1 :1786.154296875MB
2025-02-27 17:15:53,969 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:15:53,969 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:15:54,142 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward_1
2025-02-27 17:15:54,146 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:15:54,147 - DEBUG - [0][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:15:54,148 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:15:54,148 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 1 :1552.64453125MB
2025-02-27 17:15:54,153 - INFO - Released WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
Periodic memory cleanup :1552.64453125MB
All workitem count at loop begining: 2, current work item in ready runlist: 2, current work item in waiting runlist: 0
2025-02-27 17:15:54,264 - DEBUG - [0] Dequeueing workitem from set of 2
2025-02-27 17:15:54,264 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:54,265 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1552.64453125MB
2025-02-27 17:15:54,266 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 2.5678e-01,  2.0093e-01,  1.5037e-01, -2.8184e-01, -4.4513e-02,
          1.1500e+00, -3.1553e-01, -4.2529e-01,  1.7052e-02,  2.4657e-01],
        [ 1.4088e-01,  1.7008e-01,  4.5130e-01, -1.9420e-01, -2.7644e-01,
          1.7719e+00, -7.3182e-01, -2.5576e-01, -2.2264e-02,  2.0822e-01],
        [ 2.3531e-01,  1.4069e-01,  4.2010e-01, -3.1693e-01,  2.9792e-01,
          1.1985e+00, -4.7042e-01, -3.5952e-01,  7.1033e-02,  1.7754e-01],
        [ 2.1764e-01,  2.0812e-01,  1.7712e-02, -2.5311e-01,  1.2957e-01,
          1.5807e+00, -6.0528e-01, -5.9049e-01,  8.0595e-02,  4.9562e-01],
        [ 3.6804e-01,  2.8011e-01,  2.9087e-01, -3.0551e-01, -1.6642e-01,
          1.5426e+00, -5.3013e-01, -3.8535e-01,  2.5334e-01,  6.9142e-02],
        [ 1.4904e-02,  2.2632e-01,  4.1599e-01, -1.6942e-01,  7.2704e-02,
          1.1228e+00, -3.0204e-01, -1.7188e-01,  1.1292e-01,  1.1248e-01],
        [ 1.2019e-01,  1.0993e-01,  4.2364e-01,  1.0474e-01,  1.7195e-01,
          1.2158e+00, -4.0324e-02, -3.6224e-01,  1.7935e-01,  1.5754e-01],
        [ 2.2311e-01,  3.0077e-01,  3.2059e-01, -1.0635e-01, -1.0654e-01,
          1.2637e+00, -3.5485e-01, -3.2720e-01, -1.0287e-01,  3.0881e-01],
        [ 1.6770e-01,  1.0935e-01,  3.6296e-01, -2.3545e-01, -4.5147e-02,
          1.3556e+00, -4.1603e-01, -3.7580e-01,  1.8418e-02,  2.1331e-01],
        [ 4.0707e-01,  1.6561e-01, -5.5574e-02, -6.4195e-02, -2.0761e-01,
          1.2205e+00, -4.9971e-01, -5.9724e-01, -1.2143e-01,  3.5295e-01],
        [ 5.7496e-01,  2.8497e-01,  3.8138e-01, -4.6367e-02,  1.7622e-01,
          1.4673e+00, -7.2248e-01, -6.5988e-01,  2.0894e-01, -1.5978e-02],
        [ 1.7909e-03,  2.7075e-01,  2.9798e-01, -2.2078e-01,  3.6464e-02,
          1.2869e+00, -4.8218e-01, -5.9385e-01,  7.8954e-02,  4.3665e-01],
        [ 5.3386e-02,  3.2098e-01,  6.7437e-01, -1.8592e-01, -1.0660e-01,
          1.2838e+00, -2.4438e-01, -4.6809e-01,  6.1457e-02,  2.4608e-01],
        [ 2.3568e-01,  2.0540e-01,  2.3755e-01, -1.3206e-01,  6.3392e-02,
          1.2688e+00, -2.3314e-01, -2.9277e-01, -3.7519e-02,  2.0165e-01],
        [ 4.4065e-02,  1.5659e-01,  2.6263e-01, -1.0163e-01,  1.8750e-01,
          1.0160e+00, -1.0036e-01, -2.6859e-01,  1.3489e-01,  1.2055e-01],
        [ 7.2146e-02,  2.0182e-01,  3.3544e-01, -5.3993e-02,  2.1083e-01,
          9.7866e-01, -9.6935e-02, -3.8417e-01,  1.3210e-01,  7.1402e-02],
        [ 9.2159e-02,  3.9925e-02,  3.9589e-01, -2.2158e-01,  2.1634e-02,
          1.2294e+00, -4.5619e-01, -4.2301e-01, -5.4018e-02,  4.0340e-01],
        [ 6.9067e-02,  2.7941e-01,  2.7506e-01, -2.4268e-01, -3.6599e-01,
          1.4664e+00, -2.5877e-01, -4.3569e-01, -7.7363e-02,  5.8751e-01],
        [ 2.3905e-01,  1.4536e-01,  2.3705e-01, -1.2572e-01,  4.9141e-02,
          1.1591e+00, -2.9555e-01, -3.2514e-01,  2.2598e-01,  4.1516e-02],
        [ 1.2924e-01,  1.0363e-01,  2.4498e-01, -1.0770e-01, -1.8061e-01,
          1.3829e+00, -4.3911e-01, -5.6609e-01,  1.1379e-01,  2.6788e-01],
        [ 6.1159e-02,  4.7291e-01,  3.9708e-01, -2.3632e-01,  2.0496e-03,
          1.2703e+00, -5.5572e-01, -4.9484e-01,  1.6656e-01,  5.7320e-02],
        [ 3.7175e-01,  5.4649e-01,  4.3801e-01,  5.2155e-02, -4.0698e-01,
          2.1323e+00, -1.3483e+00, -2.4680e-01,  2.8385e-01,  9.9786e-02],
        [-6.1278e-02,  2.4958e-01,  3.0436e-01, -1.8740e-01,  1.4539e-02,
          1.0091e+00, -1.9050e-01, -2.8139e-01,  1.6357e-01,  1.6240e-01],
        [ 1.0909e-02,  1.4538e-01,  4.2757e-01, -1.9859e-01,  2.0009e-02,
          1.2691e+00, -2.8435e-01, -4.1239e-01,  1.4209e-01,  2.0228e-01],
        [ 1.6369e-01,  3.0928e-01,  2.8008e-01, -7.1320e-02,  1.7056e-01,
          1.0760e+00, -3.5863e-01, -4.5737e-01,  1.6977e-01,  1.4242e-01],
        [-1.4736e-01,  1.6746e-01,  4.6725e-01, -2.1098e-02,  9.2078e-02,
          1.0607e+00, -2.9477e-01, -3.3883e-01,  6.8668e-02,  1.3831e-01],
        [ 1.6357e-01,  1.4771e-01,  3.2282e-01, -3.8200e-01, -2.5947e-01,
          1.2113e+00, -5.7532e-02, -5.2660e-01,  1.7249e-01,  1.8556e-01],
        [ 8.7811e-02, -7.9501e-02,  5.1058e-01, -1.1151e-01, -6.1930e-02,
          1.1272e+00, -1.7773e-01, -7.0548e-01,  2.3531e-02,  9.3446e-02],
        [ 3.7220e-01,  2.7506e-02,  3.1516e-01, -2.4889e-01, -1.4403e-01,
          8.7202e-01, -4.7991e-01, -3.0763e-01,  6.0623e-02,  2.2215e-01],
        [ 2.4978e-01,  2.4121e-02,  4.0395e-01, -1.2816e-01, -4.5815e-02,
          1.1616e+00, -4.4857e-01, -6.0125e-01, -2.1302e-01,  9.4901e-02],
        [ 6.7566e-01,  6.3834e-02,  2.2627e-01, -1.9490e-01, -1.8656e-01,
          1.4432e+00, -8.7800e-01, -5.2911e-01, -1.5810e-01,  2.1121e-01],
        [ 2.8873e-01,  3.6756e-01,  3.8980e-01, -4.1334e-01,  1.5007e-02,
          1.2041e+00, -3.4001e-01, -5.0547e-01,  1.5886e-01,  1.7018e-01],
        [ 4.3153e-02,  3.2142e-01,  3.0595e-01, -1.3779e-01, -1.0308e-01,
          1.1594e+00, -5.6915e-01, -2.3440e-01, -1.0690e-01, -6.1646e-02],
        [ 9.7365e-02,  4.6490e-01,  3.0497e-01,  1.8374e-01, -1.5072e-01,
          1.4025e+00, -8.2408e-01, -5.0199e-01,  1.5299e-01,  5.5511e-01],
        [ 1.1389e-01,  2.5410e-01,  3.2358e-01, -4.3827e-01, -2.3512e-01,
          1.9630e+00, -5.6842e-01, -7.9549e-01, -2.5478e-01,  1.0312e-01],
        [ 4.6199e-01,  1.1038e-02,  4.9728e-01,  1.6160e-01,  2.4760e-02,
          1.2721e+00, -7.0742e-01, -5.5405e-01, -6.5890e-02,  3.1169e-01],
        [ 8.7449e-02, -5.8006e-02,  3.0760e-01, -4.0164e-02,  1.7923e-01,
          1.1651e+00, -3.9930e-01, -3.3717e-01,  8.4613e-02,  3.2876e-01],
        [ 2.6967e-01,  2.5291e-01,  3.4085e-01, -3.7032e-01, -9.0944e-02,
          1.1437e+00, -5.0883e-01, -4.6195e-01, -1.4657e-01,  1.9143e-01],
        [ 7.7580e-02,  2.8154e-01,  2.7650e-01,  5.5072e-02,  1.4705e-02,
          1.1738e+00, -4.5471e-01, -2.4718e-01,  1.1462e-01,  1.1908e-01],
        [ 5.1202e-02,  8.0835e-02,  4.3114e-01, -1.2687e-01, -1.6532e-01,
          1.2739e+00, -6.3099e-01, -4.6457e-01,  8.7951e-02,  4.5503e-01],
        [ 3.3390e-01,  3.1710e-01,  1.4281e-01, -1.7059e-01, -1.7703e-01,
          1.3752e+00, -7.2817e-01, -3.7929e-01, -2.0645e-01, -5.5822e-02],
        [ 1.5523e-01,  1.6644e-01,  4.1288e-01, -2.1273e-01, -2.4619e-01,
          1.2223e+00, -5.1157e-01, -3.1848e-01,  2.0479e-01,  7.2729e-02],
        [ 5.3443e-01, -7.1918e-03,  4.5303e-01, -6.2758e-01, -3.9674e-02,
          1.1161e+00, -5.0170e-01, -5.3061e-01, -2.2057e-02,  2.4964e-01],
        [ 3.1682e-01,  3.7723e-01,  2.7931e-01, -1.7555e-01,  1.0441e-01,
          1.3577e+00, -5.2827e-01, -5.1564e-01, -1.6908e-01,  2.2457e-01],
        [ 1.0667e-01,  2.1072e-01,  4.4591e-01, -1.2531e-01,  2.1116e-02,
          1.0247e+00, -2.6182e-01, -3.2514e-01,  2.1531e-02,  1.3129e-02],
        [ 1.5157e-01,  3.5616e-01,  1.6783e-01, -1.6804e-01,  1.5079e-01,
          9.8119e-01, -2.0855e-01, -2.9857e-01, -6.6053e-02,  3.4841e-01],
        [ 1.2204e-01,  2.0469e-01,  2.0366e-01, -2.4736e-01,  4.3281e-03,
          1.2189e+00, -2.6830e-01, -4.2843e-01,  1.0298e-01,  1.8822e-01],
        [ 1.4223e-01,  2.9322e-01,  4.4718e-01, -2.2781e-01,  2.7290e-01,
          1.1774e+00, -3.2026e-01, -5.9676e-01,  2.1462e-01,  1.2787e-01],
        [ 6.0441e-02,  2.4815e-01,  2.3443e-01, -2.1960e-01,  9.5111e-02,
          1.3698e+00, -3.8971e-01, -3.3983e-01,  4.9259e-02,  1.4414e-01],
        [ 4.2483e-01,  2.2294e-01,  4.3240e-01, -1.8855e-01,  3.0341e-01,
          8.8396e-01, -4.8887e-01, -4.2689e-01,  9.2841e-03,  3.3557e-01],
        [ 2.1958e-01,  2.2271e-01,  3.4859e-01,  7.2397e-03,  6.4566e-02,
          1.1104e+00, -3.4323e-01, -1.6435e-01,  4.1111e-02,  1.2518e-01],
        [ 2.7231e-01,  2.1565e-01,  4.9074e-01, -5.8231e-02,  4.2034e-02,
          1.4071e+00, -3.9510e-01, -3.6672e-01,  1.7201e-01,  2.6244e-01],
        [ 2.3016e-01,  2.7148e-01,  1.8404e-01, -9.7320e-02,  1.3567e-01,
          1.6589e+00, -4.2651e-01, -5.0721e-01, -1.7956e-01,  2.4276e-01],
        [ 4.1621e-02,  5.1691e-01,  1.7083e-01,  1.2555e-02, -2.1105e-01,
          1.3171e+00, -3.4215e-01, -4.8270e-01,  2.6722e-01,  1.2766e-01],
        [ 9.9270e-02,  5.4585e-01,  2.0713e-01, -1.8934e-01,  7.2526e-03,
          1.5385e+00, -6.0036e-01, -4.9225e-01,  1.6040e-01,  3.1991e-01],
        [ 2.8036e-01,  5.9834e-01,  3.1474e-01, -5.1142e-01, -4.4853e-01,
          1.4878e+00, -7.8171e-01, -7.1636e-01, -9.8364e-03,  3.5747e-02],
        [ 2.0382e-01,  1.7710e-01,  3.2565e-01, -3.1759e-02,  2.2777e-01,
          1.0283e+00, -2.8123e-01, -5.7860e-01, -2.0277e-02,  2.8051e-01],
        [ 1.9257e-01,  1.1253e-01,  2.6525e-01, -1.3829e-01,  2.2077e-01,
          1.0369e+00, -1.8208e-01, -2.9854e-01,  1.5546e-01,  1.9466e-01],
        [ 4.6533e-01,  2.7586e-01,  1.2278e-01, -1.6593e-01, -1.7324e-01,
          1.2587e+00, -6.8254e-01, -8.0343e-01, -2.4362e-02,  2.7286e-01],
        [ 7.6891e-02,  1.4413e-01,  3.7482e-01, -3.7762e-01,  1.6191e-01,
          1.2534e+00, -5.9502e-01, -3.3557e-01, -2.8178e-02,  2.3911e-01],
        [ 2.5919e-01,  9.6802e-02,  2.6194e-01, -1.7429e-01,  5.0199e-02,
          1.6482e+00, -6.5679e-01, -4.5594e-01, -2.5995e-01, -8.9428e-02],
        [ 3.7572e-02,  2.4014e-02,  2.0114e-01, -2.8411e-01, -8.9972e-02,
          1.0775e+00, -3.9324e-01, -5.4008e-01,  2.8460e-01,  1.3319e-01],
        [ 2.4363e-01,  7.9557e-02,  2.1051e-01, -3.4210e-01, -8.0793e-02,
          1.0288e+00, -2.8916e-01, -4.9339e-01, -3.0401e-02,  2.4290e-01],
        [ 1.3236e-01,  2.4401e-01,  3.5748e-01, -3.2600e-01,  2.1981e-01,
          1.1046e+00, -4.7905e-01, -4.9215e-01, -1.8278e-02,  3.5598e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3793, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:15:54,461 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :1511.8974609375MB
2025-02-27 17:15:54,470 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1511.8974609375MB
All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:15:54,477 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:15:54,477 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:54,478 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :1511.8974609375MB
2025-02-27 17:15:54,479 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 3.1418e-01,  3.2042e-01, -1.1365e-01, -2.2529e-01, -2.6234e-01,
          1.4390e+00, -6.8195e-01, -3.7493e-01,  4.4015e-01,  5.3596e-01],
        [ 4.7903e-01,  3.0168e-01,  3.8849e-01, -2.3196e-01, -2.1090e-01,
          1.3049e+00, -6.4655e-01, -5.5740e-01, -9.4852e-02,  1.5869e-01],
        [ 2.8810e-01,  2.7406e-01,  4.1869e-01, -2.3214e-01,  1.0909e-01,
          1.0520e+00, -4.3683e-01, -4.2317e-01,  9.6512e-02,  3.3356e-01],
        [ 4.2705e-01,  2.7121e-01,  2.3214e-01, -2.1497e-01, -1.3415e-01,
          1.2442e+00, -4.4387e-01, -5.0011e-01, -7.8417e-02,  1.3118e-01],
        [ 2.9261e-02,  2.5782e-02,  2.2817e-01, -1.4348e-01,  6.6435e-02,
          1.1061e+00, -5.4356e-01, -4.8978e-01,  2.0140e-02,  1.2581e-01],
        [ 2.7490e-01,  6.3040e-01,  1.4851e-01, -2.0935e-02, -7.0350e-02,
          1.1739e+00, -7.4012e-01, -7.9132e-01, -5.3775e-02,  3.0912e-01],
        [ 5.4679e-02,  1.2033e-01,  5.5010e-01, -2.1675e-01,  1.8962e-01,
          1.4196e+00, -6.1947e-01, -4.7621e-01, -1.6353e-02,  1.6561e-01],
        [-1.3251e-01,  2.2952e-01,  7.8705e-02, -5.5674e-02, -2.3890e-01,
          1.4795e+00, -3.7282e-01, -4.1435e-01, -2.7824e-02,  2.5498e-01],
        [ 3.2799e-01,  3.6230e-01,  2.8211e-01, -3.4568e-01,  1.2736e-01,
          1.6284e+00, -8.5221e-01, -9.3031e-01,  1.6294e-01,  1.5612e-01],
        [ 1.5120e-01,  4.4842e-01, -6.5732e-02, -2.6165e-01, -4.4591e-01,
          1.2480e+00, -5.8480e-01, -6.7705e-01,  5.0070e-02,  4.1462e-01],
        [ 2.5941e-01,  1.5039e-01,  3.4162e-01, -1.6082e-01,  1.1584e-01,
          9.9883e-01, -1.6138e-01, -2.3735e-01,  1.6819e-01,  8.3165e-02],
        [ 9.7301e-02,  1.7675e-01,  2.1541e-01, -2.5284e-01, -5.8063e-02,
          1.2088e+00, -4.0502e-01, -4.6500e-01,  2.0049e-01,  2.5474e-01],
        [ 1.5557e-01,  2.9377e-01,  2.9872e-01, -2.9560e-01,  1.6302e-02,
          1.2392e+00, -3.6792e-01, -3.8486e-01,  3.3145e-03,  1.3051e-01],
        [-1.4517e-02,  4.0338e-01,  3.8239e-01, -2.7553e-02, -2.2460e-01,
          1.2053e+00, -6.0356e-01, -4.8165e-01, -7.0689e-02,  7.2047e-02],
        [ 2.5855e-01,  1.9397e-01,  3.7565e-01, -1.7862e-01, -2.1897e-01,
          1.4615e+00, -2.4605e-01, -4.0599e-01, -6.5496e-02,  4.1980e-01],
        [ 1.1353e-01,  2.8126e-01,  1.5932e-01, -2.1406e-01, -1.5724e-01,
          1.5664e+00, -5.1185e-01, -3.9302e-01,  8.6804e-02, -2.6353e-01],
        [ 2.5203e-01,  2.6469e-01,  3.0814e-01, -2.5936e-01, -2.2933e-02,
          1.2072e+00, -6.2034e-01, -5.6641e-01,  1.0819e-01,  3.4972e-01],
        [ 6.9125e-02, -4.0619e-02,  5.3180e-01, -3.6123e-01,  4.5470e-02,
          1.2326e+00, -4.4809e-01, -5.0835e-01,  1.2995e-02,  3.5236e-01],
        [ 1.1890e-01,  3.3579e-01,  3.1133e-01, -1.1503e-01,  1.0839e-01,
          1.2982e+00, -2.7252e-01, -5.2773e-01,  5.4794e-02,  3.4383e-01],
        [ 1.9802e-01,  1.7839e-01,  3.1203e-01,  6.1143e-02,  2.0625e-01,
          1.1718e+00, -3.0048e-01, -2.2619e-01, -1.8797e-03,  1.2042e-01],
        [-5.6879e-02,  2.7141e-01,  1.3670e-01, -2.2650e-01, -5.0313e-01,
          1.6051e+00, -3.7560e-01, -5.6454e-01,  1.8297e-01,  1.3465e-01],
        [-7.6703e-03,  2.3027e-01,  4.3470e-01, -3.1562e-01,  8.2536e-02,
          1.1160e+00, -3.5722e-01, -2.7204e-01,  2.7094e-02,  8.5756e-02],
        [ 3.7051e-01,  3.1679e-01,  4.1131e-01, -2.1979e-01, -1.4215e-01,
          1.1403e+00, -5.5871e-01, -4.0090e-01, -2.8473e-01,  1.0994e-01],
        [ 2.9825e-01,  1.7767e-02,  1.9894e-01, -2.8465e-01,  1.1437e-01,
          1.1850e+00, -4.1923e-01, -5.9122e-01,  1.3355e-01,  2.0527e-01],
        [ 6.4205e-02,  2.7452e-01,  6.2708e-01, -2.8645e-01, -2.5567e-01,
          1.6562e+00, -9.4686e-01, -7.5111e-01, -4.2974e-01,  7.5878e-01],
        [ 2.1292e-01,  2.3971e-01,  5.6946e-01,  7.5012e-02,  1.8588e-01,
          1.1659e+00, -3.4311e-01, -4.3503e-01,  8.2092e-02,  7.2072e-02],
        [ 3.5791e-01,  2.6836e-01,  2.1985e-01,  3.1174e-02, -1.5706e-01,
          1.4911e+00, -3.6523e-01, -5.0473e-01, -4.1378e-02,  1.5992e-01],
        [ 2.3075e-01,  2.3626e-01,  2.3610e-01, -1.6208e-01,  1.5536e-01,
          1.0960e+00, -2.7018e-01, -4.2773e-01,  6.7535e-02, -1.2679e-01],
        [-5.1402e-02,  1.5003e-01,  1.5479e-01, -3.5519e-01, -9.1141e-02,
          1.4305e+00, -4.1266e-01, -2.9881e-01,  8.5888e-02,  1.3987e-01],
        [ 1.6726e-01,  4.5721e-02,  3.1002e-01, -2.2101e-01,  1.8981e-01,
          9.8080e-01, -2.5507e-01, -2.0607e-01,  1.3118e-01,  2.3121e-01],
        [ 2.7977e-01,  3.0726e-01,  4.6620e-01, -4.4655e-02,  2.7876e-01,
          1.2339e+00, -2.2690e-01, -3.7866e-01,  1.0197e-01,  7.4713e-02],
        [ 1.9810e-01,  1.5083e-01,  3.9216e-01, -1.3040e-01,  1.1299e-01,
          1.0483e+00, -3.4156e-01, -3.2331e-01, -1.1191e-02,  1.0620e-01],
        [ 3.0039e-02,  3.3063e-01,  3.0953e-01, -3.0368e-01, -2.7499e-01,
          1.2179e+00, -7.1278e-01, -3.3610e-01, -6.5521e-02,  1.7967e-01],
        [ 2.5242e-01,  2.2459e-01,  2.2463e-01, -1.9574e-01, -1.4195e-01,
          1.1495e+00, -1.3306e-01, -4.6822e-01,  1.1651e-01,  1.4979e-01],
        [ 2.5298e-01,  1.5351e-01,  2.7462e-01, -5.7863e-02,  1.1196e-01,
          1.2744e+00, -5.3291e-01, -4.9018e-01,  5.7482e-02,  3.5879e-02],
        [ 9.2136e-02,  3.5282e-01,  3.8863e-01, -2.1617e-01,  2.0477e-01,
          1.2509e+00, -4.0587e-01, -2.6341e-01, -1.7627e-01,  4.9639e-03],
        [ 5.4497e-02,  8.1807e-02,  3.8999e-01, -2.8865e-01,  2.9697e-01,
          1.1604e+00, -4.8267e-01, -3.5891e-01,  4.2475e-02,  3.1852e-01],
        [ 5.4305e-02,  3.5867e-02,  5.5571e-01, -1.6928e-01,  2.4053e-01,
          1.4865e+00, -7.1452e-01, -3.9077e-01, -2.5805e-01,  2.8233e-01],
        [ 7.0277e-02,  4.7092e-02,  3.1820e-01,  5.4395e-02, -2.9378e-02,
          1.2662e+00, -5.9893e-01, -3.5991e-01,  1.2947e-01,  1.7964e-01],
        [ 3.2430e-01,  2.5833e-01,  4.8892e-01, -2.8488e-02,  2.5610e-02,
          1.3486e+00, -3.8707e-01, -1.8637e-01,  1.6695e-02, -9.2365e-02],
        [ 2.9208e-02,  4.2795e-01,  1.7555e-01, -3.3580e-01,  1.5668e-01,
          1.1938e+00,  8.6237e-02, -2.9177e-01,  2.3507e-01,  8.3625e-02],
        [ 2.1215e-01,  1.2284e-01,  5.0417e-01, -4.5153e-02, -4.2472e-02,
          9.8814e-01, -2.9993e-01, -4.3815e-01,  2.5959e-01,  7.2979e-02],
        [ 1.2720e-01,  2.3687e-01,  1.9168e-01,  5.3689e-03,  2.4653e-01,
          1.0696e+00, -1.7816e-01, -3.4429e-01,  2.4424e-01,  3.2480e-02],
        [ 1.2585e-01,  3.3697e-01,  5.0353e-01, -2.0442e-01, -2.0504e-01,
          1.2727e+00, -2.7341e-01, -4.0031e-01,  1.1143e-01,  4.9666e-02],
        [ 2.4770e-01,  4.1453e-01,  2.0200e-01, -1.9286e-01, -1.3688e-01,
          1.5946e+00, -6.9189e-01, -7.4848e-01, -1.9374e-01,  3.8570e-01],
        [ 2.5545e-01,  6.0531e-02,  4.1672e-01, -1.0822e-02, -4.9344e-02,
          1.0182e+00, -3.1523e-01, -2.9110e-01,  2.0793e-01,  1.5904e-01],
        [ 2.1495e-01,  3.1287e-01,  2.5613e-01, -1.2455e-01, -4.5402e-01,
          2.0368e+00, -7.3843e-01, -8.2743e-01,  2.0145e-01,  3.2640e-01],
        [ 6.9287e-02,  2.6426e-01,  4.0255e-01, -3.5324e-01, -7.7669e-02,
          1.5011e+00, -3.1722e-01, -3.8492e-01,  1.9791e-01,  6.6881e-02],
        [ 4.3014e-01,  2.1913e-01,  4.3587e-01, -3.8106e-01, -1.7043e-02,
          1.3654e+00, -9.7534e-01, -9.3861e-01, -1.4825e-02,  2.4711e-01],
        [ 1.2868e-02,  3.5548e-01,  3.6141e-01, -9.5127e-02, -5.9168e-02,
          1.1134e+00, -2.1337e-01, -4.6804e-01,  1.0559e-01,  1.4061e-01],
        [ 2.2644e-01,  6.6364e-02,  1.6577e-01, -1.4014e-01,  1.9330e-01,
          1.1375e+00, -1.5182e-01, -1.7748e-01,  1.1330e-01,  4.5344e-01],
        [ 9.9743e-02,  1.3200e-01,  2.4163e-01, -9.7145e-02,  1.1337e-01,
          1.1274e+00, -4.5815e-01, -2.4230e-01,  8.6584e-02,  1.7023e-01],
        [ 1.8210e-01,  3.5652e-01,  7.1264e-02, -3.5198e-01,  2.7494e-01,
          1.4636e+00, -3.1597e-01, -4.1631e-01, -6.7769e-03,  3.1744e-01],
        [ 1.2095e-01,  2.2329e-01,  2.9342e-01, -3.4167e-01,  1.7432e-01,
          1.1587e+00, -2.3136e-01, -4.0857e-01,  7.5877e-02,  3.3998e-01],
        [ 1.8669e-01,  4.0263e-01,  3.7590e-01, -1.2288e-01, -1.5549e-01,
          1.6277e+00, -5.1033e-01, -7.8037e-01,  8.8330e-02, -1.7485e-01],
        [ 1.5359e-01,  1.6349e-01,  1.6493e-01, -3.0852e-02, -6.1753e-02,
          1.1739e+00, -2.8502e-01, -3.1759e-01,  1.3900e-01,  3.0063e-01],
        [ 2.5182e-01,  1.4191e-01,  2.9004e-01,  8.4253e-02,  1.4436e-01,
          1.0570e+00, -3.5478e-01, -3.6920e-01,  3.0909e-01,  1.4960e-01],
        [ 2.4659e-01,  2.3738e-01,  4.1760e-01, -1.7789e-01, -2.9096e-02,
          1.2606e+00, -5.3749e-01, -5.4363e-01,  8.2111e-02,  4.1224e-01],
        [ 1.6667e-01,  1.9379e-01,  1.4394e-01, -4.5839e-01, -1.1754e-01,
          1.0460e+00, -4.2272e-01, -5.2371e-01,  4.4582e-02,  2.0928e-01],
        [ 4.9385e-02,  5.3638e-01,  3.8318e-01, -2.6983e-01,  3.7289e-02,
          1.6134e+00, -6.4294e-01, -3.3154e-01, -1.0981e-01,  4.1445e-01],
        [ 2.3605e-01,  1.6505e-01,  3.7427e-01, -2.6307e-01,  1.5285e-01,
          1.1544e+00, -7.0763e-02, -4.1005e-01, -5.3758e-02,  2.3635e-01],
        [ 2.2535e-01,  1.2780e-01,  4.2662e-01,  5.9662e-02,  2.1682e-01,
          1.0587e+00, -2.8860e-01, -2.1128e-01,  3.2210e-01,  2.5141e-01],
        [ 2.6183e-01,  7.1746e-02,  3.9294e-01, -4.7642e-02,  1.4906e-02,
          1.2762e+00, -6.9539e-01, -4.5133e-01, -2.3855e-01,  2.9431e-01],
        [ 2.2646e-01,  1.6020e-01,  2.7477e-01, -1.7641e-01,  9.2595e-03,
          1.4111e+00, -5.0018e-01, -3.7538e-01, -4.9390e-02,  2.7863e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4389, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:15:54,596 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :1511.8974609375MB2025-02-27 17:15:54,605 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters

2025-02-27 17:15:54,606 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1511.8974609375MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 27 in train loader:1511.8974609375
Loader: train. Accuracy: 0.109375
2025-02-27 17:15:54,914 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:15:54,915 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:15:54,917 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:15:54,918 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:15:54,921 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:15:54,922 - DEBUG - [root] 2 instantiated
2025-02-27 17:15:54,923 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:15:54,924 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:15:54,924 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:15:54,925 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:15:54,926 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:15:54,928 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:15:54,932 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:15:54,933 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:15:54,933 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:54,933 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:15:54,934 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:15:54,934 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:15:54,934 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:54,935 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:15:54,935 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:54,935 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :1512.7724609375MB
2025-02-27 17:15:54,941 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:15:54,942 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:15:54,943 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:15:54,959 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:15:54,959 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:15:54,960 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:15:54,960 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:15:54,961 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:15:54,977 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:15:54,979 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:15:54,980 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:15:54,996 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:15:54,999 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:15:54,999 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:15:55,000 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:15:55,001 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:55,001 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:15:55,002 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:15:55,002 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:15:55,003 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:15:55,004 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:15:55,004 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:55,003 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:15:55,005 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:15:55,006 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:15:55,032 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:15:55,032 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:15:55,033 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:15:55,033 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:15:55,034 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:15:55,049 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:15:55,050 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:15:55,050 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:15:55,051 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:15:55,052 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:15:55,053 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:15:55,054 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:15:55,054 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:15:55,055 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:15:55,055 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:15:55,056 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:15:55,057 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:15:55,061 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:15:55,062 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:15:55,063 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:55,063 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:15:55,064 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:15:55,064 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:15:55,065 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:55,065 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:15:55,071 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:15:55,080 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:15:55,081 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:15:55,081 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:15:55,081 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:15:55,082 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:15:55,082 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:15:55,089 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:15:55,091 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:15:55,092 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:15:55,092 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:55,092 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:15:55,092 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:15:55,093 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_sync_barrier'])
2025-02-27 17:15:55,093 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:15:55,093 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:15:55,095 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:15:55,091 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:15:55,105 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:15:55,108 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:15:55,110 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:15:55,134 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :1744.76953125MB
2025-02-27 17:15:55,143 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1744.76953125MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:15:55,147 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:15:55,147 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:15:55,147 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :1744.76953125MB
2025-02-27 17:15:55,149 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:15:55,291 - DEBUG - [0][1] Populating result of type <class 'torch.Tensor'> for 1_submod_0
after processing the work_item.microbatch_id 1 :1976.76953125MB
2025-02-27 17:15:55,300 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :1976.76953125MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:16:11,703 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:16:11,705 - DEBUG - [0][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:11,706 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:16:11,706 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:11,707 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:11,707 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:11,707 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :1976.7724609375MB
2025-02-27 17:16:11,709 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 4.8457e-02,  1.3137e-02,  4.2966e-02, -4.6857e-02,  4.5172e-02,
          2.4991e-02, -8.1456e-03, -5.6785e-02, -2.6140e-02,  6.1993e-02],
        [ 4.1133e-02,  1.5947e-03,  5.0454e-02, -5.5636e-02,  4.2571e-02,
          3.5581e-02, -1.1567e-02, -5.6430e-02, -3.6439e-02,  5.6843e-02],
        [ 3.7870e-02,  8.6573e-03,  4.9848e-02, -5.3128e-02,  4.5379e-02,
          2.3276e-02, -1.3645e-02, -6.4869e-02, -3.6260e-02,  5.6157e-02],
        [ 3.6529e-02, -6.5047e-03,  5.1754e-02, -5.8972e-02,  4.6643e-02,
          1.9798e-02, -1.4752e-02, -5.1685e-02, -3.7174e-02,  5.5248e-02],
        [ 4.5115e-02,  9.9363e-03,  4.6210e-02, -4.7480e-02,  3.8985e-02,
          2.2818e-02, -1.5894e-02, -5.8481e-02, -3.2949e-02,  5.5512e-02],
        [ 3.8339e-02, -6.9676e-03,  5.5901e-02, -6.0997e-02,  5.3292e-02,
          2.2044e-02, -1.0611e-02, -6.1853e-02, -5.2048e-02,  5.5709e-02],
        [ 3.0130e-02,  3.0579e-03,  4.2706e-02, -4.8309e-02,  2.3662e-02,
          1.8974e-02, -2.3750e-03, -6.2176e-02, -2.8734e-02,  6.4676e-02],
        [ 3.8529e-02,  8.8161e-03,  5.1031e-02, -5.2415e-02,  3.1275e-02,
          1.3347e-02, -1.1159e-02, -5.2285e-02, -3.5359e-02,  6.3712e-02],
        [ 3.8250e-02,  1.4120e-03,  5.2316e-02, -5.7437e-02,  4.5821e-02,
          2.1644e-02, -1.4633e-02, -6.5026e-02, -4.6956e-02,  5.3217e-02],
        [ 3.7523e-02, -9.2635e-03,  6.3350e-02, -5.0896e-02,  5.0610e-02,
          2.6505e-02, -1.0805e-02, -5.1319e-02, -4.2276e-02,  5.1938e-02],
        [ 3.6992e-02,  6.0675e-03,  5.3781e-02, -4.9372e-02,  4.2363e-02,
          2.6206e-02, -8.0247e-03, -5.5820e-02, -3.4452e-02,  6.5415e-02],
        [ 4.1113e-02,  5.0600e-04,  5.5307e-02, -4.8129e-02,  4.5044e-02,
          2.3747e-02, -6.8287e-03, -5.6813e-02, -3.5880e-02,  6.8901e-02],
        [ 3.0901e-02,  1.1899e-02,  5.5081e-02, -4.6815e-02,  3.2512e-02,
          3.9567e-02, -2.2500e-03, -6.3097e-02, -4.0985e-02,  6.6632e-02],
        [ 3.3704e-02, -8.1383e-04,  5.5889e-02, -5.7223e-02,  4.5309e-02,
          2.5699e-02, -1.1173e-02, -5.7603e-02, -4.6533e-02,  6.0515e-02],
        [ 4.0879e-02,  1.2897e-02,  4.5891e-02, -4.1685e-02,  3.6362e-02,
          2.3289e-02, -8.3994e-03, -5.7780e-02, -2.9951e-02,  5.9015e-02],
        [ 3.6536e-02,  8.1292e-03,  5.3039e-02, -5.4730e-02,  3.4987e-02,
          2.3244e-02, -2.0143e-03, -5.8004e-02, -3.0546e-02,  6.1955e-02],
        [ 3.4453e-02, -5.4508e-03,  4.7289e-02, -5.1613e-02,  4.3125e-02,
          2.0050e-02, -1.3007e-02, -6.1683e-02, -3.9919e-02,  5.9793e-02],
        [ 3.7724e-02,  7.0733e-03,  4.6043e-02, -4.8849e-02,  2.9731e-02,
          2.8810e-02, -7.7559e-03, -5.3867e-02, -2.0386e-02,  5.8466e-02],
        [ 3.7005e-02,  2.5042e-03,  5.1490e-02, -4.8332e-02,  3.8158e-02,
          2.4643e-02, -1.1405e-02, -6.4862e-02, -3.1554e-02,  6.2742e-02],
        [ 3.5268e-02,  1.9303e-02,  4.7956e-02, -4.3960e-02,  3.0137e-02,
          3.4164e-02, -2.5641e-03, -5.6763e-02, -3.7126e-02,  7.3921e-02],
        [ 4.6335e-02,  1.3302e-02,  4.3251e-02, -4.1142e-02,  4.3283e-02,
          1.4336e-02, -9.9755e-03, -5.2500e-02, -2.6526e-02,  5.8186e-02],
        [ 3.1750e-02,  1.7941e-02,  4.6064e-02, -4.8300e-02,  2.7460e-02,
          2.5430e-02, -3.2209e-03, -5.7970e-02, -3.3761e-02,  7.0834e-02],
        [ 3.4113e-02,  6.0211e-03,  4.8516e-02, -5.1278e-02,  3.9843e-02,
          2.2024e-02, -5.0204e-03, -5.7532e-02, -3.0642e-02,  5.9811e-02],
        [ 4.9669e-02,  1.8054e-02,  4.5425e-02, -3.7979e-02,  4.4148e-02,
          2.3916e-02, -4.6573e-03, -5.7537e-02, -2.4588e-02,  6.3596e-02],
        [ 3.7547e-02,  1.3737e-02,  5.7626e-02, -4.9957e-02,  3.4331e-02,
          3.3691e-02, -1.0400e-03, -6.2155e-02, -3.4970e-02,  7.3310e-02],
        [ 4.0799e-02,  1.5638e-02,  4.1654e-02, -4.2074e-02,  3.1639e-02,
          2.4225e-02, -6.2833e-03, -5.6991e-02, -2.6351e-02,  6.7420e-02],
        [ 3.7626e-02,  9.9955e-03,  5.5763e-02, -4.4338e-02,  3.3325e-02,
          2.9365e-02, -4.3122e-03, -6.1006e-02, -3.3603e-02,  6.3468e-02],
        [ 4.0402e-02,  2.9712e-03,  4.3823e-02, -4.5545e-02,  4.4708e-02,
          2.8339e-02, -9.0898e-03, -6.1662e-02, -3.5707e-02,  5.6667e-02],
        [ 4.2124e-02,  1.5782e-02,  4.8832e-02, -4.9445e-02,  3.4748e-02,
          1.9993e-02, -4.8312e-03, -5.4411e-02, -3.7854e-02,  5.7417e-02],
        [ 4.2128e-02,  1.3293e-02,  4.6975e-02, -4.3642e-02,  4.8280e-02,
          2.5588e-02, -9.7644e-03, -5.7375e-02, -2.6323e-02,  6.1812e-02],
        [ 3.9629e-02, -4.6865e-04,  5.1488e-02, -4.8029e-02,  4.1994e-02,
          1.9893e-02, -7.4968e-03, -5.8339e-02, -3.9186e-02,  6.5850e-02],
        [ 3.7454e-02, -4.4258e-04,  5.0747e-02, -4.4906e-02,  3.9391e-02,
          2.6430e-02, -8.7613e-03, -5.5278e-02, -3.0811e-02,  6.4144e-02],
        [ 3.5982e-02,  1.4468e-02,  4.3137e-02, -4.0219e-02,  3.0376e-02,
          1.9108e-02, -6.9537e-03, -5.4917e-02, -2.5438e-02,  6.6721e-02],
        [ 3.7838e-02,  1.1757e-02,  4.2768e-02, -4.7639e-02,  3.5206e-02,
          2.2134e-02, -5.8947e-03, -5.3026e-02, -2.4783e-02,  6.1466e-02],
        [ 3.6700e-02,  1.7525e-02,  4.4944e-02, -4.0556e-02,  3.5635e-02,
          3.1124e-02, -7.7474e-03, -5.3792e-02, -3.1159e-02,  7.1091e-02],
        [ 3.5573e-02,  3.9837e-03,  5.2734e-02, -5.3011e-02,  3.4617e-02,
          2.5357e-02, -8.3914e-03, -6.2844e-02, -3.0049e-02,  6.7062e-02],
        [ 3.9401e-02,  9.0056e-05,  4.8611e-02, -4.7040e-02,  2.9689e-02,
          2.1582e-02, -1.3189e-02, -5.3062e-02, -1.9813e-02,  5.5030e-02],
        [ 3.7516e-02,  9.8020e-03,  4.8566e-02, -4.8462e-02,  3.1620e-02,
          2.1833e-02, -7.2392e-03, -5.7524e-02, -3.0864e-02,  6.5244e-02],
        [ 3.3281e-02,  1.0447e-02,  4.8750e-02, -4.3144e-02,  2.8970e-02,
          2.7048e-02, -2.6644e-03, -6.0569e-02, -3.1160e-02,  5.7951e-02],
        [ 3.1705e-02,  7.1092e-03,  5.1478e-02, -4.3938e-02,  3.0412e-02,
          3.0389e-02, -8.3680e-03, -5.9256e-02, -3.0198e-02,  6.1721e-02],
        [ 4.3137e-02,  1.2938e-02,  5.0565e-02, -5.2958e-02,  3.1345e-02,
          3.0759e-02, -8.1678e-03, -4.9876e-02, -3.4447e-02,  7.0641e-02],
        [ 3.6745e-02,  2.0283e-03,  5.0020e-02, -5.1455e-02,  2.9080e-02,
          2.7928e-02, -5.1018e-03, -5.6654e-02, -2.9719e-02,  5.9249e-02],
        [ 3.3797e-02,  1.1155e-02,  4.9607e-02, -4.9426e-02,  4.0915e-02,
          2.3796e-02, -8.8649e-03, -6.0592e-02, -3.3383e-02,  6.0934e-02],
        [ 3.7455e-02,  9.4072e-03,  4.9635e-02, -4.5107e-02,  2.8343e-02,
          2.4104e-02, -5.0564e-03, -6.1638e-02, -3.1835e-02,  6.3780e-02],
        [ 3.4250e-02,  1.8069e-03,  4.9448e-02, -5.0901e-02,  3.7105e-02,
          1.7695e-02, -8.2806e-03, -5.8264e-02, -3.3780e-02,  5.7575e-02],
        [ 3.1516e-02,  1.1575e-02,  4.5987e-02, -4.7120e-02,  2.5514e-02,
          1.9859e-02,  3.0979e-03, -5.5151e-02, -3.1544e-02,  6.3606e-02],
        [ 3.4898e-02,  1.4781e-02,  4.9877e-02, -4.1933e-02,  2.8126e-02,
          1.9699e-02, -6.6598e-04, -5.5911e-02, -3.0760e-02,  6.5795e-02],
        [ 3.6888e-02, -5.2800e-03,  5.6399e-02, -5.2036e-02,  4.4284e-02,
          3.9930e-02, -1.3447e-02, -6.2602e-02, -4.4006e-02,  6.5545e-02],
        [ 4.2251e-02,  1.4293e-02,  4.9457e-02, -5.5848e-02,  2.7844e-02,
          2.6956e-02, -7.1989e-03, -5.2409e-02, -3.4197e-02,  6.3627e-02],
        [ 3.9801e-02, -6.2131e-04,  5.3406e-02, -5.8781e-02,  5.3515e-02,
          2.0269e-02, -7.9492e-03, -6.2493e-02, -4.8014e-02,  5.3759e-02],
        [ 3.5693e-02,  6.6794e-03,  5.0195e-02, -5.5482e-02,  4.8270e-02,
          2.0081e-02, -1.2552e-02, -5.9450e-02, -3.8942e-02,  5.7462e-02],
        [ 4.1433e-02,  3.8872e-03,  5.0575e-02, -4.6834e-02,  4.7498e-02,
          2.8736e-02, -6.1300e-03, -6.1510e-02, -3.5285e-02,  5.9140e-02],
        [ 3.6412e-02,  5.5283e-03,  5.1918e-02, -4.9607e-02,  3.6601e-02,
          2.8644e-02, -4.2245e-03, -5.8127e-02, -3.0551e-02,  5.8122e-02],
        [ 3.6597e-02,  4.1191e-03,  5.0719e-02, -4.8197e-02,  3.0181e-02,
          2.5672e-02, -5.0270e-03, -5.7488e-02, -2.6450e-02,  5.8565e-02],
        [ 4.4568e-02,  5.1194e-03,  4.6399e-02, -4.7886e-02,  3.4532e-02,
          3.2650e-02, -7.3688e-03, -4.9066e-02, -2.5767e-02,  6.0826e-02],
        [ 3.7694e-02, -3.0383e-03,  5.8473e-02, -4.8750e-02,  3.4081e-02,
          2.3547e-02, -6.9867e-03, -5.1863e-02, -3.4877e-02,  5.6297e-02],
        [ 4.3732e-02,  1.0535e-02,  4.4638e-02, -4.2497e-02,  3.3779e-02,
          2.0929e-02, -5.0957e-03, -5.3147e-02, -2.5651e-02,  5.9224e-02],
        [ 4.3489e-02,  9.6155e-03,  4.8340e-02, -3.8938e-02,  3.7571e-02,
          2.9680e-02, -9.6154e-03, -5.5358e-02, -2.3879e-02,  5.6049e-02],
        [ 4.3632e-02,  1.1054e-02,  4.5710e-02, -4.8172e-02,  4.2264e-02,
          1.9751e-02, -7.0676e-03, -5.3088e-02, -3.1326e-02,  5.8102e-02],
        [ 4.0273e-02,  1.5365e-02,  4.1356e-02, -4.5029e-02,  3.8152e-02,
          1.8467e-02, -1.0430e-02, -5.7405e-02, -2.6822e-02,  6.3544e-02],
        [ 3.9227e-02,  1.4529e-02,  4.4565e-02, -4.0825e-02,  3.4339e-02,
          2.4152e-02, -4.4604e-03, -5.6471e-02, -2.5961e-02,  6.8584e-02],
        [ 3.5941e-02,  1.6999e-02,  5.2761e-02, -4.2035e-02,  3.2553e-02,
          2.7624e-02, -2.3522e-03, -5.9825e-02, -2.9248e-02,  6.7785e-02],
        [ 3.6350e-02,  5.2611e-03,  5.4779e-02, -4.6881e-02,  3.9355e-02,
          2.4260e-02, -4.7693e-03, -5.9429e-02, -3.7007e-02,  6.0484e-02],
        [ 4.7365e-02,  1.1747e-02,  3.9753e-02, -3.6848e-02,  3.9790e-02,
          2.3913e-02, -8.1525e-03, -4.9685e-02, -2.0301e-02,  6.0918e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3053, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:16:11,802 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :1976.775390625MB
2025-02-27 17:16:11,811 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1976.775390625MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:16:27,734 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:16:27,735 - DEBUG - [0][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:27,736 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:16:27,736 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:27,736 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:27,736 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:27,737 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :1976.7783203125MB
2025-02-27 17:16:27,738 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0490,  0.0161,  0.0444, -0.0451,  0.0503,  0.0190, -0.0119, -0.0558,
         -0.0278,  0.0587],
        [ 0.0408,  0.0175,  0.0469, -0.0429,  0.0401,  0.0304, -0.0072, -0.0546,
         -0.0341,  0.0653],
        [ 0.0376,  0.0146,  0.0506, -0.0511,  0.0320,  0.0192, -0.0081, -0.0565,
         -0.0334,  0.0626],
        [ 0.0348, -0.0054,  0.0625, -0.0629,  0.0519,  0.0277, -0.0099, -0.0620,
         -0.0511,  0.0606],
        [ 0.0404,  0.0048,  0.0481, -0.0481,  0.0463,  0.0255, -0.0128, -0.0571,
         -0.0314,  0.0632],
        [ 0.0425,  0.0079,  0.0433, -0.0476,  0.0423,  0.0251, -0.0066, -0.0563,
         -0.0265,  0.0591],
        [ 0.0276,  0.0163,  0.0430, -0.0494,  0.0312,  0.0300, -0.0088, -0.0569,
         -0.0247,  0.0697],
        [ 0.0330,  0.0074,  0.0455, -0.0473,  0.0348,  0.0283, -0.0111, -0.0595,
         -0.0329,  0.0606],
        [ 0.0365,  0.0154,  0.0493, -0.0474,  0.0304,  0.0298, -0.0069, -0.0584,
         -0.0362,  0.0693],
        [ 0.0352,  0.0207,  0.0472, -0.0409,  0.0320,  0.0275, -0.0038, -0.0571,
         -0.0320,  0.0716],
        [ 0.0375,  0.0111,  0.0485, -0.0480,  0.0266,  0.0227, -0.0065, -0.0550,
         -0.0299,  0.0673],
        [ 0.0372,  0.0075,  0.0477, -0.0514,  0.0316,  0.0260, -0.0091, -0.0539,
         -0.0305,  0.0595],
        [ 0.0459,  0.0093,  0.0489, -0.0440,  0.0465,  0.0207, -0.0088, -0.0560,
         -0.0273,  0.0593],
        [ 0.0353, -0.0054,  0.0510, -0.0543,  0.0487,  0.0250, -0.0112, -0.0591,
         -0.0458,  0.0553],
        [ 0.0387,  0.0105,  0.0477, -0.0510,  0.0321,  0.0285, -0.0047, -0.0564,
         -0.0241,  0.0676],
        [ 0.0483,  0.0165,  0.0459, -0.0421,  0.0369,  0.0304, -0.0049, -0.0559,
         -0.0248,  0.0679],
        [ 0.0377,  0.0010,  0.0554, -0.0537,  0.0491,  0.0289, -0.0110, -0.0622,
         -0.0478,  0.0600],
        [ 0.0335,  0.0039,  0.0523, -0.0529,  0.0432,  0.0270, -0.0079, -0.0527,
         -0.0359,  0.0583],
        [ 0.0378,  0.0120,  0.0452, -0.0442,  0.0344,  0.0296, -0.0073, -0.0585,
         -0.0332,  0.0622],
        [ 0.0412,  0.0144,  0.0415, -0.0443,  0.0397,  0.0286, -0.0092, -0.0551,
         -0.0264,  0.0670],
        [ 0.0434,  0.0122,  0.0490, -0.0516,  0.0459,  0.0185, -0.0133, -0.0602,
         -0.0325,  0.0587],
        [ 0.0321,  0.0128,  0.0512, -0.0442,  0.0353,  0.0327, -0.0031, -0.0604,
         -0.0393,  0.0662],
        [ 0.0416,  0.0064,  0.0513, -0.0535,  0.0410,  0.0251, -0.0099, -0.0552,
         -0.0340,  0.0566],
        [ 0.0394,  0.0157,  0.0542, -0.0540,  0.0500,  0.0229, -0.0132, -0.0608,
         -0.0376,  0.0541],
        [ 0.0470,  0.0097,  0.0475, -0.0525,  0.0330,  0.0249, -0.0083, -0.0564,
         -0.0300,  0.0614],
        [ 0.0303, -0.0032,  0.0547, -0.0568,  0.0363,  0.0291, -0.0116, -0.0602,
         -0.0378,  0.0525],
        [ 0.0417,  0.0099,  0.0491, -0.0500,  0.0486,  0.0236, -0.0103, -0.0555,
         -0.0346,  0.0610],
        [ 0.0408,  0.0042,  0.0594, -0.0493,  0.0383,  0.0233, -0.0040, -0.0571,
         -0.0333,  0.0593],
        [ 0.0377,  0.0100,  0.0493, -0.0358,  0.0335,  0.0270, -0.0046, -0.0579,
         -0.0267,  0.0672],
        [ 0.0457,  0.0148,  0.0424, -0.0417,  0.0458,  0.0230, -0.0093, -0.0517,
         -0.0262,  0.0594],
        [ 0.0415,  0.0122,  0.0445, -0.0453,  0.0381,  0.0192, -0.0079, -0.0551,
         -0.0262,  0.0550],
        [ 0.0481,  0.0088,  0.0444, -0.0395,  0.0423,  0.0289, -0.0054, -0.0558,
         -0.0242,  0.0619],
        [ 0.0403,  0.0024,  0.0556, -0.0567,  0.0532,  0.0228, -0.0088, -0.0665,
         -0.0470,  0.0582],
        [ 0.0399,  0.0089,  0.0484, -0.0507,  0.0389,  0.0229, -0.0045, -0.0591,
         -0.0269,  0.0577],
        [ 0.0406, -0.0033,  0.0502, -0.0563,  0.0446,  0.0224, -0.0035, -0.0535,
         -0.0371,  0.0661],
        [ 0.0349, -0.0024,  0.0573, -0.0584,  0.0509,  0.0198, -0.0127, -0.0687,
         -0.0481,  0.0569],
        [ 0.0397,  0.0115,  0.0472, -0.0481,  0.0275,  0.0238, -0.0056, -0.0559,
         -0.0289,  0.0624],
        [ 0.0375,  0.0061,  0.0484, -0.0420,  0.0330,  0.0256, -0.0123, -0.0551,
         -0.0282,  0.0549],
        [ 0.0496,  0.0154,  0.0406, -0.0379,  0.0414,  0.0280, -0.0099, -0.0538,
         -0.0219,  0.0624],
        [ 0.0442,  0.0176,  0.0412, -0.0397,  0.0453,  0.0331, -0.0058, -0.0525,
         -0.0248,  0.0658],
        [ 0.0313,  0.0123,  0.0550, -0.0483,  0.0398,  0.0216, -0.0113, -0.0546,
         -0.0329,  0.0524],
        [ 0.0409,  0.0141,  0.0482, -0.0444,  0.0246,  0.0226, -0.0073, -0.0541,
         -0.0253,  0.0676],
        [ 0.0356, -0.0001,  0.0507, -0.0564,  0.0363,  0.0222, -0.0085, -0.0545,
         -0.0374,  0.0624],
        [ 0.0418,  0.0128,  0.0455, -0.0420,  0.0393,  0.0277, -0.0078, -0.0565,
         -0.0267,  0.0611],
        [ 0.0396,  0.0125,  0.0457, -0.0508,  0.0349,  0.0291, -0.0030, -0.0551,
         -0.0288,  0.0619],
        [ 0.0408,  0.0125,  0.0478, -0.0462,  0.0413,  0.0223, -0.0113, -0.0564,
         -0.0255,  0.0574],
        [ 0.0347, -0.0051,  0.0494, -0.0537,  0.0460,  0.0212, -0.0123, -0.0636,
         -0.0437,  0.0565],
        [ 0.0443,  0.0150,  0.0413, -0.0390,  0.0423,  0.0231, -0.0102, -0.0535,
         -0.0203,  0.0638],
        [ 0.0384, -0.0032,  0.0467, -0.0509,  0.0378,  0.0254, -0.0113, -0.0551,
         -0.0350,  0.0594],
        [ 0.0392,  0.0100,  0.0440, -0.0405,  0.0390,  0.0220, -0.0040, -0.0499,
         -0.0230,  0.0580],
        [ 0.0401,  0.0165,  0.0491, -0.0449,  0.0416,  0.0279, -0.0119, -0.0629,
         -0.0342,  0.0576],
        [ 0.0376,  0.0041,  0.0503, -0.0519,  0.0439,  0.0264, -0.0085, -0.0572,
         -0.0344,  0.0652],
        [ 0.0615,  0.0056,  0.0557, -0.0568,  0.0325,  0.0317, -0.0255, -0.0455,
         -0.0186,  0.0425],
        [ 0.0411, -0.0067,  0.0536, -0.0514,  0.0455,  0.0292, -0.0093, -0.0560,
         -0.0363,  0.0620],
        [ 0.0403,  0.0079,  0.0481, -0.0460,  0.0425,  0.0216, -0.0103, -0.0547,
         -0.0338,  0.0548],
        [ 0.0417,  0.0036,  0.0456, -0.0527,  0.0471,  0.0254, -0.0129, -0.0524,
         -0.0335,  0.0643],
        [ 0.0430,  0.0146,  0.0449, -0.0425,  0.0402,  0.0280, -0.0097, -0.0584,
         -0.0271,  0.0681],
        [ 0.0427,  0.0035,  0.0473, -0.0470,  0.0278,  0.0282, -0.0031, -0.0520,
         -0.0313,  0.0612],
        [ 0.0374, -0.0004,  0.0544, -0.0552,  0.0444,  0.0239, -0.0140, -0.0630,
         -0.0388,  0.0555],
        [ 0.0434,  0.0136,  0.0467, -0.0482,  0.0391,  0.0277, -0.0065, -0.0549,
         -0.0291,  0.0625],
        [ 0.0407,  0.0020,  0.0518, -0.0584,  0.0513,  0.0261, -0.0111, -0.0658,
         -0.0466,  0.0594],
        [ 0.0355,  0.0059,  0.0501, -0.0606,  0.0370,  0.0287, -0.0111, -0.0603,
         -0.0407,  0.0606],
        [ 0.0361,  0.0161,  0.0467, -0.0453,  0.0282,  0.0264, -0.0069, -0.0562,
         -0.0293,  0.0690],
        [ 0.0395,  0.0115,  0.0497, -0.0477,  0.0356,  0.0306, -0.0056, -0.0601,
         -0.0329,  0.0640]], device='cuda:0', requires_grad=True), 'loss': tensor(2.3056, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:16:27,820 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
after processing the work_item.microbatch_id 1 :1976.7783203125MB2025-02-27 17:16:27,829 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters

2025-02-27 17:16:27,830 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :1976.783203125MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 0 in valid loader:1976.7666015625
Loader: valid. Accuracy: 0.1015625
GPU End of epoch 5:1976.7666015625
[31mSwitching template...[0m
2025-02-27 17:16:27,835 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
2025-02-27 17:16:27,837 - INFO - [0] Instantiating RankWorker
Inital rank worker:1976.7666015625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0after initialization :1976.7666015625MB

2025-02-27 17:16:27,837 - INFO - [root] Sending stage_id = 1 mod to worker
[32mCurrent descr name: submod_1, stage_id: 1, rank: 0[0m
2025-02-27 17:16:27,900 - INFO - [root] Sending stage_id = 0 mod to worker
2025-02-27 17:16:27,956 - INFO - Instantiating PipeStageExecutor for stage 1
[32mCurrent descr name: submod_0, stage_id: 0, rank: 1[0m
[31mSwitch template complete![0m
[31mTime taken to switch template: 5.432577133178711 seconds[0m
Epoch: 6
GPU Start of epoch 6:2016.85009765625
2025-02-27 17:16:34,360 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:16:34,361 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:16:34,363 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:16:34,363 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:16:34,364 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:16:34,365 - DEBUG - [root] 2 instantiated
2025-02-27 17:16:34,365 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:16:34,365 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:16:34,365 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:16:34,366 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:16:34,366 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:16:34,366 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:16:34,374 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:16:34,375 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:16:34,381 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:16:34,381 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:16:34,381 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:16:34,382 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:16:34,382 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:16:34,382 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:16:34,384 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:16:34,384 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:34,384 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:16:34,385 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,385 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:16:34,385 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:34,385 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:16:34,387 - DEBUG - [1] Received getitem call: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:16:34,391 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:16:34,391 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:16:34,395 - DEBUG - [1] Received getitem call: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:16:34,404 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:16:34,405 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:16:34,411 - DEBUG - [1][0] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:16:34,412 - DEBUG - [1][0] Invoke call found 3 ValueReference arguments
2025-02-27 17:16:34,412 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:16:34,412 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:34,413 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:16:34,413 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 0_stage_backward
2025-02-27 17:16:34,414 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:16:34,414 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,414 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:16:34,415 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:16:34,415 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:16:34,415 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:34,416 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:16:34,416 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:16:34,416 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:16:34,417 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:16:34,420 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:16:34,421 - DEBUG - [1] Received getitem call: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:16:34,424 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:16:34,425 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:16:34,426 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:16:34,426 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:16:34,428 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:16:34,430 - DEBUG - [1] Received getitem call: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:16:34,431 - DEBUG - [1] Received getitem call: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:16:34,434 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:16:34,435 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:16:34,436 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:16:34,437 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:16:34,437 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:34,442 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:16:34,443 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:16:34,443 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:16:34,444 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,444 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:16:34,445 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward'])
2025-02-27 17:16:34,446 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:34,446 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:16:34,447 - DEBUG - [1] Received getitem call: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:16:34,448 - DEBUG - [1] Received getitem call: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:16:34,458 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:16:34,458 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:16:34,465 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:16:34,466 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:16:34,466 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:16:34,466 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:16:34,467 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:16:34,467 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:16:34,472 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:16:34,472 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:16:34,479 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:16:34,479 - DEBUG - [1][1] Received invoke call for %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:16:34,480 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:16:34,480 - DEBUG - [1][1] Invoke call found 3 ValueReference arguments
2025-02-27 17:16:34,480 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:16:34,481 - INFO - Created WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:34,481 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:16:34,482 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})) with key 1_stage_backward
2025-02-27 17:16:34,482 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:16:34,482 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,483 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:16:34,483 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1'])
2025-02-27 17:16:34,483 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:16:34,483 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:34,484 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:16:34,484 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1
2025-02-27 17:16:34,486 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
2025-02-27 17:16:34,490 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
2025-02-27 17:16:34,492 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:16:34,492 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:16:34,493 - DEBUG - [1] Received getitem call: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:16:34,500 - DEBUG - [1] Received getitem call: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:16:34,496 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:16:34,501 - DEBUG - [1] Received getitem call: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:16:34,495 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_stage_backward, i.e. from stage 1 to 1
2025-02-27 17:16:34,504 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:16:34,505 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:16:34,506 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:16:34,507 - DEBUG - [1][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:16:34,507 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:34,507 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:16:34,509 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,509 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward'])
2025-02-27 17:16:34,509 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:34,509 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:16:34,516 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,517 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:16:34,518 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:16:34,519 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:16:34,519 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:16:34,519 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:16:34,519 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:16:34,520 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:16:34,525 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,526 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:16:34,527 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:16:34,527 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:16:34,529 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:16:34,531 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:16:34,531 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:16:34,531 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_3) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,532 - DEBUG - [1][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:16:34,533 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:34,533 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:16:34,534 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:16:34,535 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:16:34,535 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '0_stage_backward', '1_submod_1', '1_stage_backward', '0_sync_barrier'])
2025-02-27 17:16:34,537 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:16:34,537 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:16:34,537 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:16:34,538 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:16:34,539 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:16:34,540 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,541 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:16:34,532 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:16:34,543 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,544 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:16:34,544 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_3) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:16:34,546 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:16:34,545 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:16:40,584 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_4) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:16:40,585 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_4) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 1 to 0
2025-02-27 17:16:42,652 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:42,653 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:16:42,653 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:42,653 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:42,654 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:42,655 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :2048.72900390625MB
2025-02-27 17:16:42,656 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:16:42,751 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
2025-02-27 17:16:42,759 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_stage_backward arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:16:42,760 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:16:42,761 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:16:42,764 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
after processing the work_item.microbatch_id 0 :2111.02001953125MB
2025-02-27 17:16:42,769 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :2111.02001953125MB
All workitem count at loop begining: 5, current work item in ready runlist: 0, current work item in waiting runlist: 5
2025-02-27 17:16:43,959 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:43,959 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:16:43,960 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:43,960 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:43,960 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:16:43,961 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :2111.02001953125MB
2025-02-27 17:16:43,962 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:16:44,055 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
2025-02-27 17:16:44,061 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_stage_backward arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
2025-02-27 17:16:44,062 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_stage_backward arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:16:44,065 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(4) should be 0
after processing the work_item.microbatch_id 1 :2165.18603515625MB
2025-02-27 17:16:44,071 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :2165.18603515625MB
All workitem count at loop begining: 4, current work item in ready runlist: 0, current work item in waiting runlist: 4
2025-02-27 17:16:44,083 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(3) should be 0
2025-02-27 17:16:47,783 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:47,784 - DEBUG - [0][0] all operands ready: 0_stage_backward
2025-02-27 17:16:47,784 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:47,785 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:47,786 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:47,786 - DEBUG - [0][0] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 0 :2165.18603515625MB
2025-02-27 17:16:47,787 - DEBUG - [0][0] Running backward phase. Retrieving stashed values
2025-02-27 17:16:47,788 - INFO - [0] Running backward for microbatch 0
2025-02-27 17:16:47,845 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_stage_backward
2025-02-27 17:16:47,855 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
after processing the work_item.microbatch_id 0 :2160.078125MB
2025-02-27 17:16:47,858 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :2160.078125MB
All workitem count at loop begining: 3, current work item in ready runlist: 0, current work item in waiting runlist: 3
2025-02-27 17:16:54,619 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward arg_idx 2 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:16:54,619 - DEBUG - [0][1] all operands ready: 1_stage_backward
2025-02-27 17:16:54,620 - INFO - WorkItem is ready: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:54,620 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:16:54,620 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
2025-02-27 17:16:54,620 - DEBUG - [0][1] Got WorkItem WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
before processing the work_item.microbatch_id 1 :2160.078125MB
2025-02-27 17:16:54,622 - DEBUG - [0][1] Running backward phase. Retrieving stashed values
2025-02-27 17:16:54,622 - INFO - [0] Running backward for microbatch 1
2025-02-27 17:16:55,235 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_stage_backward
2025-02-27 17:16:55,260 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(2) should be 0
after processing the work_item.microbatch_id 1 :2105.91357421875MB
2025-02-27 17:16:55,265 - INFO - Released WorkItem: WorkItem(%stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})}))
Periodic memory cleanup :2105.91357421875MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:17:10,829 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:17:10,831 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:10,831 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:17:10,831 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:10,832 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:10,832 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:10,832 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :2105.91357421875MB
2025-02-27 17:17:10,835 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 1.1789e-01,  2.9532e-02,  4.4193e-01, -4.3214e-02,  5.1914e-02,
          1.0369e+00, -4.4694e-01, -4.5079e-01,  2.4230e-01,  8.3442e-02],
        [-9.9693e-02,  2.1613e-01,  2.9205e-01, -2.3850e-01,  4.8911e-02,
          1.3736e+00, -4.9714e-01, -5.2306e-01,  1.2664e-01,  1.4731e-01],
        [ 1.8374e-02,  2.9515e-01,  4.0129e-01, -2.1306e-01, -1.4654e-01,
          1.3164e+00, -6.2280e-01, -3.5743e-01, -2.8969e-01,  3.6378e-01],
        [ 2.3288e-01,  1.0707e-01,  4.8611e-01, -2.3766e-01, -2.2377e-01,
          1.2602e+00, -3.5308e-01, -5.7191e-01, -2.0051e-01,  8.2994e-02],
        [ 1.7900e-03,  3.8550e-01,  2.3944e-01, -1.7397e-01, -1.1480e-01,
          1.3400e+00, -6.4677e-01, -3.5902e-01,  6.1087e-02, -8.4686e-02],
        [ 5.7506e-03,  3.4702e-01,  2.5894e-01, -3.8262e-01, -1.6323e-01,
          1.1231e+00, -5.6050e-01, -3.9755e-01,  1.0008e-01,  6.2551e-02],
        [ 3.6574e-01,  1.9138e-01,  2.3817e-01,  2.6191e-02,  1.5616e-01,
          1.0946e+00, -2.8922e-01, -3.5665e-01,  2.6086e-01, -1.9277e-03],
        [ 1.9331e-01,  3.1548e-01, -2.4450e-01, -1.6791e-01,  9.6300e-02,
          1.8105e+00, -6.7625e-01, -8.1273e-01, -1.0300e-01,  1.8367e-01],
        [ 5.3639e-01,  4.3059e-01,  8.9098e-02, -2.9925e-01, -3.1579e-02,
          1.6955e+00, -5.6438e-01, -7.6087e-01,  4.0740e-02,  1.8068e-01],
        [-7.5900e-02,  2.7997e-01,  3.3960e-01, -1.9927e-01,  6.0107e-02,
          1.4052e+00, -6.5601e-01, -4.4192e-01, -2.9969e-01,  3.5370e-02],
        [ 2.5164e-01,  1.5511e-01,  4.5305e-01, -8.5763e-02, -2.3346e-02,
          9.2267e-01, -2.7053e-01, -2.2722e-01, -1.5672e-01,  2.2801e-01],
        [ 1.8520e-01,  1.0197e-01,  4.2160e-01, -3.0673e-01, -1.9568e-01,
          1.4740e+00, -6.0876e-01, -5.5826e-01,  9.4889e-02,  2.6419e-01],
        [ 2.0180e-01,  2.0606e-01,  3.6430e-01, -6.7052e-02,  2.6480e-01,
          1.3656e+00, -5.5162e-01, -4.6165e-01, -3.1205e-02,  4.1111e-01],
        [ 2.4899e-01,  6.8614e-02,  4.1267e-01, -3.0752e-01, -7.1833e-02,
          1.4812e+00, -6.6432e-01, -6.3514e-01,  2.5401e-01,  4.6362e-01],
        [ 5.1995e-01,  3.9710e-01,  1.4756e-01, -3.7436e-01, -9.2850e-02,
          1.5720e+00, -3.5632e-01, -4.4783e-01, -6.2815e-02,  1.1715e-01],
        [-9.4731e-02,  1.5380e-01,  2.9083e-01, -1.1750e-01, -2.3115e-01,
          1.5084e+00, -9.1407e-01, -6.2589e-01, -2.0116e-03,  3.6338e-01],
        [ 2.1244e-01,  3.3315e-01, -3.7533e-02, -2.6801e-01, -3.7531e-03,
          1.4216e+00, -4.0501e-01, -5.4551e-01,  7.4609e-02,  1.2353e-01],
        [ 1.1786e-01,  1.3183e-01,  4.4735e-01, -1.0035e-01,  2.5014e-01,
          1.0433e+00, -7.6816e-02, -3.0839e-01,  2.4500e-01,  2.4242e-01],
        [ 1.4684e-01,  2.0763e-01,  5.2892e-01, -2.8063e-01,  1.9803e-01,
          1.0628e+00, -3.5166e-01, -3.8146e-01,  1.6367e-01, -4.8003e-02],
        [ 5.4152e-02,  3.2424e-01,  1.7606e-01, -1.3160e-01,  1.7979e-02,
          1.2899e+00, -5.5393e-01, -4.4801e-01, -9.6419e-02,  2.2757e-01],
        [ 4.6406e-02,  3.9480e-01,  2.3252e-01, -2.1429e-01, -5.7555e-01,
          1.4752e+00, -9.5502e-01, -6.2194e-01,  2.4074e-02,  1.9675e-01],
        [ 2.2409e-01, -1.1278e-02,  3.4738e-01, -5.8954e-02,  6.5464e-02,
          1.1519e+00, -2.4044e-01, -3.0873e-01, -2.1654e-01,  1.3822e-01],
        [ 3.6507e-01,  3.7589e-01,  5.8051e-01, -2.3878e-01,  1.1044e-01,
          1.1239e+00, -6.0349e-01, -7.3502e-01,  6.0253e-02,  5.2535e-01],
        [ 2.4698e-02,  1.9545e-01,  3.2111e-01,  3.7579e-02,  2.0976e-01,
          1.0064e+00, -1.4972e-01, -3.0644e-01,  1.6334e-01,  3.1563e-01],
        [ 1.5121e-01,  3.3606e-01,  2.9471e-01, -1.3718e-01,  1.3278e-01,
          1.0037e+00, -1.7511e-01, -2.9075e-01, -4.5209e-02,  2.9100e-01],
        [ 8.3257e-02,  1.2663e-01,  5.3831e-01, -1.7731e-01,  9.1846e-03,
          1.4110e+00, -6.9017e-01, -5.2969e-01,  1.3296e-01,  4.1077e-01],
        [ 5.1483e-01,  3.0602e-02,  2.6260e-01, -1.8698e-01, -9.4433e-02,
          1.3643e+00, -6.3843e-01, -2.6687e-01,  1.0682e-01,  1.0561e-01],
        [ 3.4713e-01,  1.1440e-01,  3.1340e-01, -3.0120e-01, -1.5022e-02,
          1.4260e+00, -4.6137e-01, -2.8036e-01, -5.5554e-02,  2.9145e-01],
        [ 7.9865e-02,  7.9902e-02,  3.8123e-01, -3.9174e-01,  6.8184e-02,
          1.3498e+00, -4.9324e-01, -2.9573e-01, -1.1970e-01,  2.0769e-01],
        [-5.9382e-02,  2.7675e-01,  4.8761e-01, -6.5515e-02,  1.3979e-01,
          1.0960e+00, -1.8611e-01, -4.5288e-01,  8.3114e-02,  8.8727e-02],
        [ 1.3997e-01,  1.1299e-01,  4.4447e-01,  6.2943e-03, -1.1101e-01,
          1.2252e+00, -3.6582e-01, -3.4619e-01,  2.8403e-02,  2.4238e-01],
        [ 6.7619e-02,  6.2682e-01,  3.5419e-01, -1.1954e-04, -1.8516e-01,
          1.4786e+00, -7.5651e-01, -8.1134e-01, -2.2397e-01,  2.8634e-01],
        [ 1.5688e-01,  3.6850e-01,  4.2568e-01, -4.1963e-02, -1.1663e-01,
          1.1611e+00, -2.2030e-01, -2.0459e-01,  8.9106e-02, -1.3262e-02],
        [ 9.8617e-02,  1.5861e-01,  2.4996e-01, -2.7291e-01,  1.0988e-01,
          1.1413e+00, -3.6486e-01, -3.0424e-01,  3.4226e-01,  2.8647e-01],
        [ 8.1318e-02,  3.4846e-01,  4.5161e-01, -2.2017e-01, -2.1348e-02,
          1.1085e+00, -2.9071e-01, -3.5614e-01,  2.3893e-01,  2.9262e-01],
        [ 1.5413e-01,  3.5695e-01,  3.8625e-01,  3.4465e-02,  1.4465e-02,
          1.1530e+00, -3.1203e-01, -2.9446e-01,  1.6190e-01,  3.4765e-01],
        [ 3.0333e-01,  1.9686e-01,  3.4631e-01, -2.1095e-01,  1.2160e-01,
          1.1069e+00, -3.1117e-01, -2.4096e-01, -1.1734e-02,  6.6513e-02],
        [ 1.9727e-01,  8.9972e-02,  2.1625e-01, -2.5695e-01, -3.7187e-01,
          1.6042e+00, -8.1351e-01, -2.0028e-01,  2.2595e-01,  1.6774e-02],
        [ 6.1833e-02,  3.0226e-01,  3.6098e-01, -3.3455e-01,  2.5277e-01,
          1.2879e+00, -2.1756e-01, -4.9161e-01, -4.1740e-03,  2.7312e-01],
        [-3.4651e-02,  8.3086e-04,  4.4414e-01, -2.1818e-01, -5.2809e-03,
          1.0543e+00, -1.7096e-01, -5.1507e-01,  2.4464e-01,  3.0869e-01],
        [-8.8769e-02,  1.2072e-01,  2.5441e-01, -4.3389e-01, -6.9148e-02,
          1.4109e+00, -4.6818e-01, -6.1997e-01,  3.8666e-02,  2.9163e-01],
        [ 1.3375e-01,  2.3385e-01,  4.0373e-01, -1.7280e-01,  1.5699e-01,
          1.2390e+00, -2.6658e-01, -5.0248e-01,  1.9771e-01,  1.5707e-01],
        [ 3.0097e-01,  4.6055e-01,  3.9765e-01, -1.3829e-01,  2.5999e-01,
          9.9853e-01, -1.7603e-01, -2.6376e-01, -6.4910e-02,  1.4940e-01],
        [ 3.4801e-01,  4.1668e-01,  2.0165e-01, -1.0371e-01, -1.6013e-01,
          1.1583e+00, -5.9179e-01, -6.3828e-01,  3.3993e-01,  3.1801e-01],
        [ 1.8741e-01,  1.5979e-01,  1.9057e-01, -3.5090e-01, -6.3254e-02,
          1.2415e+00, -2.8582e-01, -2.9655e-01,  1.0663e-01,  3.2316e-01],
        [ 1.5595e-01,  2.6317e-01,  5.1676e-01, -2.6522e-01,  1.0794e-01,
          1.4060e+00, -5.4528e-01, -7.0097e-01, -2.1428e-01,  3.4562e-01],
        [ 5.5713e-02,  1.4215e-01,  4.5249e-01, -4.4601e-01,  2.1554e-01,
          1.1684e+00, -4.4231e-01, -3.2785e-01, -1.4706e-01, -2.1592e-01],
        [ 1.6575e-01,  2.0051e-01,  2.4136e-01, -7.6335e-02, -1.5401e-02,
          1.1447e+00, -2.5282e-01, -3.1916e-01, -1.7014e-01,  2.9338e-02],
        [ 3.4117e-01, -9.6980e-03,  5.0319e-01, -2.4902e-01,  5.9777e-02,
          1.6511e+00, -8.8695e-01, -4.9485e-01, -1.0283e-01,  8.7284e-02],
        [ 3.3569e-01, -8.1909e-03,  1.3776e-01, -1.5613e-01, -4.6893e-01,
          1.8553e+00, -6.1757e-01, -5.8630e-01, -1.4411e-01,  3.1211e-01],
        [ 5.1980e-01, -1.4724e-01,  1.6392e-01, -1.6994e-01, -1.8754e-01,
          1.3163e+00, -6.1733e-01, -5.6728e-01, -9.5749e-03,  3.2885e-01],
        [ 6.8475e-01,  2.9899e-01,  2.8115e-01, -2.1712e-02, -7.8087e-01,
          2.1549e+00, -9.7802e-01, -5.0542e-01,  4.4124e-02,  3.3274e-01],
        [ 2.6629e-01,  1.2345e-01,  1.8131e-01, -5.6388e-02,  1.3233e-01,
          1.0279e+00, -3.4320e-01, -4.5452e-01, -7.3114e-02,  1.9848e-01],
        [ 1.0685e-01,  2.1136e-01,  2.6446e-01, -6.5559e-02, -2.9825e-02,
          9.9131e-01, -1.7505e-01, -4.5723e-01,  2.4920e-01,  1.0739e-01],
        [ 1.9113e-01,  6.5932e-02,  4.9818e-01, -3.4167e-02, -6.8646e-02,
          1.0815e+00, -3.4030e-01, -5.5264e-01,  1.3110e-01,  1.4961e-01],
        [-1.5236e-02, -1.3426e-01,  3.2690e-01, -2.9698e-02, -1.7356e-01,
          1.5867e+00, -6.0337e-01, -4.8188e-01,  2.0168e-01,  5.8623e-01],
        [-1.8093e-02,  2.3866e-01,  1.6630e-01, -2.7864e-01,  1.8361e-01,
          9.5226e-01, -1.3115e-01, -2.8535e-01,  1.1550e-01,  2.1748e-02],
        [ 3.1167e-01,  1.7174e-01,  2.6113e-01, -1.8681e-01,  2.5673e-01,
          1.1921e+00, -3.4764e-01, -5.5308e-01, -1.0822e-01,  3.4870e-01],
        [ 2.4619e-01,  2.3113e-01,  2.3861e-01, -2.8533e-01,  1.4565e-01,
          9.0188e-01, -1.4586e-01, -3.7955e-01,  2.6829e-01, -3.3527e-02],
        [ 1.0531e-01,  1.5864e-01,  4.9453e-01, -1.3889e-01,  2.1895e-01,
          9.1488e-01, -2.3475e-01, -3.3150e-01,  3.5318e-01,  1.1671e-01],
        [-4.7354e-02,  1.4404e-01,  4.1042e-01, -2.9956e-02,  1.8015e-01,
          1.3587e+00, -3.0057e-01, -5.2536e-01, -9.6227e-02,  1.7267e-01],
        [ 1.8850e-01,  7.3995e-02,  5.2946e-01, -1.0212e-02,  2.3843e-01,
          1.4198e+00, -3.2072e-01, -3.2784e-01,  3.6379e-03,  2.2758e-01],
        [ 1.4985e-01,  1.5855e-01,  1.9040e-01, -2.7033e-01,  1.0166e-02,
          1.0841e+00, -5.1861e-01, -3.2993e-01, -7.3486e-02,  1.3263e-01],
        [ 5.7338e-01,  3.4633e-01,  1.8180e-02,  8.0002e-02, -4.1328e-01,
          1.7135e+00, -7.4259e-01, -4.0016e-01, -1.0650e-01,  1.9984e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4284, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:17:10,956 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :2089.9091796875MB
2025-02-27 17:17:10,966 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :2089.9091796875MB
All workitem count at loop begining: 1, current work item in ready runlist: 0, current work item in waiting runlist: 1
2025-02-27 17:17:25,844 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:17:25,845 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:25,846 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:17:25,846 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:25,847 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:25,847 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:25,847 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :2089.9091796875MB
2025-02-27 17:17:25,848 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[-9.9151e-03,  5.7298e-01,  9.6425e-02,  4.2478e-02, -3.2290e-01,
          2.0182e+00, -1.2751e+00, -6.0562e-01, -1.0165e-01,  2.7358e-01],
        [ 3.2705e-01,  1.9288e-01,  3.9304e-01, -2.8309e-01,  4.0235e-01,
          1.0969e+00, -1.8512e-01, -4.9266e-01, -5.9861e-02,  1.8575e-01],
        [ 2.8566e-01,  3.9590e-01,  3.1360e-02, -1.7586e-01,  4.0899e-02,
          1.3550e+00, -4.9945e-01, -3.9676e-01,  6.1076e-02,  1.7876e-01],
        [ 2.4144e-02,  1.4045e-01,  2.8615e-01, -1.5400e-01,  1.8266e-01,
          1.0374e+00, -1.4629e-01, -3.0876e-01,  3.1490e-01,  2.0628e-01],
        [ 2.2135e-01,  1.7677e-01,  5.2978e-01, -2.0036e-01,  6.9891e-02,
          1.0487e+00, -2.1631e-01, -3.1946e-01, -1.6145e-01,  2.3601e-01],
        [ 4.6686e-01,  4.0260e-01,  4.1628e-01, -2.3468e-01,  1.6890e-01,
          1.3910e+00, -5.7331e-01, -3.8547e-01, -7.5305e-02,  6.6732e-01],
        [ 3.0097e-01,  4.3814e-02,  2.0422e-01, -1.0603e-01, -1.5231e-01,
          1.2016e+00, -3.6164e-01, -3.9970e-01,  1.6640e-01,  3.1954e-01],
        [ 3.8625e-01,  1.7252e-01,  5.4655e-01, -3.3525e-01, -9.9082e-02,
          1.4316e+00, -5.2548e-01, -6.8168e-01, -3.4742e-02,  7.3227e-02],
        [ 1.2635e-01,  3.5189e-01,  3.2447e-01,  1.8120e-02,  3.8645e-02,
          1.0174e+00, -4.4805e-01, -2.7169e-01,  1.3323e-01,  1.6314e-01],
        [-2.5400e-02,  1.5374e-01,  3.2849e-01, -4.0885e-01, -2.2890e-01,
          1.5097e+00, -4.8380e-01, -4.2779e-01, -8.1583e-02,  4.8890e-02],
        [ 4.3631e-01,  2.4523e-01,  8.6515e-02, -2.4115e-01,  1.5360e-03,
          1.0897e+00, -2.7036e-01, -5.8614e-01, -5.3813e-02,  4.7076e-01],
        [ 7.2082e-02,  6.8057e-02,  2.5141e-01, -4.5985e-01, -3.2696e-02,
          1.3533e+00, -1.2513e-01, -5.5414e-01,  1.9211e-01,  2.7861e-01],
        [ 8.1188e-02,  2.0587e-01,  3.4152e-01, -2.3357e-01,  2.2001e-01,
          1.0635e+00, -2.7572e-01, -3.9305e-01,  2.1298e-01,  8.3094e-02],
        [ 1.3445e-01,  1.1674e-01,  4.4578e-01, -2.7011e-01,  1.3250e-01,
          1.4401e+00, -6.5159e-01, -1.1940e-01, -1.2505e-01,  1.0832e-01],
        [ 3.2126e-01,  2.4866e-01,  3.8407e-01, -2.2419e-01,  1.6576e-02,
          1.3934e+00, -1.7032e-01, -4.6834e-01,  6.1409e-02,  5.8690e-02],
        [ 1.0736e-01,  1.3350e-02,  2.9750e-01, -1.7288e-01, -1.4393e-01,
          1.5233e+00, -3.7708e-01, -6.5699e-01,  5.4259e-02,  1.9245e-01],
        [ 2.0427e-01,  2.0620e-01,  3.7491e-01, -4.2074e-02,  5.7199e-02,
          1.2632e+00, -3.5671e-01, -3.4087e-01, -5.9022e-02,  4.0617e-02],
        [ 2.5163e-01,  2.3299e-01,  2.5117e-01, -4.6228e-02, -4.8706e-02,
          1.0947e+00, -3.8307e-01, -5.2301e-01,  1.7356e-01,  1.9952e-01],
        [ 2.3922e-01,  2.0572e-01,  1.5203e-01,  4.8851e-02,  6.3966e-02,
          1.1712e+00, -4.1857e-01, -4.4688e-01, -2.3375e-01,  3.9708e-02],
        [ 1.0543e-01,  1.1266e-01,  8.6586e-02, -1.6685e-01,  1.4028e-01,
          1.2316e+00, -5.1474e-01, -5.4558e-01,  2.3123e-01,  1.0648e-01],
        [ 1.3030e-01,  2.1756e-01,  5.2528e-01,  5.4409e-02,  2.8543e-01,
          1.3200e+00, -4.7423e-01, -4.8590e-01,  1.4376e-01,  1.7044e-01],
        [ 1.4289e-01,  2.0236e-01,  3.9129e-01,  5.9243e-03, -2.2022e-01,
          9.9274e-01, -2.6644e-01, -3.7809e-01,  1.1240e-01, -2.2602e-02],
        [ 9.3206e-02,  2.7053e-01,  2.3507e-01,  1.1033e-01,  4.6003e-02,
          1.6653e+00, -8.5316e-01, -4.1848e-01, -2.4087e-02,  1.1685e-01],
        [ 5.0139e-02,  2.3151e-01,  4.5400e-01, -1.0275e-01,  2.8725e-02,
          9.5237e-01, -4.0417e-01, -2.4027e-01,  5.6845e-02,  1.9533e-01],
        [ 5.1685e-01,  4.0172e-01,  5.1327e-01, -3.8556e-01,  2.0378e-01,
          1.7077e+00, -5.2194e-01, -5.6686e-01, -3.0665e-01,  3.7147e-01],
        [ 2.9740e-01,  1.5309e-01,  4.4116e-01, -6.3468e-02,  4.3090e-02,
          1.2743e+00, -6.3062e-01, -4.1807e-01, -2.4941e-02,  1.6898e-01],
        [ 1.2039e-01,  3.2067e-01,  3.0754e-01, -1.7525e-01, -1.1112e-01,
          1.2680e+00, -5.0413e-01, -4.5421e-01, -6.7886e-02, -2.2959e-02],
        [ 6.1661e-01,  3.5367e-01,  2.7951e-01, -8.0326e-02, -2.5673e-02,
          1.3231e+00, -6.9656e-01, -4.5256e-01, -1.1017e-01,  5.1423e-02],
        [ 1.7580e-01,  1.6642e-01,  2.1523e-01, -9.8606e-02, -1.4842e-01,
          1.4054e+00, -1.4932e-01, -5.5725e-01,  3.3871e-01,  3.9080e-01],
        [ 1.1754e-02,  2.1088e-01,  2.0784e-01, -2.8445e-01, -3.6539e-01,
          1.4594e+00, -6.3268e-01, -4.9321e-01,  1.3769e-01,  2.3679e-01],
        [ 7.6404e-01,  3.5347e-01,  3.0021e-01, -4.1261e-01, -1.7082e-01,
          1.7042e+00, -8.3864e-01, -6.1731e-01,  1.5815e-01,  4.1132e-01],
        [ 1.5087e-01,  3.2267e-01,  1.9495e-01, -3.7781e-01, -3.4012e-01,
          1.8353e+00, -7.2266e-01, -5.5898e-01, -1.0065e-01,  3.0201e-01],
        [ 1.1001e-01,  3.1515e-01,  3.8429e-01, -2.6920e-01, -2.6850e-02,
          1.0299e+00, -3.0939e-01, -3.6722e-01,  3.3376e-01,  2.4581e-02],
        [ 8.8618e-02,  2.1861e-01,  4.7443e-01, -1.6231e-01, -6.3671e-02,
          1.3850e+00, -5.3722e-01, -3.7353e-01,  4.9685e-02,  5.6248e-02],
        [ 6.5148e-02,  1.4232e-01,  4.2443e-01,  7.5663e-02, -7.9574e-02,
          1.1394e+00, -2.8665e-01, -5.7165e-01,  1.2158e-03,  2.6509e-01],
        [ 3.1630e-01,  2.7210e-02,  3.0247e-01, -9.4440e-02, -3.2916e-02,
          1.2540e+00, -4.2706e-01, -4.3406e-01,  2.7464e-02,  2.6699e-01],
        [ 2.4419e-01,  1.5963e-01,  4.2619e-01, -5.4682e-02,  1.4190e-01,
          1.0617e+00, -2.9906e-01, -4.9345e-01, -5.6325e-02,  2.8139e-01],
        [-1.2151e-01,  9.1131e-02,  5.1431e-01, -1.1218e-01,  7.2894e-02,
          1.0657e+00, -4.6898e-01, -4.0688e-01,  2.3551e-01,  3.8237e-01],
        [ 2.1624e-01,  3.0395e-01,  2.0419e-01,  1.0002e-01,  3.7821e-02,
          1.0309e+00, -1.6054e-01, -4.1834e-01,  1.9545e-01,  1.5097e-01],
        [ 2.1306e-01,  2.1934e-02,  3.5760e-01, -2.5950e-01, -1.1315e-01,
          1.1878e+00, -7.0383e-01, -4.2140e-01, -1.3652e-02,  1.0144e-02],
        [ 8.8748e-02,  2.2278e-01,  3.1150e-01, -8.0191e-02, -2.5290e-02,
          1.1336e+00, -3.8978e-01, -4.6802e-01, -4.3185e-02,  3.8919e-01],
        [ 3.0582e-02,  3.6116e-01,  2.7353e-01, -1.2759e-01, -9.1386e-02,
          1.1649e+00, -3.0827e-01, -3.5630e-01,  9.6101e-02,  3.6837e-01],
        [ 2.2249e-01,  1.3666e-01,  3.1367e-01, -2.0371e-01, -1.9699e-01,
          1.2149e+00, -3.4620e-01, -4.5596e-01,  2.4874e-01,  1.8209e-01],
        [ 2.4334e-01,  4.5502e-02,  2.9961e-01, -1.3675e-01, -2.8235e-02,
          1.3477e+00, -6.4336e-01, -6.7667e-01, -1.7409e-01,  3.5977e-01],
        [ 1.9093e-01,  8.5559e-02,  3.6910e-01, -1.8284e-01,  2.8998e-02,
          8.6184e-01, -4.3171e-01, -2.7253e-01,  1.5589e-01,  7.1298e-02],
        [ 1.0854e-01, -7.9809e-02,  2.9079e-01, -2.5484e-01,  7.1818e-02,
          1.0140e+00, -1.8934e-01, -4.7163e-01,  3.9392e-02,  5.4564e-02],
        [ 1.9506e-01,  8.4186e-02,  3.3406e-01, -1.9156e-01,  1.1309e-01,
          1.1534e+00, -3.6442e-01, -3.8340e-01,  1.7222e-01,  1.4892e-01],
        [ 3.8036e-02,  1.5394e-01,  5.0098e-01, -3.0248e-01,  2.2471e-01,
          1.1286e+00, -5.6682e-01, -3.9154e-01,  7.9112e-02,  1.6059e-01],
        [ 2.5811e-01,  2.6003e-01,  4.0444e-01, -2.8616e-01, -2.6487e-02,
          8.9783e-01, -1.5892e-01, -4.5938e-01,  1.9079e-01,  1.1088e-01],
        [-7.2505e-02,  1.4044e-01,  4.7609e-01, -2.0614e-01,  9.6084e-02,
          1.0883e+00, -5.8572e-01, -4.0870e-01, -4.2801e-02,  3.8473e-01],
        [ 3.9650e-01,  4.8250e-01,  3.4703e-01, -3.4495e-01, -2.4460e-01,
          1.9023e+00, -7.1334e-01, -9.1497e-01,  2.9592e-01,  2.4375e-01],
        [ 9.5286e-02,  3.6166e-01,  3.2211e-01, -1.3975e-01,  9.2447e-02,
          1.2577e+00, -3.5338e-01, -3.8924e-01,  1.0957e-03,  1.9077e-01],
        [ 1.5354e-01,  3.6088e-01,  2.3265e-01, -2.7932e-01,  9.7650e-02,
          1.2036e+00, -3.5614e-01, -3.7615e-01,  1.3300e-01,  5.4376e-02],
        [-1.2362e-01,  3.6084e-01,  3.7244e-01, -3.4935e-01, -3.2451e-01,
          1.5695e+00, -6.0214e-01, -6.3424e-01, -1.8172e-01,  3.1147e-01],
        [ 1.5269e-01,  2.8271e-01,  3.2644e-01, -3.3909e-01,  3.0751e-01,
          1.4500e+00, -4.8800e-01, -4.9401e-01, -9.1745e-02,  1.6173e-01],
        [ 2.1223e-01,  2.7520e-01,  3.9526e-01, -2.4919e-01,  1.6556e-01,
          9.7962e-01, -3.9362e-01, -3.2943e-01,  2.4924e-02,  1.9234e-01],
        [ 9.5593e-03,  3.0825e-01,  2.3946e-01, -1.6208e-01,  1.0272e-01,
          1.3162e+00, -4.8012e-01, -2.0155e-01,  1.5015e-01,  3.8726e-02],
        [ 1.8602e-01,  2.5613e-01,  1.4775e-01,  2.7631e-04,  2.2865e-01,
          1.0650e+00, -1.6019e-01, -3.3155e-01,  3.0574e-01,  3.3415e-02],
        [ 1.2073e-01,  2.0104e-01,  2.2697e-01,  3.4295e-02, -9.4618e-02,
          1.3533e+00, -7.7905e-01, -5.5535e-01,  1.2687e-01,  1.8777e-01],
        [ 3.0190e-01,  2.7808e-01,  3.0289e-01,  1.2644e-02, -1.9923e-01,
          1.4217e+00, -3.6601e-01, -6.8461e-01, -1.0212e-01,  2.3234e-01],
        [ 3.9774e-02,  1.3517e-01,  4.1457e-01, -9.2088e-02, -1.2170e-01,
          1.4912e+00, -5.2647e-01, -4.5447e-01,  1.8273e-01,  2.8051e-01],
        [ 2.9687e-01,  5.2003e-02,  2.3344e-01, -1.4695e-01, -1.5314e-02,
          9.7811e-01, -2.6176e-01, -3.3724e-01, -1.1097e-01,  2.6165e-01],
        [ 1.7274e-01,  2.2395e-01,  2.5875e-01, -3.8773e-01, -2.0623e-01,
          1.5843e+00, -7.7716e-01, -4.4949e-01, -5.2892e-02,  1.4890e-01],
        [ 2.5647e-01,  2.6074e-01,  2.2973e-01, -1.2180e-01, -2.4174e-01,
          1.4299e+00, -5.2125e-01, -3.8144e-01, -2.0590e-01,  1.0222e-01]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.4692, device='cuda:0', requires_grad=True)}
----------last_grads----------
[None]
2025-02-27 17:17:25,942 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:17:25,949 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
after processing the work_item.microbatch_id 1 :2089.9091796875MB
2025-02-27 17:17:25,952 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :2089.91455078125MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
GPU After processing batch 8 in train loader:2089.9091796875
Loader: train. Accuracy: 0.078125
2025-02-27 17:17:26,404 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:17:26,405 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:17:26,407 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:17:26,407 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:17:26,408 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:17:26,409 - DEBUG - [root] 2 instantiated
2025-02-27 17:17:26,409 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:17:26,409 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:17:26,410 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:17:26,410 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:17:26,410 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:17:26,411 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:17:26,417 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:17:26,417 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:17:26,423 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:17:26,423 - DEBUG - [1][0] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:17:26,424 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:17:26,424 - DEBUG - [1][0] Invoke call found 1 ValueReference arguments
2025-02-27 17:17:26,425 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:17:26,426 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:26,426 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:17:26,426 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 0_submod_1
2025-02-27 17:17:26,427 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:17:26,427 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:17:26,428 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:17:26,428 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:26,429 - DEBUG - [1][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:17:26,431 - DEBUG - [1] Received getitem call: ('0_getitem', 1, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:17:26,435 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:17:26,435 - DEBUG - [1] Received getitem call: ('0_getitem_1', 1, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:17:26,436 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:17:26,448 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:17:26,449 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:17:26,449 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:17:26,450 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:17:26,450 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:17:26,450 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:17:26,451 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:17:26,456 - DEBUG - [1][1] Received invoke call for %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:17:26,457 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:17:26,457 - DEBUG - [1][1] Invoke call found 1 ValueReference arguments
2025-02-27 17:17:26,458 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:17:26,458 - INFO - Created WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:26,459 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:17:26,459 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})) with key 1_submod_1
2025-02-27 17:17:26,459 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:17:26,459 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:17:26,460 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:17:26,460 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1'])
2025-02-27 17:17:26,462 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:26,462 - DEBUG - [1][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
2025-02-27 17:17:26,464 - DEBUG - [1] Received getitem call: ('1_getitem', 1, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:17:26,468 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:17:26,469 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:17:26,469 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:17:26,470 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:17:26,470 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:17:26,470 - DEBUG - [1] Received getitem call: ('1_getitem_1', 1, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:17:26,474 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:17:26,475 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:17:26,476 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:17:26,476 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:17:26,477 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:17:26,477 - DEBUG - [root][0] Issuing sync invocation on stage 1
2025-02-27 17:17:26,479 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:17:26,481 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:17:26,481 - DEBUG - [1][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:17:26,482 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:17:26,483 - DEBUG - [1][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:17:26,484 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:17:26,485 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:26,485 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:17:26,486 - DEBUG - [1][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:17:26,486 - DEBUG - [root][1] Issuing sync invocation on stage 1
2025-02-27 17:17:26,487 - DEBUG - [1][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:17:26,488 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:17:26,488 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1'])
2025-02-27 17:17:26,489 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:17:26,490 - DEBUG - [1][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:17:26,491 - DEBUG - [1][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:17:26,491 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:17:26,491 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:26,493 - DEBUG - [1][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:17:26,493 - DEBUG - [1][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:17:26,490 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:26,495 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:17:26,495 - DEBUG - [1][-1] Executing transfer of value ValueReference(1, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 1 to root
2025-02-27 17:17:26,497 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_submod_1', '1_submod_1', '0_sync_barrier'])
2025-02-27 17:17:26,497 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:26,497 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:17:26,498 - DEBUG - [1][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:17:26,496 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:17:26,500 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:17:26,502 - DEBUG - [1][1] Executing transfer of value ValueReference(1, 1_getitem_1) initiated by stage 1 for 1_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:17:26,503 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:17:26,503 - DEBUG - [1][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:17:26,509 - DEBUG - [1][0] Executing transfer of value ValueReference(1, 0_getitem_1) initiated by stage 1 for 0_sync_barrier, i.e. from stage 1 to 1
2025-02-27 17:17:31,349 - DEBUG - [1][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:31,351 - DEBUG - [0][0] all operands ready: 0_submod_1
2025-02-27 17:17:31,351 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:31,352 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:31,352 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:31,352 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 0 :2106.0361328125MB
2025-02-27 17:17:31,355 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:17:31,452 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_submod_1
2025-02-27 17:17:31,459 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 02025-02-27 17:17:31,461 - DEBUG - [1][0] Completing transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1

Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:31,462 - DEBUG - [0][0] all operands ready: 0_sync_barrier
2025-02-27 17:17:31,462 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 0 :2152.166015625MB
2025-02-27 17:17:31,470 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :2152.166015625MB
All workitem count at loop begining: 3, current work item in ready runlist: 1, current work item in waiting runlist: 2
2025-02-27 17:17:31,473 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:31,474 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:31,474 - DEBUG - [0][0] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 0 :2152.166015625MB
2025-02-27 17:17:31,475 - DEBUG - [0][0] Running sync_barrier
----------loss----------
{'output': tensor([[ 3.5912e-02,  1.9711e-03,  5.4116e-02, -5.4276e-02,  4.0271e-02,
          2.4270e-02, -1.1631e-02, -5.9753e-02, -3.5996e-02,  5.2874e-02],
        [ 4.2039e-02,  5.6137e-03,  5.1491e-02, -5.6406e-02,  3.8052e-02,
          2.5272e-02, -1.0697e-02, -5.4305e-02, -3.1609e-02,  5.3250e-02],
        [ 4.5777e-02,  8.3732e-03,  5.0892e-02, -5.0356e-02,  3.3757e-02,
          3.0779e-02, -1.7651e-02, -5.5313e-02, -2.8122e-02,  6.3413e-02],
        [ 4.7133e-02,  1.4672e-02,  4.3837e-02, -4.3666e-02,  4.6513e-02,
          2.5344e-02, -8.8837e-03, -5.3559e-02, -2.4238e-02,  6.2913e-02],
        [ 4.4116e-02,  1.3152e-02,  4.8044e-02, -5.5678e-02,  4.7405e-02,
          2.2231e-02, -9.9851e-03, -5.7982e-02, -2.8753e-02,  5.5384e-02],
        [ 3.2767e-02, -7.5185e-03,  5.4584e-02, -6.2827e-02,  5.0329e-02,
          1.8791e-02, -1.2130e-02, -5.7564e-02, -4.3797e-02,  5.2497e-02],
        [ 4.3498e-02,  1.3937e-02,  4.6798e-02, -5.2897e-02,  2.7948e-02,
          2.3249e-02, -1.0566e-02, -5.4191e-02, -3.3985e-02,  5.4247e-02],
        [ 4.4932e-02,  1.0121e-02,  4.4011e-02, -4.0966e-02,  4.4466e-02,
          3.1024e-02, -5.0892e-03, -5.6872e-02, -2.0806e-02,  6.3307e-02],
        [ 3.7841e-02,  2.9752e-03,  4.5349e-02, -5.1297e-02,  3.9015e-02,
          2.1186e-02, -1.0003e-02, -5.9420e-02, -3.1155e-02,  5.8190e-02],
        [ 4.5653e-02,  1.6999e-02,  4.6306e-02, -4.3688e-02,  4.9088e-02,
          1.9653e-02, -9.3261e-03, -5.7954e-02, -2.3287e-02,  6.2826e-02],
        [ 4.3014e-02,  1.6164e-02,  3.9742e-02, -4.5454e-02,  4.2240e-02,
          2.2084e-02, -8.9073e-03, -5.5934e-02, -2.0777e-02,  6.4039e-02],
        [ 4.2165e-02,  7.7757e-03,  4.5258e-02, -4.5187e-02,  3.3308e-02,
          1.9250e-02, -6.4403e-03, -5.6579e-02, -2.6923e-02,  6.0218e-02],
        [ 3.4906e-02,  5.0256e-03,  5.0503e-02, -5.1545e-02,  3.9233e-02,
          2.4421e-02, -1.2616e-02, -5.5531e-02, -3.6868e-02,  5.5742e-02],
        [ 3.6235e-02,  1.0260e-02,  4.3892e-02, -4.6852e-02,  3.6120e-02,
          1.2354e-02, -5.5164e-03, -5.4332e-02, -2.2118e-02,  5.9977e-02],
        [ 4.5059e-02,  7.6976e-03,  4.8947e-02, -5.5278e-02,  4.8919e-02,
          2.7202e-02, -1.2469e-02, -5.2298e-02, -3.3022e-02,  5.9515e-02],
        [ 3.0315e-02,  2.4320e-03,  5.2180e-02, -5.3999e-02,  4.0981e-02,
          2.2832e-02, -7.0199e-03, -5.6248e-02, -3.3691e-02,  5.2113e-02],
        [ 3.6251e-02,  7.1813e-03,  5.1361e-02, -4.6900e-02,  4.4426e-02,
          1.8129e-02, -9.2255e-03, -5.9756e-02, -3.1305e-02,  5.5387e-02],
        [ 4.6732e-02,  9.7079e-03,  4.6242e-02, -4.9634e-02,  4.6271e-02,
          2.0382e-02, -9.5186e-03, -5.6283e-02, -2.6479e-02,  5.8167e-02],
        [ 3.7384e-02,  1.9803e-02,  4.6339e-02, -4.8775e-02,  3.3680e-02,
          2.4742e-02, -3.1824e-03, -5.7481e-02, -2.9674e-02,  6.9721e-02],
        [ 3.7317e-02,  6.2068e-03,  4.6904e-02, -5.5184e-02,  3.9554e-02,
          2.4712e-02, -1.3878e-02, -5.7882e-02, -3.3053e-02,  6.2368e-02],
        [ 3.9685e-02,  7.3345e-03,  4.9779e-02, -5.2876e-02,  4.8487e-02,
          2.3206e-02, -6.5902e-03, -6.1930e-02, -3.2645e-02,  5.6941e-02],
        [ 4.1980e-02,  1.2673e-02,  4.8588e-02, -4.3206e-02,  3.7337e-02,
          2.6511e-02, -8.6749e-03, -5.7962e-02, -2.2398e-02,  6.2720e-02],
        [ 3.3175e-02,  1.2103e-02,  3.9153e-02, -4.5501e-02,  3.3109e-02,
          2.7297e-02, -1.0558e-02, -5.5506e-02, -2.7009e-02,  6.8291e-02],
        [ 3.4536e-02,  3.3905e-03,  4.9698e-02, -5.4762e-02,  4.3741e-02,
          1.8971e-02, -1.2210e-02, -5.7488e-02, -2.9153e-02,  5.5684e-02],
        [ 3.8982e-02,  7.7612e-03,  4.0650e-02, -4.6656e-02,  3.5368e-02,
          2.1986e-02, -1.1992e-02, -5.5215e-02, -2.7966e-02,  6.3329e-02],
        [ 4.4969e-02,  1.2519e-02,  4.2762e-02, -4.5919e-02,  3.6308e-02,
          2.4660e-02, -7.4218e-03, -5.1889e-02, -2.6764e-02,  6.4448e-02],
        [ 3.0125e-02, -7.6544e-03,  5.0333e-02, -6.5451e-02,  4.4010e-02,
          2.2861e-02, -1.4545e-02, -5.8872e-02, -4.4486e-02,  5.5467e-02],
        [ 3.4614e-02, -1.7197e-03,  4.8943e-02, -6.3767e-02,  4.8183e-02,
          2.6751e-02, -1.3610e-02, -6.1402e-02, -3.9066e-02,  6.0659e-02],
        [ 3.7846e-02,  1.1447e-02,  4.3723e-02, -4.7878e-02,  4.6482e-02,
          2.1885e-02, -9.5252e-03, -6.0439e-02, -2.9175e-02,  5.4007e-02],
        [ 4.4091e-02,  1.3683e-02,  4.2862e-02, -4.2370e-02,  4.6135e-02,
          2.3068e-02, -8.5622e-03, -5.4495e-02, -2.3422e-02,  6.1980e-02],
        [ 4.2676e-02,  1.2684e-02,  4.1746e-02, -4.1805e-02,  4.2173e-02,
          2.4047e-02, -1.3815e-02, -5.3670e-02, -2.2187e-02,  5.8823e-02],
        [ 3.6148e-02,  5.6497e-03,  4.8511e-02, -6.0806e-02,  4.7192e-02,
          2.2560e-02, -9.3342e-03, -6.1146e-02, -3.9785e-02,  5.6463e-02],
        [ 3.9361e-02,  1.0211e-02,  5.1150e-02, -5.5437e-02,  3.8001e-02,
          1.5889e-02, -8.6548e-03, -5.6118e-02, -2.4424e-02,  5.8005e-02],
        [ 3.3956e-02,  6.6050e-03,  3.9295e-02, -5.1311e-02,  3.9110e-02,
          1.7724e-02, -1.2415e-02, -5.6323e-02, -2.5702e-02,  6.0864e-02],
        [ 3.3204e-02,  1.9847e-02,  5.1514e-02, -4.6834e-02,  2.8225e-02,
          2.1444e-02,  1.6289e-03, -6.1756e-02, -3.2248e-02,  6.6530e-02],
        [ 4.4098e-02,  1.8702e-02,  4.2003e-02, -4.3983e-02,  4.4036e-02,
          1.5615e-02, -1.2923e-02, -5.4677e-02, -2.7137e-02,  5.3595e-02],
        [ 3.2311e-02,  1.1727e-02,  5.1956e-02, -5.3970e-02,  4.1089e-02,
          2.5299e-02, -9.6653e-03, -5.7661e-02, -3.8247e-02,  5.8559e-02],
        [ 3.5398e-02, -5.3739e-03,  5.6016e-02, -4.9524e-02,  4.2759e-02,
          2.5013e-02, -3.9823e-03, -5.7147e-02, -4.0829e-02,  5.9492e-02],
        [ 4.0110e-02,  8.2245e-03,  4.7004e-02, -5.1500e-02,  4.3449e-02,
          2.9377e-02, -2.3929e-03, -6.2679e-02, -2.7698e-02,  5.4930e-02],
        [ 3.7096e-02, -4.2096e-03,  5.8607e-02, -5.6713e-02,  4.6458e-02,
          1.9442e-02, -6.6810e-03, -6.2084e-02, -4.7166e-02,  5.7776e-02],
        [ 3.8769e-02, -4.4614e-03,  5.3818e-02, -5.7329e-02,  5.0021e-02,
          3.0978e-02, -1.0995e-02, -6.0181e-02, -4.1608e-02,  6.1058e-02],
        [ 3.3946e-02, -4.2735e-03,  5.5696e-02, -6.0624e-02,  4.9621e-02,
          2.5136e-02, -1.4790e-02, -6.1453e-02, -5.0342e-02,  5.9811e-02],
        [ 4.4422e-02,  1.0047e-02,  4.8986e-02, -5.6494e-02,  5.2955e-02,
          2.4147e-02, -1.3530e-02, -5.6658e-02, -3.2025e-02,  5.7506e-02],
        [ 3.7711e-02,  1.6359e-02,  5.0849e-02, -5.0326e-02,  3.3742e-02,
          2.7648e-02, -5.3314e-03, -5.7647e-02, -3.8279e-02,  6.8989e-02],
        [ 3.1457e-02, -2.0724e-03,  4.8357e-02, -5.3102e-02,  3.3742e-02,
          2.3629e-02, -1.1944e-02, -6.0010e-02, -3.0394e-02,  5.5603e-02],
        [ 2.9460e-02, -2.0723e-03,  4.8208e-02, -5.8531e-02,  4.1026e-02,
          2.1398e-02, -7.8129e-03, -6.1211e-02, -3.9808e-02,  6.3009e-02],
        [ 3.9092e-02,  1.7044e-02,  4.4738e-02, -4.9743e-02,  3.2101e-02,
          2.8092e-02, -6.3076e-03, -5.7462e-02, -3.0932e-02,  6.8625e-02],
        [ 3.8732e-02,  1.6087e-02,  5.0566e-02, -5.2992e-02,  3.2416e-02,
          2.8738e-02, -6.3478e-03, -5.6056e-02, -3.5864e-02,  6.0501e-02],
        [ 3.3187e-02,  9.8026e-03,  4.4652e-02, -5.0730e-02,  2.9320e-02,
          1.9658e-02, -3.3107e-03, -5.6796e-02, -2.9457e-02,  6.0204e-02],
        [ 5.2433e-02,  1.5629e-02,  4.0523e-02, -3.5636e-02,  4.9358e-02,
          2.5835e-02, -8.4604e-03, -5.3335e-02, -1.7962e-02,  6.2360e-02],
        [ 3.2919e-02, -5.6408e-03,  4.9628e-02, -6.1465e-02,  5.0477e-02,
          1.9757e-02, -1.4541e-02, -6.3588e-02, -4.1349e-02,  5.3571e-02],
        [ 2.9905e-02, -1.4632e-02,  6.1517e-02, -6.9865e-02,  4.8569e-02,
          2.6184e-02, -1.0242e-02, -6.3804e-02, -5.5980e-02,  5.9510e-02],
        [ 3.3295e-02,  5.7276e-03,  5.2082e-02, -6.0385e-02,  4.4789e-02,
          2.5624e-02, -1.3092e-02, -6.7074e-02, -4.3684e-02,  5.6073e-02],
        [ 3.5593e-02,  1.3387e-02,  5.1464e-02, -4.3985e-02,  4.2147e-02,
          2.5546e-02, -5.3304e-03, -6.1138e-02, -3.4175e-02,  6.4027e-02],
        [ 3.6933e-02, -4.7665e-03,  5.1299e-02, -5.6312e-02,  4.6368e-02,
          2.1554e-02, -1.3773e-02, -5.5991e-02, -3.1092e-02,  4.5455e-02],
        [ 3.6262e-02,  1.0015e-02,  4.6936e-02, -4.7975e-02,  3.9344e-02,
          2.3086e-02, -1.1024e-02, -6.1990e-02, -3.6441e-02,  6.3256e-02],
        [ 4.0014e-02,  1.2952e-02,  4.5972e-02, -4.6115e-02,  4.4241e-02,
          2.5011e-02, -9.4946e-03, -5.8667e-02, -2.8727e-02,  6.2515e-02],
        [ 3.2944e-02, -4.5715e-03,  5.5683e-02, -6.1187e-02,  4.9370e-02,
          1.9702e-02, -1.6312e-02, -6.6317e-02, -5.1117e-02,  5.6575e-02],
        [ 3.7639e-02,  2.5648e-03,  4.9063e-02, -5.3674e-02,  4.5949e-02,
          2.8565e-02, -8.5016e-03, -5.5533e-02, -3.3312e-02,  6.3419e-02],
        [ 3.6350e-02, -4.3272e-05,  4.8973e-02, -5.4566e-02,  4.0870e-02,
          2.1086e-02, -1.1082e-02, -5.6481e-02, -3.1253e-02,  6.2425e-02],
        [ 4.4193e-02,  1.6530e-02,  4.0956e-02, -4.0463e-02,  4.2038e-02,
          2.2160e-02, -9.7542e-03, -5.6626e-02, -2.3130e-02,  5.9241e-02],
        [ 3.6932e-02, -4.1796e-04,  4.5938e-02, -5.2234e-02,  4.1585e-02,
          2.8790e-02, -1.6747e-02, -5.9756e-02, -3.2206e-02,  6.1731e-02],
        [ 3.9631e-02, -5.7395e-03,  6.0068e-02, -6.3186e-02,  5.4709e-02,
          2.4517e-02, -1.1697e-02, -6.7979e-02, -5.0631e-02,  5.8360e-02],
        [ 4.6462e-02,  1.3697e-02,  4.4171e-02, -4.6848e-02,  4.4604e-02,
          1.9660e-02, -8.5234e-03, -5.4907e-02, -2.8336e-02,  5.9348e-02]],
       device='cuda:0', requires_grad=True), 'loss': tensor(2.3026, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:17:31,621 - DEBUG - [0][0] Populating result of type <class 'tuple'> for 0_sync_barrier
after processing the work_item.microbatch_id 0 :2152.166015625MB
2025-02-27 17:17:31,627 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :2152.166015625MB
All workitem count at loop begining: 2, current work item in ready runlist: 0, current work item in waiting runlist: 2
2025-02-27 17:17:32,721 - DEBUG - [1][1] Completing transfer of value ValueReference(0, 1_submod_0) for runlist item 1_submod_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:32,722 - DEBUG - [0][1] all operands ready: 1_submod_1
2025-02-27 17:17:32,722 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:32,723 - INFO - WorkItem is ready: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:32,723 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
2025-02-27 17:17:32,724 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
before processing the work_item.microbatch_id 1 :2152.1689453125MB
2025-02-27 17:17:32,725 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:17:32,788 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_submod_1
2025-02-27 17:17:32,798 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
2025-02-27 17:17:32,799 - DEBUG - [1][1] Completing transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
Before WorkItem Ready if: work_item.blocked_args_count(0) should be 0
2025-02-27 17:17:32,799 - DEBUG - [0][1] all operands ready: 1_sync_barrier
2025-02-27 17:17:32,799 - INFO - WorkItem is ready: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
after processing the work_item.microbatch_id 1 :2206.2998046875MB
2025-02-27 17:17:32,805 - INFO - Released WorkItem: WorkItem(%submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {}))
Periodic memory cleanup :2206.2998046875MB
All workitem count at loop begining: 1, current work item in ready runlist: 1, current work item in waiting runlist: 0
2025-02-27 17:17:32,809 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:17:32,809 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:17:32,809 - DEBUG - [0][1] Got WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
before processing the work_item.microbatch_id 1 :2206.2998046875MB
2025-02-27 17:17:32,811 - DEBUG - [0][1] Running sync_barrier
----------loss----------
{'output': tensor([[ 0.0369,  0.0006,  0.0484, -0.0534,  0.0331,  0.0260, -0.0099, -0.0540,
         -0.0347,  0.0554],
        [ 0.0420,  0.0140,  0.0502, -0.0456,  0.0369,  0.0218, -0.0091, -0.0595,
         -0.0323,  0.0649],
        [ 0.0328,  0.0050,  0.0491, -0.0529,  0.0355,  0.0224, -0.0123, -0.0612,
         -0.0363,  0.0592],
        [ 0.0465,  0.0136,  0.0510, -0.0439,  0.0310,  0.0319, -0.0119, -0.0564,
         -0.0258,  0.0659],
        [ 0.0463,  0.0091,  0.0479, -0.0553,  0.0259,  0.0210, -0.0061, -0.0507,
         -0.0278,  0.0590],
        [ 0.0357,  0.0031,  0.0500, -0.0556,  0.0486,  0.0206, -0.0120, -0.0626,
         -0.0385,  0.0587],
        [ 0.0537,  0.0146,  0.0472, -0.0447,  0.0362,  0.0228, -0.0133, -0.0509,
         -0.0217,  0.0609],
        [ 0.0424,  0.0182,  0.0470, -0.0410,  0.0395,  0.0268, -0.0083, -0.0534,
         -0.0280,  0.0643],
        [ 0.0440,  0.0176,  0.0390, -0.0402,  0.0465,  0.0295, -0.0072, -0.0537,
         -0.0211,  0.0667],
        [ 0.0393,  0.0042,  0.0514, -0.0527,  0.0435,  0.0269, -0.0092, -0.0549,
         -0.0365,  0.0566],
        [ 0.0399,  0.0146,  0.0397, -0.0427,  0.0374,  0.0309, -0.0106, -0.0577,
         -0.0212,  0.0656],
        [ 0.0417,  0.0041,  0.0529, -0.0528,  0.0431,  0.0262, -0.0120, -0.0572,
         -0.0306,  0.0575],
        [ 0.0349,  0.0120,  0.0559, -0.0548,  0.0425,  0.0224, -0.0105, -0.0624,
         -0.0410,  0.0556],
        [ 0.0322,  0.0077,  0.0468, -0.0565,  0.0403,  0.0217, -0.0127, -0.0565,
         -0.0313,  0.0559],
        [ 0.0389,  0.0007,  0.0487, -0.0626,  0.0501,  0.0297, -0.0138, -0.0532,
         -0.0424,  0.0568],
        [ 0.0360,  0.0043,  0.0452, -0.0531,  0.0388,  0.0186, -0.0084, -0.0566,
         -0.0282,  0.0577],
        [ 0.0344,  0.0078,  0.0467, -0.0570,  0.0419,  0.0197, -0.0113, -0.0614,
         -0.0336,  0.0593],
        [ 0.0420,  0.0141,  0.0397, -0.0402,  0.0369,  0.0292, -0.0063, -0.0572,
         -0.0236,  0.0679],
        [ 0.0392,  0.0119,  0.0478, -0.0573,  0.0318,  0.0255, -0.0059, -0.0564,
         -0.0316,  0.0591],
        [ 0.0459,  0.0147,  0.0489, -0.0495,  0.0450,  0.0207, -0.0105, -0.0605,
         -0.0328,  0.0597],
        [ 0.0440,  0.0140,  0.0448, -0.0402,  0.0416,  0.0242, -0.0062, -0.0594,
         -0.0282,  0.0619],
        [ 0.0314,  0.0049,  0.0538, -0.0567,  0.0438,  0.0166, -0.0099, -0.0693,
         -0.0434,  0.0535],
        [ 0.0310, -0.0094,  0.0566, -0.0674,  0.0470,  0.0298, -0.0132, -0.0558,
         -0.0545,  0.0570],
        [ 0.0368, -0.0057,  0.0477, -0.0634,  0.0507,  0.0251, -0.0152, -0.0586,
         -0.0423,  0.0596],
        [ 0.0341, -0.0059,  0.0639, -0.0646,  0.0525,  0.0206, -0.0116, -0.0709,
         -0.0552,  0.0537],
        [ 0.0442,  0.0125,  0.0484, -0.0477,  0.0446,  0.0223, -0.0078, -0.0591,
         -0.0281,  0.0640],
        [ 0.0269,  0.0021,  0.0442, -0.0508,  0.0296,  0.0198, -0.0134, -0.0593,
         -0.0256,  0.0594],
        [ 0.0335,  0.0013,  0.0502, -0.0583,  0.0401,  0.0166, -0.0174, -0.0610,
         -0.0297,  0.0551],
        [ 0.0348,  0.0092,  0.0445, -0.0464,  0.0299,  0.0205, -0.0076, -0.0563,
         -0.0270,  0.0614],
        [ 0.0381,  0.0147,  0.0467, -0.0493,  0.0255,  0.0193,  0.0002, -0.0589,
         -0.0277,  0.0643],
        [ 0.0401,  0.0123,  0.0482, -0.0541,  0.0420,  0.0164, -0.0131, -0.0613,
         -0.0381,  0.0600],
        [ 0.0318,  0.0103,  0.0523, -0.0546,  0.0408,  0.0263, -0.0149, -0.0634,
         -0.0366,  0.0612],
        [ 0.0391, -0.0092,  0.0582, -0.0648,  0.0526,  0.0271, -0.0080, -0.0640,
         -0.0532,  0.0621],
        [ 0.0276, -0.0126,  0.0626, -0.0729,  0.0508,  0.0215, -0.0115, -0.0702,
         -0.0630,  0.0553],
        [ 0.0353,  0.0071,  0.0542, -0.0565,  0.0461,  0.0237, -0.0123, -0.0625,
         -0.0417,  0.0568],
        [ 0.0388,  0.0100,  0.0477, -0.0491,  0.0475,  0.0194, -0.0156, -0.0582,
         -0.0333,  0.0564],
        [ 0.0488,  0.0159,  0.0428, -0.0452,  0.0339,  0.0246, -0.0055, -0.0526,
         -0.0255,  0.0688],
        [ 0.0472,  0.0185,  0.0425, -0.0415,  0.0476,  0.0201, -0.0120, -0.0543,
         -0.0231,  0.0615],
        [ 0.0410,  0.0146,  0.0474, -0.0502,  0.0474,  0.0196, -0.0109, -0.0558,
         -0.0296,  0.0578],
        [ 0.0419,  0.0165,  0.0453, -0.0466,  0.0375,  0.0251, -0.0099, -0.0576,
         -0.0274,  0.0640],
        [ 0.0336,  0.0085,  0.0504, -0.0508,  0.0391,  0.0250, -0.0071, -0.0577,
         -0.0342,  0.0613],
        [ 0.0387,  0.0095,  0.0467, -0.0527,  0.0356,  0.0167, -0.0052, -0.0559,
         -0.0301,  0.0620],
        [ 0.0355,  0.0113,  0.0524, -0.0574,  0.0406,  0.0222, -0.0079, -0.0585,
         -0.0387,  0.0664],
        [ 0.0347,  0.0051,  0.0503, -0.0467,  0.0349,  0.0238, -0.0048, -0.0595,
         -0.0317,  0.0614],
        [ 0.0366,  0.0052,  0.0457, -0.0504,  0.0303,  0.0359, -0.0065, -0.0626,
         -0.0369,  0.0671],
        [ 0.0343,  0.0036,  0.0524, -0.0561,  0.0368,  0.0233, -0.0056, -0.0505,
         -0.0344,  0.0568],
        [ 0.0440,  0.0101,  0.0455, -0.0461,  0.0375,  0.0212, -0.0034, -0.0555,
         -0.0265,  0.0610],
        [ 0.0342,  0.0009,  0.0510, -0.0575,  0.0452,  0.0182, -0.0144, -0.0559,
         -0.0429,  0.0555],
        [ 0.0365,  0.0002,  0.0478, -0.0550,  0.0411,  0.0172, -0.0074, -0.0575,
         -0.0319,  0.0581],
        [ 0.0345,  0.0168,  0.0517, -0.0437,  0.0302,  0.0225, -0.0028, -0.0596,
         -0.0307,  0.0692],
        [ 0.0391,  0.0005,  0.0497, -0.0611,  0.0488,  0.0158, -0.0151, -0.0584,
         -0.0408,  0.0539],
        [ 0.0416,  0.0140,  0.0441, -0.0453,  0.0345,  0.0280, -0.0092, -0.0541,
         -0.0236,  0.0595],
        [ 0.0329,  0.0004,  0.0530, -0.0579,  0.0456,  0.0257, -0.0127, -0.0569,
         -0.0388,  0.0592],
        [ 0.0333, -0.0067,  0.0534, -0.0597,  0.0437,  0.0249, -0.0057, -0.0587,
         -0.0416,  0.0619],
        [ 0.0445,  0.0145,  0.0444, -0.0529,  0.0450,  0.0163, -0.0137, -0.0590,
         -0.0293,  0.0593],
        [ 0.0376,  0.0051,  0.0526, -0.0511,  0.0436,  0.0217, -0.0129, -0.0614,
         -0.0382,  0.0580],
        [ 0.0317, -0.0121,  0.0584, -0.0710,  0.0558,  0.0278, -0.0108, -0.0628,
         -0.0554,  0.0602],
        [ 0.0406,  0.0119,  0.0416, -0.0446,  0.0305,  0.0220, -0.0049, -0.0602,
         -0.0308,  0.0674],
        [ 0.0339,  0.0086,  0.0501, -0.0505,  0.0390,  0.0192, -0.0047, -0.0589,
         -0.0294,  0.0585],
        [ 0.0390,  0.0130,  0.0484, -0.0398,  0.0313,  0.0327, -0.0109, -0.0557,
         -0.0223,  0.0594],
        [ 0.0325, -0.0019,  0.0482, -0.0583,  0.0332,  0.0151, -0.0088, -0.0602,
         -0.0351,  0.0594],
        [ 0.0388,  0.0132,  0.0459, -0.0450,  0.0390,  0.0240, -0.0128, -0.0579,
         -0.0278,  0.0595],
        [ 0.0367,  0.0147,  0.0434, -0.0537,  0.0440,  0.0201, -0.0155, -0.0568,
         -0.0311,  0.0583],
        [ 0.0422,  0.0052,  0.0505, -0.0551,  0.0432,  0.0255, -0.0123, -0.0582,
         -0.0313,  0.0621]], device='cuda:0', requires_grad=True), 'loss': tensor(2.2980, device='cuda:0', requires_grad=True)}
----------last_grads----------
ValueReference(0, noop)
2025-02-27 17:17:32,905 - DEBUG - [0][1] Populating result of type <class 'tuple'> for 1_sync_barrier
2025-02-27 17:17:32,914 - DEBUG - [root] Synchronizing gradients for 0 sets of replicated parameters
GPU After processing batch 2 in valid loader:2206.291015625
Loader: valid. Accuracy: 0.109375
GPU End of epoch 6:2206.291015625
[31mSwitching template...[0m
2025-02-27 17:17:32,919 - INFO - [root] Creating pipeline driver with 2 workers: [0, 1]
after processing the work_item.microbatch_id 1 :2206.291015625MB2025-02-27 17:17:32,922 - INFO - [0] Instantiating RankWorker
Inital rank worker:2206.291015625MB
2025-02-27 17:17:32,924 - INFO - [root] Sending stage_id = 0 mod to worker
after initialization :2206.291015625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0

2025-02-27 17:17:32,927 - INFO - Released WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
Periodic memory cleanup :2206.291015625MB
All workitem count at loop begining: 0, current work item in ready runlist: 0, current work item in waiting runlist: 0
[32mCurrent descr name: submod_0, stage_id: 0, rank: 0[0m
2025-02-27 17:17:32,955 - INFO - [root] Sending stage_id = 1 mod to worker
[32mCurrent descr name: submod_1, stage_id: 1, rank: 1[0m
2025-02-27 17:17:33,021 - INFO - Instantiating PipeStageExecutor for stage 0
[31mSwitch template complete![0m
[31mTime taken to switch template: 82.35900354385376 seconds[0m
Epoch: 7
GPU Start of epoch 7:2208.884765625
2025-02-27 17:18:55,770 - INFO - [root] Running pipeline with 2 micro-batches
2025-02-27 17:18:55,772 - DEBUG - [root] Instantiating microbatch interpreter for chunk 0
2025-02-27 17:18:55,773 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:18:55,774 - DEBUG - [root] Instantiating microbatch interpreter for chunk 1
2025-02-27 17:18:55,775 - DEBUG - [root] RemoteInterpreter created with 17 nodes
2025-02-27 17:18:55,775 - DEBUG - [root] 2 instantiated
2025-02-27 17:18:55,775 - DEBUG - [0] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:18:55,776 - DEBUG - [0] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:18:55,776 - DEBUG - [1] Issue command to run %input_1 : [#users=2] = placeholder[target=input]
2025-02-27 17:18:55,777 - DEBUG - [1] Issue command to run %target : [#users=2] = placeholder[target=target]
2025-02-27 17:18:55,777 - DEBUG - [0] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:18:55,777 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:18:55,783 - DEBUG - [0][0] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:18:55,783 - DEBUG - [0][0] Invoke call found 0 ValueReference arguments
2025-02-27 17:18:55,784 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:55,784 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 0_submod_0
2025-02-27 17:18:55,784 - DEBUG - [0][0] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:18:55,784 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:18:55,785 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:55,786 - DEBUG - [0] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:18:55,786 - DEBUG - [root][0] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:18:55,786 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:18:55,790 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:55,790 - DEBUG - [0][0] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 0 :2209.384765625MB
2025-02-27 17:18:55,792 - INFO - [0] Running forward module for microbatch 0
2025-02-27 17:18:55,796 - DEBUG - [0] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:18:55,797 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem', 2, ValueReference(1, 0_submod_1), 0)
2025-02-27 17:18:55,798 - DEBUG - [0] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:18:55,798 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_1', 2, ValueReference(1, 0_submod_1), 1)
2025-02-27 17:18:55,798 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:18:55,803 - DEBUG - [1] Issue command to run %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:18:55,803 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_0 on stage 0
2025-02-27 17:18:55,807 - DEBUG - [0][1] Received invoke call for %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})
2025-02-27 17:18:55,808 - DEBUG - [0][1] Invoke call found 0 ValueReference arguments
2025-02-27 17:18:55,808 - INFO - Created WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:55,809 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})) with key 1_submod_0
2025-02-27 17:18:55,809 - DEBUG - [0][1] No RRef arguments. Scheduling directly as READY workitem
2025-02-27 17:18:55,809 - DEBUG - [0] Current ready runlist keys: dict_keys([])
2025-02-27 17:18:55,809 - INFO - Enqueued WorkItem to ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:55,817 - DEBUG - [0] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:18:55,820 - DEBUG - [root][0] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:18:55,832 - DEBUG - [0] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:18:55,833 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_2', 2, ValueReference(1, 0_stage_backward), 0)
2025-02-27 17:18:55,833 - DEBUG - [0] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:18:55,834 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_3', 1, ValueReference(1, 0_stage_backward), 1)
2025-02-27 17:18:55,834 - DEBUG - [0] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:18:55,834 - DEBUG - [root][0] Appending getitem tuple to stage 1: ('0_getitem_4', 1, ValueReference(1, 0_getitem_2), 0)
2025-02-27 17:18:55,834 - DEBUG - [0] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:18:55,835 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:18:55,841 - DEBUG - [1] Issue command to run %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})
2025-02-27 17:18:55,841 - DEBUG - [root][1] Issuing Phase.FORWARD invocation for target submod_1 on stage 1
2025-02-27 17:18:55,849 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_submod_1, i.e. from stage 0 to 1
2025-02-27 17:18:55,859 - DEBUG - [1] Issue command to run %getitem : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 0), kwargs = {})
2025-02-27 17:18:55,859 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem', 2, ValueReference(1, 1_submod_1), 0)
2025-02-27 17:18:55,859 - DEBUG - [1] Issue command to run %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%submod_1, 1), kwargs = {})
2025-02-27 17:18:55,860 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_1', 2, ValueReference(1, 1_submod_1), 1)
2025-02-27 17:18:55,860 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:18:55,866 - DEBUG - [0] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:18:55,866 - DEBUG - [root][0] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:18:55,877 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 1 for 0_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:18:55,883 - DEBUG - [0] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:18:55,883 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:18:55,884 - DEBUG - [0] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:18:55,884 - DEBUG - [root][0] Appending getitem tuple to stage 0: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:18:55,885 - DEBUG - [0] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:18:55,885 - DEBUG - [root][0] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:18:55,891 - DEBUG - [0][0] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:18:55,892 - DEBUG - [0][0] Invoke call found 2 ValueReference arguments
2025-02-27 17:18:55,892 - DEBUG - [1] Issue command to run %stage_backward : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%getitem, %getitem_1), output_grads: (None, None), input_values: [%submod_0, %target], outputs_with_grads_idxs: [1], stage_info: stage_backward for stage %submod_1 : [#users=2] = call_module[target=submod_1](args = (%submod_0, %target), kwargs = {})})
2025-02-27 17:18:55,892 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:18:55,894 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 0_stage_backward_1
2025-02-27 17:18:55,894 - DEBUG - [root][1] Issuing BW invocation for target submod_1 on stage 1
2025-02-27 17:18:55,895 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:18:55,896 - DEBUG - [0] Current waiting runlist keys: dict_keys([])
2025-02-27 17:18:55,897 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:18:55,897 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:18:55,893 - DEBUG - [0] Received getitem call: ('0_getitem_6', 2, ValueReference(0, 0_stage_backward_1), 0)
2025-02-27 17:18:55,900 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_submod_0) initiated by stage 0 for 0_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:18:55,901 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_4) for runlist item 0_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:18:55,913 - DEBUG - [0] Received getitem call: ('0_getitem_7', 1, ValueReference(0, 0_stage_backward_1), 1)
2025-02-27 17:18:55,916 - DEBUG - [1] Issue command to run %getitem_2 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward, 0), kwargs = {})
2025-02-27 17:18:55,917 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_submod_1, i.e. from stage 0 to 1
2025-02-27 17:18:55,917 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_2', 2, ValueReference(1, 1_stage_backward), 0)
2025-02-27 17:18:55,919 - DEBUG - [1] Issue command to run %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward, 1), kwargs = {})
2025-02-27 17:18:55,919 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_3', 1, ValueReference(1, 1_stage_backward), 1)
2025-02-27 17:18:55,919 - DEBUG - [1] Issue command to run %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%getitem_2, 0), kwargs = {})
2025-02-27 17:18:55,920 - DEBUG - [root][1] Appending getitem tuple to stage 1: ('1_getitem_4', 1, ValueReference(1, 1_getitem_2), 0)
2025-02-27 17:18:55,920 - DEBUG - [1] Issue command to run %getitem_5 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_2, 1), kwargs = {})
2025-02-27 17:18:55,920 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([1])
2025-02-27 17:18:55,937 - DEBUG - [0] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:18:55,937 - DEBUG - [root][0] Issuing sync invocation on stage 0
2025-02-27 17:18:55,939 - DEBUG - [1] Issue command to run %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:18:55,940 - DEBUG - [root][1] Issuing BW invocation for target submod_0 on stage 0
2025-02-27 17:18:55,943 - DEBUG - [0][0] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:18:55,944 - DEBUG - [0][0] Invoke call found 5 ValueReference arguments
2025-02-27 17:18:55,944 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:18:55,945 - DEBUG - [0][0] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 0_sync_barrier
2025-02-27 17:18:55,945 - DEBUG - [0][0] Scheduling WorkItem as WAITING workitem
2025-02-27 17:18:55,946 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1'])
2025-02-27 17:18:55,946 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:18:55,946 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem) for runlist item 0_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:18:55,947 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_1) for runlist item 0_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:18:55,947 - DEBUG - [0][0] Requesting transfer of value ValueReference(1, 0_getitem_3) for runlist item 0_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:18:55,948 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_7) for runlist item 0_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:18:55,949 - DEBUG - [0][0] Requesting transfer of value ValueReference(0, 0_getitem_6) for runlist item 0_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:18:55,953 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_7) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:18:55,955 - DEBUG - [0][0] Executing transfer of value ValueReference(0, 0_getitem_6) initiated by stage 0 for 0_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:18:55,972 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 1 for 1_stage_backward, i.e. from stage 0 to 1
2025-02-27 17:18:55,990 - DEBUG - [0][1] Received invoke call for %stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})
2025-02-27 17:18:55,991 - DEBUG - [0][1] Invoke call found 2 ValueReference arguments
2025-02-27 17:18:55,991 - INFO - Created WorkItem: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:18:55,992 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})})) with key 1_stage_backward_1
2025-02-27 17:18:55,992 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:18:55,992 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier'])
2025-02-27 17:18:55,992 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%stage_backward_1 : [#users=2] = call_function[target=pippy.backward.stage_backward](args = (), kwargs = {stage_output: (%submod_0,), output_grads: (%getitem_4,), input_values: [%input_1], outputs_with_grads_idxs: [0], stage_info: stage_backward_1 for stage %submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {})}))
2025-02-27 17:18:55,993 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_submod_0) for runlist item 1_stage_backward_1 arg_idx 0 from peer stage 0
2025-02-27 17:18:55,996 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_submod_0) initiated by stage 0 for 1_stage_backward_1, i.e. from stage 0 to 0
2025-02-27 17:18:56,001 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_4) for runlist item 1_stage_backward_1 arg_idx 1 from peer stage 1
2025-02-27 17:18:56,015 - DEBUG - [1] Issue command to run %getitem_6 : [#users=2] = call_function[target=operator.getitem](args = (%stage_backward_1, 0), kwargs = {})
2025-02-27 17:18:56,016 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:18:56,016 - DEBUG - [1] Issue command to run %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%stage_backward_1, 1), kwargs = {})
2025-02-27 17:18:56,017 - DEBUG - [root][1] Appending getitem tuple to stage 0: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:18:56,017 - DEBUG - [1] Issue command to run %getitem_8 : [#users=0] = call_function[target=operator.getitem](args = (%getitem_6, 0), kwargs = {})
2025-02-27 17:18:56,017 - DEBUG - [root][1] Issuing getitem calls to stage: dict_keys([0])
2025-02-27 17:18:56,023 - DEBUG - [1] Issue command to run %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:18:56,024 - DEBUG - [root][1] Issuing sync invocation on stage 0
2025-02-27 17:18:56,025 - DEBUG - [0] Received getitem call: ('1_getitem_6', 2, ValueReference(0, 1_stage_backward_1), 0)
2025-02-27 17:18:56,026 - DEBUG - [0] Received getitem call: ('1_getitem_7', 1, ValueReference(0, 1_stage_backward_1), 1)
2025-02-27 17:18:56,027 - DEBUG - [root] Retrieving output values from 2 chunks
2025-02-27 17:18:56,029 - DEBUG - [0] Issue command to run return sync_barrier
2025-02-27 17:18:56,029 - DEBUG - [1] Issue command to run return sync_barrier
2025-02-27 17:18:56,071 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 0_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:18:56,077 - DEBUG - [0][-1] Executing transfer of value ValueReference(0, 1_sync_barrier) initiated by stage root for collect, i.e. from stage 0 to root
2025-02-27 17:18:56,090 - DEBUG - [0][1] Received invoke call for %sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})
2025-02-27 17:18:56,106 - DEBUG - [0][1] Invoke call found 5 ValueReference arguments
2025-02-27 17:18:56,107 - INFO - Created WorkItem: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:18:56,108 - DEBUG - [0][1] Invoke instantiated WorkItem WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {})) with key 1_sync_barrier
2025-02-27 17:18:56,108 - DEBUG - [0][1] Scheduling WorkItem as WAITING workitem
2025-02-27 17:18:56,108 - DEBUG - [0] Current waiting runlist keys: dict_keys(['0_stage_backward_1', '0_sync_barrier', '1_stage_backward_1'])
2025-02-27 17:18:56,108 - INFO - Enqueued WorkItem to waiting runlist: WorkItem(%sync_barrier : [#users=1] = call_function[target=pippy.backward.sync_barrier](args = ({output: %getitem, loss: %getitem_1}, [%getitem_3, %getitem_7], %getitem_6), kwargs = {}))
2025-02-27 17:18:56,109 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem) for runlist item 1_sync_barrier arg_idx 0 from peer stage 1
2025-02-27 17:18:56,117 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_1) for runlist item 1_sync_barrier arg_idx 1 from peer stage 1
2025-02-27 17:18:56,125 - DEBUG - [0][1] Requesting transfer of value ValueReference(1, 1_getitem_3) for runlist item 1_sync_barrier arg_idx 2 from peer stage 1
2025-02-27 17:18:56,155 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_7) for runlist item 1_sync_barrier arg_idx 3 from peer stage 0
2025-02-27 17:18:56,159 - DEBUG - [0][1] Requesting transfer of value ValueReference(0, 1_getitem_6) for runlist item 1_sync_barrier arg_idx 4 from peer stage 0
2025-02-27 17:18:56,160 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_7) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:18:56,176 - DEBUG - [0][1] Executing transfer of value ValueReference(0, 1_getitem_6) initiated by stage 0 for 1_sync_barrier, i.e. from stage 0 to 0
2025-02-27 17:18:57,866 - DEBUG - [0][0] Populating result of type <class 'torch.Tensor'> for 0_submod_0
after processing the work_item.microbatch_id 0 :2443.64453125MB
2025-02-27 17:18:57,977 - INFO - Released WorkItem: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
Periodic memory cleanup :2451.64453125MB
All workitem count at loop begining: 5, current work item in ready runlist: 1, current work item in waiting runlist: 4
2025-02-27 17:18:58,014 - DEBUG - [0] Dequeueing workitem from set of 1
2025-02-27 17:18:58,014 - INFO - Dequeued WorkItem from ready runlist: WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
2025-02-27 17:18:58,015 - DEBUG - [0][1] Got WorkItem WorkItem(%submod_0 : [#users=3] = call_module[target=submod_0](args = (%input_1,), kwargs = {}))
before processing the work_item.microbatch_id 1 :2451.64453125MB
2025-02-27 17:18:58,023 - INFO - [0] Running forward module for microbatch 1
2025-02-27 17:18:58,065 - DEBUG - [0][0] Completing transfer of value ValueReference(0, 0_submod_0) for runlist item 0_stage_backward_1 arg_idx 0 from peer stage 0
Before WorkItem Ready if: work_item.blocked_args_count(1) should be 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: -9) local_rank: 0 (pid: 39940) of binary: /home/cailab/pippy/bin/python3
ERROR:torch.distributed.elastic.agent.server.api:Error waiting on exit barrier. Elapsed: 316.1377203464508 seconds
Traceback (most recent call last):
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 920, in _exit_barrier
    store_util.barrier(
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/elastic/utils/store.py", line 78, in barrier
    synchronize(store, data, rank, world_size, key_prefix, barrier_timeout)
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/elastic/utils/store.py", line 64, in synchronize
    agent_data = get_all(store, rank, key_prefix, world_size)
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/elastic/utils/store.py", line 34, in get_all
    data = store.get(f"{prefix}{idx}")
RuntimeError: Socket Timeout
Traceback (most recent call last):
  File "/home/cailab/pippy/bin/torchrun", line 11, in <module>
    load_entry_point('torch', 'console_scripts', 'torchrun')()
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/cailab/pippy/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
======================================================
pippy_resnet.py FAILED
------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-02-27_17:19:13
  host      : ubuntu
  rank      : 0 (local_rank: 0)
  exitcode  : -9 (pid: 39940)
  error_file: <N/A>
  traceback : Signal 9 (SIGKILL) received by PID 39940
======================================================
192.168.2.14
29500
